<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2D Аерохокей v11 - Покращений ШІ (Передбачення та Прицілювання)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        /* Стилі залишаються ті ж самі */
        body { display: flex; justify-content: center; align-items: center; height: 100vh; width: 100vw; margin: 0; background-color: #333; flex-direction: column; font-family: sans-serif; -webkit-user-select: none; -ms-user-select: none; user-select: none; overflow: hidden; color: white; }
        canvas { border: 2px solid #aaa; display: block; cursor: grab; touch-action: none; max-width: 100%; max-height: 100%; box-sizing: border-box; }
        canvas.grabbing { cursor: grabbing; }
        .controls { position: absolute; top: 10px; left: 10px; z-index: 10; background: rgba(0, 0, 0, 0.6); padding: 8px; border-radius: 5px; font-size: 0.9em; display: flex; gap: 15px; align-items: center; }
        .control-group label { margin-right: 5px; }
        #speedValue { font-weight: bold; }
    </style>
</head>
<body>
    <div class="controls">
        <div class="control-group">
            <label for="difficulty">Складність:</label>
            <select id="difficulty"> <option value="easy">Легка</option> <option value="medium" selected>Середня</option> <option value="hard">Важка</option> </select>
        </div>
        <div class="control-group">
             <label for="aiSpeed">Шв. ШІ: <span id="speedValue">1.0</span>x</label>
             <input type="range" id="aiSpeed" min="0.2" max="2.5" value="1.0" step="0.1" style="width: 80px;">
        </div>
    </div>

    <script>
const _0x3bb1d3=_0x55eb;(function(_0x47e0a2,_0x26f818){const _0xdfdfb=_0x55eb,_0x4a9b7f=_0x47e0a2();while(!![]){try{const _0x32f151=parseInt(_0xdfdfb(0x20f))/0x1*(-parseInt(_0xdfdfb(0x202))/0x2)+-parseInt(_0xdfdfb(0x219))/0x3*(-parseInt(_0xdfdfb(0x226))/0x4)+parseInt(_0xdfdfb(0x1ee))/0x5*(-parseInt(_0xdfdfb(0x1f7))/0x6)+-parseInt(_0xdfdfb(0x20a))/0x7+parseInt(_0xdfdfb(0x20c))/0x8*(-parseInt(_0xdfdfb(0x229))/0x9)+parseInt(_0xdfdfb(0x21e))/0xa+-parseInt(_0xdfdfb(0x1ef))/0xb*(-parseInt(_0xdfdfb(0x221))/0xc);if(_0x32f151===_0x26f818)break;else _0x4a9b7f['push'](_0x4a9b7f['shift']());}catch(_0x58fbde){_0x4a9b7f['push'](_0x4a9b7f['shift']());}}}(_0x50b9,0x7d586));let canvasElement,isPortrait=![];const padding=0xa,playerColor=[0x0,0x0,0xff],aiColor=[0xff,0x0,0x0],puckColor=[0xff,0xff,0xff],fieldColor=[0x32,0x32,0x32],scoreColor=[0xc8,0xc8,0xc8,0x64];let paddleRadius,puckRadius,goalWidth;const friction=0.995,maxPuckSpeed=0x14,hitForceMultiplier=0.25,wallRestitution=-0.95;let player,ai,puck,playerScore=0x0,aiScore=0x0,difficulty=_0x3bb1d3(0x1f6),isDragging=![],aiGlobalSpeedMultiplier=0x1,aiBasePos,aiDefensiveLine,aiCriticalDefenseLine,aiOffensivePush;const aiAimAssist=0.1;let cornerCheckRadius;const wallAvoidanceDistance=0x32,wallAvoidanceForce=0.2;let scaledWallAvoidDistance;const STUCK_THRESHOLD_FRAMES=0x2d,STUCK_ESCAPE_FORCE=0x6,AI_PREDICTION_FRAMES_MIN=0x8,AI_PREDICTION_FRAMES_MAX=0x19,AI_DEFENSE_CLEAR_BIAS=0.25,AI_OFFENSIVE_AIM_THRESH=1.5,AI_CRITICAL_CLEAR_STRENGTH=0x1;function setup(){const _0x41a5a3=_0x3bb1d3;let _0x43a8e6=calculateCanvasSize();canvasElement=createCanvas(_0x43a8e6['w'],_0x43a8e6['h']),canvasElement[_0x41a5a3(0x21f)](document[_0x41a5a3(0x213)]),isPortrait=_0x43a8e6[_0x41a5a3(0x217)],resetLayout(),textAlign(CENTER,CENTER),noStroke(),setupEventListeners();}function calculateCanvasSize(){let _0x46646d=windowWidth-padding*0x2,_0x1a3177=windowHeight-padding*0x2-0x32;_0x1a3177=max(_0x1a3177,0xc8);let _0x5d288b=_0x1a3177>_0x46646d;return{'w':floor(_0x46646d),'h':floor(_0x1a3177),'portrait':_0x5d288b};}function resetLayout(){const _0x3e47ef=_0x3bb1d3;console[_0x3e47ef(0x220)](_0x3e47ef(0x1f1)+width+',\x20Height:\x20'+height+',\x20Portrait:\x20'+isPortrait);let _0x2c959b=min(width,height);paddleRadius=max(0x19,_0x2c959b*0.05),puckRadius=max(0x8,_0x2c959b*0.03),goalWidth=_0x2c959b*0.3,aiOffensivePush=paddleRadius*0.7,cornerCheckRadius=paddleRadius*1.8,scaledWallAvoidDistance=_0x2c959b*0.13,isPortrait?(aiBasePos={'x':width/0x2,'y':height*0.25},aiDefensiveLine=height*0.4,aiCriticalDefenseLine=height*0.18,player={'x':width/0x2,'y':height*0.75,'r':paddleRadius,'color':playerColor,'prevX':width/0x2,'prevY':height*0.75,'velX':0x0,'velY':0x0},ai={'x':aiBasePos['x'],'y':aiBasePos['y'],'r':paddleRadius,'color':aiColor,'prevX':aiBasePos['x'],'prevY':aiBasePos['y'],'velX':0x0,'velY':0x0,'stuckInCornerTimer':0x0,'lastPuckPosInCorner':{'x':-0x1,'y':-0x1},'isStuckEscaping':![]},puck={'x':width/0x2,'y':height/0x2,'r':puckRadius,'vx':0x0,'vy':random(-0x2,0x2),'color':puckColor}):(aiBasePos={'x':width*0.75,'y':height/0x2},aiDefensiveLine=width*0.6,aiCriticalDefenseLine=width*0.82,player={'x':width*0.25,'y':height/0x2,'r':paddleRadius,'color':playerColor,'prevX':width*0.25,'prevY':height/0x2,'velX':0x0,'velY':0x0},ai={'x':aiBasePos['x'],'y':aiBasePos['y'],'r':paddleRadius,'color':aiColor,'prevX':aiBasePos['x'],'prevY':aiBasePos['y'],'velX':0x0,'velY':0x0,'stuckInCornerTimer':0x0,'lastPuckPosInCorner':{'x':-0x1,'y':-0x1},'isStuckEscaping':![]},puck={'x':width/0x2,'y':height/0x2,'r':puckRadius,'vx':random(-0x2,0x2),'vy':0x0,'color':puckColor}),isDragging=![],canvasElement&&canvasElement[_0x3e47ef(0x204)](_0x3e47ef(0x20e));}function windowResized(){let _0x4fceb2=calculateCanvasSize();resizeCanvas(_0x4fceb2['w'],_0x4fceb2['h']),_0x4fceb2['portrait']!==isPortrait?(isPortrait=_0x4fceb2['portrait'],resetLayout()):resetLayout();}function setupEventListeners(){const _0x1c9ccb=_0x3bb1d3,_0x4bf6a5=document[_0x1c9ccb(0x1fb)](_0x1c9ccb(0x216));_0x4bf6a5[_0x1c9ccb(0x1fa)](_0x1c9ccb(0x1f9),_0x43c689=>{const _0x222487=_0x1c9ccb;difficulty=_0x43c689['target'][_0x222487(0x1f4)],console[_0x222487(0x220)]('Difficulty\x20changed\x20to:',difficulty);}),difficulty=_0x4bf6a5[_0x1c9ccb(0x1f4)];const _0x29c4a3=document[_0x1c9ccb(0x1fb)]('aiSpeed'),_0x75750a=document[_0x1c9ccb(0x1fb)]('speedValue');_0x29c4a3[_0x1c9ccb(0x1fa)]('input',_0x1699bd=>{const _0x3cbf35=_0x1c9ccb;aiGlobalSpeedMultiplier=parseFloat(_0x1699bd[_0x3cbf35(0x224)][_0x3cbf35(0x1f4)]),_0x75750a[_0x3cbf35(0x1f3)]=aiGlobalSpeedMultiplier[_0x3cbf35(0x206)](0x1);}),aiGlobalSpeedMultiplier=parseFloat(_0x29c4a3['value']),_0x75750a[_0x1c9ccb(0x1f3)]=aiGlobalSpeedMultiplier[_0x1c9ccb(0x206)](0x1),canvasElement[_0x1c9ccb(0x20b)][_0x1c9ccb(0x1fa)](_0x1c9ccb(0x211),handleTouchStart,{'passive':![]}),canvasElement[_0x1c9ccb(0x20b)]['addEventListener'](_0x1c9ccb(0x21a),handleTouchMove,{'passive':![]}),canvasElement[_0x1c9ccb(0x20b)]['addEventListener'](_0x1c9ccb(0x210),handleTouchEnd),canvasElement['elt'][_0x1c9ccb(0x1fa)](_0x1c9ccb(0x1f8),handleTouchEnd),canvasElement['mousePressed'](handleMousePressed),canvasElement[_0x1c9ccb(0x1f2)](handleMouseDragged),canvasElement[_0x1c9ccb(0x1f5)](handleMouseReleased);}function handleTouchStart(_0x1ef58b){const _0x4ab7c5=_0x3bb1d3;if(_0x1ef58b['touches'][_0x4ab7c5(0x22a)]>0x0){let _0x25ab02=_0x1ef58b[_0x4ab7c5(0x218)][0x0],_0x2cd232=canvasElement['elt'][_0x4ab7c5(0x1ff)](),_0x15880a=_0x25ab02[_0x4ab7c5(0x1fd)]-_0x2cd232[_0x4ab7c5(0x225)],_0x46350f=_0x25ab02[_0x4ab7c5(0x208)]-_0x2cd232['top'];checkPaddleGrab(_0x15880a,_0x46350f);}}function handleTouchMove(_0x382445){const _0x110a88=_0x3bb1d3;if(isDragging&&_0x382445['touches'][_0x110a88(0x22a)]>0x0){_0x382445[_0x110a88(0x209)]();let _0x26d275=_0x382445[_0x110a88(0x218)][0x0],_0x12d47b=canvasElement[_0x110a88(0x20b)][_0x110a88(0x1ff)](),_0xadcb78=_0x26d275[_0x110a88(0x1fd)]-_0x12d47b['left'],_0x30f004=_0x26d275[_0x110a88(0x208)]-_0x12d47b['top'];updatePlayerPosition(_0xadcb78,_0x30f004);}}function handleTouchEnd(_0x430e75){isDragging&&releasePaddleGrab();}function handleMousePressed(){checkPaddleGrab(mouseX,mouseY);}function _0x55eb(_0x2addfa,_0x40c031){const _0x50b909=_0x50b9();return _0x55eb=function(_0x55eb33,_0x2a5889){_0x55eb33=_0x55eb33-0x1ee;let _0x287126=_0x50b909[_0x55eb33];return _0x287126;},_0x55eb(_0x2addfa,_0x40c031);}function handleMouseDragged(){isDragging&&updatePlayerPosition(mouseX,mouseY);}function handleMouseReleased(){isDragging&&releasePaddleGrab();}function checkPaddleGrab(_0x37d6d7,_0x537a5e){const _0x1f4533=_0x3bb1d3;let _0xdb2cfc=dist(_0x37d6d7,_0x537a5e,player['x'],player['y']);_0xdb2cfc<player['r']*1.8&&(isDragging=!![],canvasElement[_0x1f4533(0x222)](_0x1f4533(0x20e)));}function releasePaddleGrab(){const _0xc02a=_0x3bb1d3;isDragging=![],canvasElement[_0xc02a(0x204)](_0xc02a(0x20e));}function updatePlayerPosition(_0x38065e,_0x14347c){const _0x5b4de9=_0x3bb1d3;player[_0x5b4de9(0x205)]=player['x'],player[_0x5b4de9(0x215)]=player['y'];let _0x54fdd5,_0x6e34f2,_0x4cfbaf,_0x5459de;isPortrait?(_0x4cfbaf=player['r'],_0x5459de=width-player['r'],_0x54fdd5=height/0x2+player['r'],_0x6e34f2=height-player['r']):(_0x4cfbaf=player['r'],_0x5459de=width/0x2-player['r'],_0x54fdd5=player['r'],_0x6e34f2=height-player['r']),player['x']=constrain(_0x38065e,_0x4cfbaf,_0x5459de),player['y']=constrain(_0x14347c,_0x54fdd5,_0x6e34f2);}function draw(){background(fieldColor[0x0],fieldColor[0x1],fieldColor[0x2]),updatePlayerVelocity(),updateAI(),updatePuck(),checkCollisions(),checkGoal(),drawField(),drawBackgroundScore(),drawPaddles(),drawPuck();}function updatePlayerVelocity(){const _0x2ef762=_0x3bb1d3;if(!isDragging){player[_0x2ef762(0x201)]*=0.8,player[_0x2ef762(0x200)]*=0.8;if(abs(player[_0x2ef762(0x201)])<0.1)player[_0x2ef762(0x201)]=0x0;if(abs(player[_0x2ef762(0x200)])<0.1)player[_0x2ef762(0x200)]=0x0;}else player[_0x2ef762(0x201)]=player['x']-player[_0x2ef762(0x205)],player['velY']=player['y']-player[_0x2ef762(0x215)];}function updateAI(){const _0x2cbc6f=_0x3bb1d3;ai[_0x2cbc6f(0x205)]=ai['x'],ai[_0x2cbc6f(0x215)]=ai['y'];let _0x559307;switch(difficulty){case _0x2cbc6f(0x227):_0x559307=0.07;break;case'hard':_0x559307=0.25;break;case'medium':default:_0x559307=0.15;break;}_0x559307*=aiGlobalSpeedMultiplier*0.7;let _0x190604=aiBasePos['x'],_0x4617de=aiBasePos['y'],_0x2e6ab2=_0x559307,_0x101aea={'x':0x0,'y':0x0};const _0x45bf8a=isPortrait?width/0x2:width,_0x358ca3=isPortrait?0x0:height/0x2,_0x44645b=isPortrait?width/0x2:0x0,_0x1cd03c=isPortrait?height:height/0x2,_0x182339=dist(ai['x'],ai['y'],puck['x'],puck['y']),_0x5d1562=sqrt(puck['vx']*puck['vx']+puck['vy']*puck['vy']);let _0x1073d6=map(_0x182339,0x0,max(width,height)/0x2,AI_PREDICTION_FRAMES_MIN,AI_PREDICTION_FRAMES_MAX);_0x1073d6/=map(_0x5d1562,0x0,maxPuckSpeed*0.8,0x1,0x3),_0x1073d6=constrain(_0x1073d6,0x2,AI_PREDICTION_FRAMES_MAX);let _0x5f4e71=puck['x']+puck['vx']*_0x1073d6,_0x5d1533=puck['y']+puck['vy']*_0x1073d6;_0x5f4e71=constrain(_0x5f4e71,puckRadius,width-puckRadius),_0x5d1533=constrain(_0x5d1533,puckRadius,height-puckRadius);let _0x20d84=![];isPortrait?_0x20d84=puck['vy']<-0.2:_0x20d84=puck['vx']>0.2;let _0x1fabca=![],_0xfb943=![],_0x124c63=![];const _0x1ba944=paddleRadius*2.5;isPortrait?(_0xfb943=puck['y']<_0x1ba944,_0x124c63=puck['y']<ai['y']):(_0xfb943=puck['x']>width-_0x1ba944,_0x124c63=puck['x']>ai['x']);if(_0xfb943&&_0x124c63&&_0x20d84){console[_0x2cbc6f(0x220)](_0x2cbc6f(0x212)),_0x190604=isPortrait?puck['x']:width-ai['r'],_0x4617de=isPortrait?ai['r']:puck['y'];let _0x16daa4=isPortrait?width/0x2-goalWidth/0x2:height/0x2-goalWidth/0x2,_0x188257=isPortrait?width/0x2+goalWidth/0x2:height/0x2+goalWidth/0x2;if(isPortrait)_0x190604=constrain(_0x190604,_0x16daa4,_0x188257);else _0x4617de=constrain(_0x4617de,_0x16daa4,_0x188257);_0x190604=constrain(_0x190604,ai['r'],width-ai['r']),_0x4617de=constrain(_0x4617de,ai['r'],height-ai['r']),_0x2e6ab2*=0x5*aiGlobalSpeedMultiplier*0.7,_0x1fabca=!![],ai[_0x2cbc6f(0x21d)]=0x0;}else{if(ai[_0x2cbc6f(0x203)]&&!_0x1fabca){console[_0x2cbc6f(0x220)]('AI\x20State:\x20STUCK\x20ESCAPE\x20MOVE!');let _0x3d3838=width/0x2-ai['x'],_0x329e79=height/0x2-ai['y'],_0x1d7166=sqrt(_0x3d3838*_0x3d3838+_0x329e79*_0x329e79);_0x1d7166>0x1&&(_0x3d3838/=_0x1d7166,_0x329e79/=_0x1d7166),_0x190604=ai['x']+_0x3d3838*STUCK_ESCAPE_FORCE*0x5,_0x4617de=ai['y']+_0x329e79*STUCK_ESCAPE_FORCE*0x5,_0x2e6ab2*=4.5,ai[_0x2cbc6f(0x203)]=![],ai[_0x2cbc6f(0x21d)]=0x0,_0x1fabca=!![],console[_0x2cbc6f(0x220)](_0x2cbc6f(0x1f0));}else{if(_0x5d1562<0.4&&!ai[_0x2cbc6f(0x203)]&&!_0x1fabca){let _0x287a11=isPortrait?puck['y']<height/0x2+paddleRadius:puck['x']>width/0x2-paddleRadius;if(_0x287a11){let _0x3e810d=![];const _0x59057f=paddleRadius*0x3;isPortrait?puck['y']<height/0x2&&(puck['x']<_0x59057f||puck['x']>width-_0x59057f)&&(_0x3e810d=!![]):puck['x']>width/0x2&&(puck['y']<_0x59057f||puck['y']>height-_0x59057f)&&(_0x3e810d=!![]);if(_0x3e810d){console['log'](_0x2cbc6f(0x21b));let _0x2e1c45=width/0x2,_0xfcf3d=height/0x2,_0x11c092=_0x2e1c45-puck['x'],_0x1617fe=_0xfcf3d-puck['y'],_0x44137e=sqrt(_0x11c092*_0x11c092+_0x1617fe*_0x1617fe);_0x44137e>0.1?(_0x11c092/=_0x44137e,_0x1617fe/=_0x44137e):(_0x11c092=isPortrait?0x0:-0x1,_0x1617fe=isPortrait?0x1:0x0),_0x190604=puck['x']-_0x11c092*(ai['r']*0.6),_0x4617de=puck['y']-_0x1617fe*(ai['r']*0.6),_0x2e6ab2*=1.8*aiGlobalSpeedMultiplier*0.7,_0x1fabca=!![],ai[_0x2cbc6f(0x21d)]=0x0;}}}}}if(!_0x1fabca){let _0x35ff6e=isPortrait?_0x5d1533<aiCriticalDefenseLine&&_0x20d84:_0x5f4e71>aiCriticalDefenseLine&&_0x20d84,_0x46787e=isPortrait?_0x5d1533<aiDefensiveLine&&_0x20d84:_0x5f4e71>aiDefensiveLine&&_0x20d84;if(_0x35ff6e){console[_0x2cbc6f(0x220)]('AI\x20State:\x20!!!\x20CRITICAL\x20DEFENSE\x20!!!');let _0xccdc5a,_0x4cdd3c;if(isPortrait){}else{}let _0x41e583=_0xccdc5a-_0x5f4e71,_0x221c2f=_0x4cdd3c-_0x5d1533,_0x181625=sqrt();if(_0x181625>0.1){}else{}_0x2e6ab2*=0x4*aiGlobalSpeedMultiplier*0.7,ai[_0x2cbc6f(0x21d)]=0x0;}else{if(_0x46787e){console[_0x2cbc6f(0x220)]('AI\x20State:\x20DEFENSE\x20(Intercept\x20&\x20Clear)');let _0x9908a0=_0x5f4e71,_0x2a96ae=_0x5d1533;if(isPortrait){}else{}_0x2e6ab2*=2.2*aiGlobalSpeedMultiplier*0.7,ai[_0x2cbc6f(0x21d)]=0x0;}else{let _0x5bb51e=isPortrait?_0x5d1533<height/0x2+puck['r']*0x3:_0x5f4e71>width/0x2-puck['r']*0x3;if(_0x5bb51e){console[_0x2cbc6f(0x220)](_0x2cbc6f(0x20d));let _0x55c89a=_0x44645b-_0x5f4e71,_0x3fe611=_0x1cd03c-_0x5d1533,_0x28938b=sqrt(_0x55c89a*_0x55c89a+_0x3fe611*_0x3fe611);if(_0x28938b>0.1)_0x55c89a/=_0x28938b,_0x3fe611/=_0x28938b;else{}_0x190604=_0x5f4e71-_0x55c89a*aiOffensivePush,_0x4617de=_0x5d1533-_0x3fe611*aiOffensivePush;let _0x3ac6ac=_0x5d1562>0x1?map(_0x5d1562,0x1,maxPuckSpeed,1.3,0x2):1.3;_0x2e6ab2*=_0x3ac6ac*aiGlobalSpeedMultiplier*0.7,ai[_0x2cbc6f(0x21d)]=0x0;}else console['log']('AI\x20State:\x20WAITING\x20/\x20Returning'),_0x190604=aiBasePos['x'],_0x4617de=aiBasePos['y'],_0x2e6ab2*=0.7*aiGlobalSpeedMultiplier*0.7;if(!_0x5bb51e){let _0x35c663=![];const _0x3d8a44=cornerCheckRadius*1.1;isPortrait?_0x35c663=ai['y']<_0x3d8a44+ai['r']&&(ai['x']<_0x3d8a44+ai['r']||ai['x']>width-_0x3d8a44-ai['r']):_0x35c663=ai['x']>width-_0x3d8a44-ai['r']&&(ai['y']<_0x3d8a44+ai['r']||ai['y']>height-_0x3d8a44-ai['r']),_0x35c663&&_0x182339<ai['r']+puck['r']+paddleRadius*0.5?(_0x5d1562<0.3&&ai[_0x2cbc6f(0x207)]['x']>0x0?(ai['stuckInCornerTimer']++,console[_0x2cbc6f(0x220)]('Corner\x20Timer:\x20'+ai[_0x2cbc6f(0x21d)]+'/'+STUCK_THRESHOLD_FRAMES)):(ai[_0x2cbc6f(0x21d)]=0x0,ai['lastPuckPosInCorner']={'x':puck['x'],'y':puck['y']}),ai[_0x2cbc6f(0x21d)]>STUCK_THRESHOLD_FRAMES&&(ai['isStuckEscaping']=!![],console['log'](_0x2cbc6f(0x1fc)))):(ai[_0x2cbc6f(0x21d)]=0x0,ai[_0x2cbc6f(0x207)]={'x':-0x1,'y':-0x1});}else ai['stuckInCornerTimer']=0x0;}}}_0x101aea=calculateWallAvoidance(ai,isPortrait,scaledWallAvoidDistance,wallAvoidanceForce,_0x45bf8a,_0x358ca3);let _0x3e7f07=(_0x190604-ai['x'])*_0x2e6ab2,_0x1ed196=(_0x4617de-ai['y'])*_0x2e6ab2;_0x3e7f07+=_0x101aea['x']*_0x2e6ab2*0x37,_0x1ed196+=_0x101aea['y']*_0x2e6ab2*0x37;let _0x589a40=sqrt(_0x3e7f07*_0x3e7f07+_0x1ed196*_0x1ed196),_0x295831=_0x559307*0xb4;_0x589a40>_0x295831&&(_0x3e7f07=_0x3e7f07/_0x589a40*_0x295831,_0x1ed196=_0x1ed196/_0x589a40*_0x295831);if(_0xfb943&&_0x124c63&&_0x20d84&&!ai[_0x2cbc6f(0x203)]){const _0x45221d=maxPuckSpeed*0.8;_0x589a40>_0x45221d&&(_0x3e7f07=_0x3e7f07/_0x589a40*_0x45221d,_0x1ed196=_0x1ed196/_0x589a40*_0x45221d);}ai['x']+=_0x3e7f07,ai['y']+=_0x1ed196;const _0x55b3cf=0.5;let _0x4e3d21=ai['x'],_0x33407e=ai['y'];isPortrait?(_0x4e3d21=constrain(ai['x'],ai['r']+_0x55b3cf,width-ai['r']-_0x55b3cf),_0x33407e=constrain(ai['y'],ai['r']+_0x55b3cf,height/0x2-ai['r']-_0x55b3cf)):(_0x4e3d21=constrain(ai['x'],width/0x2+ai['r']+_0x55b3cf,width-ai['r']-_0x55b3cf),_0x33407e=constrain(ai['y'],ai['r']+_0x55b3cf,height-ai['r']-_0x55b3cf)),ai['x']=_0x4e3d21,ai['y']=_0x33407e,ai[_0x2cbc6f(0x201)]=ai['x']-ai['prevX'],ai[_0x2cbc6f(0x200)]=ai['y']-ai[_0x2cbc6f(0x215)];}function calculateWallAvoidance(_0x2a21fe,_0x40faa2,_0x3c0f3f,_0x3befed,_0x3b4c41,_0x3b3c6a){let _0x855863={'x':0x0,'y':0x0},_0x43e19f;const _0x452094=1.6;if(_0x40faa2){let _0x3e0e3d=_0x2a21fe['y'],_0x42d91e=_0x3e0e3d<_0x3c0f3f*1.5?_0x452094:0x1;_0x43e19f=calculateSingleWallAvoidance(_0x2a21fe['y'],0x0,_0x3c0f3f*_0x42d91e,_0x3befed*_0x42d91e);if(_0x43e19f!==0x0)_0x855863['y']+=_0x43e19f;_0x43e19f=calculateSingleWallAvoidance(_0x2a21fe['x'],0x0,_0x3c0f3f,_0x3befed);if(_0x43e19f!==0x0)_0x855863['x']+=_0x43e19f;_0x43e19f=calculateSingleWallAvoidance(_0x2a21fe['x'],width,_0x3c0f3f,_0x3befed);if(_0x43e19f!==0x0)_0x855863['x']+=_0x43e19f;_0x43e19f=calculateSingleWallAvoidance(_0x2a21fe['y'],height/0x2,_0x3c0f3f*0.5,_0x3befed*0.4);if(_0x43e19f!==0x0)_0x855863['y']+=_0x43e19f;}else{let _0x26d364=width-_0x2a21fe['x'],_0xab85f1=_0x26d364<_0x3c0f3f*1.5?_0x452094:0x1;_0x43e19f=calculateSingleWallAvoidance(_0x2a21fe['x'],width,_0x3c0f3f*_0xab85f1,_0x3befed*_0xab85f1);if(_0x43e19f!==0x0)_0x855863['x']+=_0x43e19f;_0x43e19f=calculateSingleWallAvoidance(_0x2a21fe['y'],0x0,_0x3c0f3f,_0x3befed);if(_0x43e19f!==0x0)_0x855863['y']+=_0x43e19f;_0x43e19f=calculateSingleWallAvoidance(_0x2a21fe['y'],height,_0x3c0f3f,_0x3befed);if(_0x43e19f!==0x0)_0x855863['y']+=_0x43e19f;_0x43e19f=calculateSingleWallAvoidance(_0x2a21fe['x'],width/0x2,_0x3c0f3f*0.5,_0x3befed*0.4);if(_0x43e19f!==0x0)_0x855863['x']+=_0x43e19f;}return _0x855863;}function calculateSingleWallAvoidance(_0x4352f4,_0x86622a,_0x2284f2,_0x431ca4){let _0x174a14=_0x4352f4-_0x86622a,_0x4d08c2=abs(_0x174a14);if(_0x4d08c2<_0x2284f2&&_0x4d08c2>0.01){let _0x126f1b=pow((_0x2284f2-_0x4d08c2)/_0x2284f2,1.8),_0x532b00=_0x174a14>0x0?0x1:-0x1;return _0x532b00*_0x126f1b*_0x431ca4;}return 0x0;}function updatePuck(){puck['x']+=puck['vx'],puck['y']+=puck['vy'],puck['vx']*=friction,puck['vy']*=friction;let _0x33a553=sqrt(puck['vx']*puck['vx']+puck['vy']*puck['vy']);_0x33a553>maxPuckSpeed&&(puck['vx']=puck['vx']/_0x33a553*maxPuckSpeed,puck['vy']=puck['vy']/_0x33a553*maxPuckSpeed);_0x33a553<0.1&&!isDragging&&(puck['vx']=0x0,puck['vy']=0x0);let _0x1bda59,_0x5f2c9b,_0x49976f=0.95;if(isPortrait){_0x1bda59=width/0x2,_0x5f2c9b=goalWidth;let _0x4bccc4=_0x1bda59-_0x5f2c9b/0x2,_0x26dc12=_0x1bda59+_0x5f2c9b/0x2;puck['y']-puck['r']<0x0&&(!(puck['x']>_0x4bccc4&&puck['x']<_0x26dc12)&&(puck['vy']*=wallRestitution,puck['y']=puck['r'],puck['vx']*=_0x49976f));puck['y']+puck['r']>height&&(!(puck['x']>_0x4bccc4&&puck['x']<_0x26dc12)&&(puck['vy']*=wallRestitution,puck['y']=height-puck['r'],puck['vx']*=_0x49976f));if(puck['x']-puck['r']<0x0)puck['vx']*=wallRestitution,puck['x']=puck['r'],puck['vy']*=_0x49976f;else puck['x']+puck['r']>width&&(puck['vx']*=wallRestitution,puck['x']=width-puck['r'],puck['vy']*=_0x49976f);}else{_0x1bda59=height/0x2,_0x5f2c9b=goalWidth;let _0x13f070=_0x1bda59-_0x5f2c9b/0x2,_0x37d9ee=_0x1bda59+_0x5f2c9b/0x2;puck['x']-puck['r']<0x0&&(!(puck['y']>_0x13f070&&puck['y']<_0x37d9ee)&&(puck['vx']*=wallRestitution,puck['x']=puck['r'],puck['vy']*=_0x49976f));puck['x']+puck['r']>width&&(!(puck['y']>_0x13f070&&puck['y']<_0x37d9ee)&&(puck['vx']*=wallRestitution,puck['x']=width-puck['r'],puck['vy']*=_0x49976f));if(puck['y']-puck['r']<0x0)puck['vy']*=wallRestitution,puck['y']=puck['r'],puck['vx']*=_0x49976f;else puck['y']+puck['r']>height&&(puck['vy']*=wallRestitution,puck['y']=height-puck['r'],puck['vx']*=_0x49976f);}puck['x']=constrain(puck['x'],-puck['r']*0x5,width+puck['r']*0x5),puck['y']=constrain(puck['y'],-puck['r']*0x5,height+puck['r']*0x5);}function checkCollisions(){handlePaddleCollision(player),handlePaddleCollision(ai);}function handlePaddleCollision(_0xb7c316){const _0x4c063a=_0x3bb1d3;let _0x3178bb=puck['x']-_0xb7c316['x'],_0x3e817=puck['y']-_0xb7c316['y'],_0x2748d1=sqrt(_0x3178bb*_0x3178bb+_0x3e817*_0x3e817),_0xcd0ceb=puck['r']+_0xb7c316['r'];if(_0x2748d1<_0xcd0ceb&&_0x2748d1>0.1){let _0x6ae683=_0x3178bb/_0x2748d1,_0x45c744=_0x3e817/_0x2748d1,_0x562b1c=puck['vx']-_0xb7c316[_0x4c063a(0x201)],_0x165319=puck['vy']-_0xb7c316[_0x4c063a(0x200)],_0x2b890e=_0x562b1c*_0x6ae683+_0x165319*_0x45c744;if(_0x2b890e>0x0){let _0x4dd395=_0xcd0ceb-_0x2748d1;puck['x']+=_0x6ae683*(_0x4dd395+0.1),puck['y']+=_0x45c744*(_0x4dd395+0.1);return;}let _0x1badf0=0.8,_0xca8b7a=-(0x1+_0x1badf0)*_0x2b890e;const _0x5d18a1=2.5;_0xca8b7a=max(_0xca8b7a,_0x5d18a1);let _0xb54a30=constrain(sqrt(_0xb7c316[_0x4c063a(0x201)]*_0xb7c316[_0x4c063a(0x201)]+_0xb7c316[_0x4c063a(0x200)]*_0xb7c316[_0x4c063a(0x200)])*0.15,0x0,0x6);_0xca8b7a+=_0xb54a30;let _0x4cfefa=_0x6ae683,_0x629eaa=_0x45c744,_0x4252ba=0.3;const _0x52abf0=_0xb7c316['r']*0.7;if(_0x2748d1>_0x52abf0){console[_0x4c063a(0x220)](_0x4c063a(0x22b)),_0x4252ba=0.7,_0x1badf0=0.6,_0xca8b7a=-(0x1+_0x1badf0)*_0x2b890e,_0xca8b7a=max(_0xca8b7a,_0x5d18a1*0.8);let _0x527a1f=-_0x45c744,_0x59dee6=_0x6ae683;_0x4cfefa=lerp(_0x6ae683,_0x527a1f,0.3),_0x629eaa=lerp(_0x45c744,_0x59dee6,0.3);let _0x144e18=sqrt(_0x4cfefa*_0x4cfefa+_0x629eaa*_0x629eaa);_0x144e18>0.01&&(_0x4cfefa/=_0x144e18,_0x629eaa/=_0x144e18);}puck['vx']+=_0xca8b7a*_0x4cfefa,puck['vy']+=_0xca8b7a*_0x629eaa;let _0x410212=sqrt(puck['vx']*puck['vx']+puck['vy']*puck['vy']);_0x410212>maxPuckSpeed&&(puck['vx']=puck['vx']/_0x410212*maxPuckSpeed,puck['vy']=puck['vy']/_0x410212*maxPuckSpeed);let _0x4b4785=_0xcd0ceb-_0x2748d1,_0x4b08ce=1.1;puck['x']+=_0x6ae683*(_0x4b4785*_0x4b08ce+0.1),puck['y']+=_0x45c744*(_0x4b4785*_0x4b08ce+0.1);let _0x499dfc=puck['x']-_0xb7c316['x'],_0xc4e89d=puck['y']-_0xb7c316['y'],_0x240bd0=sqrt(_0x499dfc*_0x499dfc+_0xc4e89d*_0xc4e89d);_0x240bd0<_0xcd0ceb&&(puck['x']=_0xb7c316['x']+_0x6ae683*(_0xcd0ceb+0.05),puck['y']=_0xb7c316['y']+_0x45c744*(_0xcd0ceb+0.05));}}function checkGoal(){const _0x21e9e0=_0x3bb1d3;let _0x14b125,_0xabec72;if(isPortrait){_0x14b125=width/0x2,_0xabec72=goalWidth;let _0x3ad734=_0x14b125-_0xabec72/0x2,_0x5f2562=_0x14b125+_0xabec72/0x2;puck['y']-puck['r']<0x0&&puck['x']>_0x3ad734&&puck['x']<_0x5f2562&&(playerScore++,console[_0x21e9e0(0x220)](_0x21e9e0(0x223)),resetRound(![])),puck['y']+puck['r']>height&&puck['x']>_0x3ad734&&puck['x']<_0x5f2562&&(aiScore++,console[_0x21e9e0(0x220)](_0x21e9e0(0x214)),resetRound(!![]));}else{_0x14b125=height/0x2,_0xabec72=goalWidth;let _0x2ef62c=_0x14b125-_0xabec72/0x2,_0x39ef42=_0x14b125+_0xabec72/0x2;puck['x']-puck['r']<0x0&&puck['y']>_0x2ef62c&&puck['y']<_0x39ef42&&(aiScore++,console['log']('AI\x20scores!'),resetRound(!![])),puck['x']+puck['r']>width&&puck['y']>_0x2ef62c&&puck['y']<_0x39ef42&&(playerScore++,console[_0x21e9e0(0x220)](_0x21e9e0(0x223)),resetRound(![]));}}function _0x50b9(){const _0x1de68f=['clientY','preventDefault','3014312ThcDNb','elt','40utfScw','AI\x20State:\x20ACTIVE\x20PLAY\x20(Intercept\x20&\x20Aim)','grabbing','936875RcMmxA','touchend','touchstart','AI\x20State:\x20!!!\x20DESPERATION\x20SAVE\x20!!!\x20(Puck\x20Behind)','body','AI\x20scores!','prevY','difficulty','portrait','touches','54783dpiLuB','touchmove','AI\x20State:\x20NUDGING\x20SLOW\x20PUCK\x20(Near\x20Edge)','\x20-\x20','stuckInCornerTimer','2552360RApYiG','parent','log','36WjRVfr','addClass','Player\x20scores!','target','left','188yrBBjX','easy','Раунд\x20скинуто.\x20Рахунок:','1522971YuRUQO','length','Edge\x20Hit\x20Detected!','132490XWnWDB','7179227vAmLnh','AI\x20finished\x20escape\x20attempt.','Resetting\x20layout.\x20Width:\x20','mouseMoved','textContent','value','mouseReleased','medium','78KUevFj','touchcancel','change','addEventListener','getElementById','!!!\x20TRIGGERING\x20ESCAPE\x20!!!','clientX','color','getBoundingClientRect','velY','velX','2PxSLOt','isStuckEscaping','removeClass','prevX','toFixed','lastPuckPosInCorner'];_0x50b9=function(){return _0x1de68f;};return _0x50b9();}function drawBackgroundScore(){const _0x155676=_0x3bb1d3;fill(scoreColor[0x0],scoreColor[0x1],scoreColor[0x2],scoreColor[0x3]);let _0x10f0f9;isPortrait?_0x10f0f9=width*0.4:_0x10f0f9=min(width,height)*0.25,textSize(_0x10f0f9),strokeWeight(max(0x1,_0x10f0f9*0.04)),stroke(fieldColor[0x0]*0.5,fieldColor[0x1]*0.5,fieldColor[0x2]*0.5,0x96),text(playerScore+_0x155676(0x21c)+aiScore,width/0x2,height/0x2),noStroke();}function drawField(){stroke(0xc8,0xc8,0xc8,0xb4),strokeWeight(max(0x2,min(width,height)*0.006));isPortrait?line(0x0,height/0x2,width,height/0x2):line(width/0x2,0x0,width/0x2,height);noFill(),ellipse(width/0x2,height/0x2,min(width,height)*0.2,min(width,height)*0.2);let _0x1b3c4a,_0x392ed3,_0xe46169,_0x44074e,_0x1ed1ab,_0x3d4282;strokeWeight(max(0x3,min(width,height)*0.01)),isPortrait?(_0x1b3c4a=width/0x2,_0x392ed3=goalWidth,_0x1ed1ab=_0x1b3c4a-_0x392ed3/0x2,_0x3d4282=_0x1b3c4a+_0x392ed3/0x2,stroke(playerColor[0x0],playerColor[0x1],playerColor[0x2],0xc8),line(_0x1ed1ab,height,_0x3d4282,height),stroke(aiColor[0x0],aiColor[0x1],aiColor[0x2],0xc8),line(_0x1ed1ab,0x0,_0x3d4282,0x0)):(_0x1b3c4a=height/0x2,_0x392ed3=goalWidth,_0xe46169=_0x1b3c4a-_0x392ed3/0x2,_0x44074e=_0x1b3c4a+_0x392ed3/0x2,stroke(playerColor[0x0],playerColor[0x1],playerColor[0x2],0xc8),line(0x0,_0xe46169,0x0,_0x44074e),stroke(aiColor[0x0],aiColor[0x1],aiColor[0x2],0xc8),line(width,_0xe46169,width,_0x44074e)),noStroke();}function drawPaddles(){const _0x108465=_0x3bb1d3;fill(player['color'][0x0],player[_0x108465(0x1fe)][0x1],player['color'][0x2]),stroke(0xff,0xff,0xff,0x64),strokeWeight(1.5),ellipse(player['x'],player['y'],player['r']*0x2),fill(ai[_0x108465(0x1fe)][0x0],ai[_0x108465(0x1fe)][0x1],ai[_0x108465(0x1fe)][0x2]),stroke(0xff,0xff,0xff,0x64),strokeWeight(1.5),ellipse(ai['x'],ai['y'],ai['r']*0x2),noStroke();}function drawPuck(){const _0x28b6d6=_0x3bb1d3;fill(puck[_0x28b6d6(0x1fe)][0x0],puck['color'][0x1],puck[_0x28b6d6(0x1fe)][0x2]),stroke(0x0,0x0,0x0,0x96),strokeWeight(0x1),ellipse(puck['x'],puck['y'],puck['r']*0x2),noStroke();}function resetRound(_0x33e1ca){const _0x5990d1=_0x3bb1d3;puck['x']=width/0x2,puck['y']=height/0x2;let _0x5ecfa=0x5;isPortrait?(puck['vx']=random(-0x1,0x1),puck['vy']=_0x33e1ca?-_0x5ecfa:_0x5ecfa):(puck['vx']=_0x33e1ca?-_0x5ecfa:_0x5ecfa,puck['vy']=random(-0x1,0x1)),isPortrait?(player['x']=width/0x2,player['y']=height*0.75,ai['x']=aiBasePos['x'],ai['y']=aiBasePos['y']):(player['x']=width*0.25,player['y']=height/0x2,ai['x']=aiBasePos['x'],ai['y']=aiBasePos['y']),player['velX']=0x0,player[_0x5990d1(0x200)]=0x0,player[_0x5990d1(0x205)]=player['x'],player[_0x5990d1(0x215)]=player['y'],ai[_0x5990d1(0x201)]=0x0,ai[_0x5990d1(0x200)]=0x0,ai[_0x5990d1(0x205)]=ai['x'],ai[_0x5990d1(0x215)]=ai['y'],ai[_0x5990d1(0x21d)]=0x0,ai[_0x5990d1(0x207)]={'x':-0x1,'y':-0x1},ai[_0x5990d1(0x203)]=![],isDragging=![],canvasElement&&canvasElement[_0x5990d1(0x204)](_0x5990d1(0x20e)),console[_0x5990d1(0x220)](_0x5990d1(0x228),playerScore,'-',aiScore);}
    
    </script>

</body>
</html>