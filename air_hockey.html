<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2D Аерохокей v18 - Повний екран (Без зміщення)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        /* Базові стилі для сторінки та тіла */
        html, body {
            height: 100%;      /* Займаємо всю висоту */
            width: 100%;       /* Займаємо всю ширину */
            margin: 0;         /* Забираємо відступи за замовчуванням */
            overflow: hidden;  /* Забороняємо прокрутку сторінки */
            background-color: #222; /* Темний фон */
            color: white;      /* Колір тексту */
            font-family: sans-serif; /* Шрифт без зарубок */
            -webkit-user-select: none; /* Заборона виділення тексту */
            -ms-user-select: none;
            user-select: none;
        }
        body {
            display: flex;         /* Використовуємо Flexbox для центрування */
            justify-content: center; /* Центрування по горизонталі */
            align-items: center;     /* Центрування по вертикалі */
            flex-direction: column;  /* Елементи розташовуються вертикально */
            position: relative;    /* Для абсолютного позиціонування .controls */
        }
        /* Стилі для ігрового поля (канвасу) */
        canvas {
            border: 2px solid #aaa; /* Сіра рамка */
            display: block;        /* Забираємо зайвий відступ під канвасом */
            cursor: grab;          /* Курсор "схопити" */
            touch-action: none;    /* Забороняємо стандартні дії браузера при дотику (скрол, зум) */
            max-width: 100%;       /* Максимальна ширина - 100% батьківського елемента */
            max-height: 100%;      /* Максимальна висота - 100% батьківського елемента */
            box-sizing: border-box;/* Рамка враховується в розмірах елемента */
        }
        /* Зміна курсору при перетягуванні ключки */
        canvas.grabbing {
            cursor: grabbing;      /* Курсор "перетягування" */
        }
        /* Стилі для панелі керування */
        .controls {
            position: absolute;    /* Позиціонуємо відносно body */
            top: 10px;             /* Відступ зверху */
            left: 10px;            /* Відступ зліва */
            z-index: 10;           /* Перекриває канвас */
            background: rgba(0, 0, 0, 0.7); /* Напівпрозорий чорний фон */
            padding: 8px;          /* Внутрішні відступи */
            border-radius: 5px;    /* Округлені кути */
            font-size: 0.9em;      /* Розмір шрифту */
            display: flex;         /* Елементи керування в ряд */
            gap: 15px;             /* Відстань між елементами */
            align-items: center;     /* Вирівнювання елементів по вертикалі */
            flex-wrap: wrap;       /* Переносити елементи на новий рядок, якщо не вміщаються */
        }
        /* Стилі для групи елементів керування */
        .control-group label {
            margin-right: 5px;     /* Відступ справа від мітки */
            white-space: nowrap;   /* Заборона переносу тексту мітки */
        }
        /* Стилі для значень повзунків */
        #speedValue, #puckSpeedValue, #gripValue {
            font-weight: bold;     /* Жирний шрифт */
        }
        /* Стилі для кнопки повноекранного режиму */
        #fullscreenBtn {
            padding: 5px 10px;     /* Внутрішні відступи */
            background-color: #555;/* Сірий фон */
            border: 1px solid #888;/* Світліша рамка */
            color: white;          /* Білий текст */
            border-radius: 3px;    /* Округлені кути */
            cursor: pointer;       /* Курсор-вказівник */
            font-size: 0.9em;      /* Розмір шрифту */
            white-space: nowrap;   /* Заборона переносу тексту */
        }
        /* Зміна фону кнопки при наведенні */
        #fullscreenBtn:hover {
            background-color: #777;/* Світліший сірий фон */
        }
        /* Адаптивні стилі для маленьких екранів */
        @media (max-width: 550px) {
            .controls {
                gap: 8px;          /* Менша відстань між елементами */
            }
            .control-group input[type=range] {
                width: 60px;       /* Коротші повзунки */
            }
            #fullscreenBtn {
                font-size: 0.85em; /* Трохи менший шрифт кнопки */
                padding: 4px 8px;  /* Менші відступи кнопки */
            }
        }
    </style>
</head>
<body>
    <!-- Контейнер для елементів керування -->
    <div class="controls">
        <div class="control-group">
            <label for="difficulty">Складність:</label>
            <select id="difficulty">
                <option value="easy">Легка</option>
                <option value="medium" selected>Середня</option>
                <option value="hard">Важка</option>
            </select>
        </div>
        <div class="control-group">
             <label for="aiSpeed">Шв. ШІ: <span id="speedValue">1.0</span>x</label>
             <input type="range" id="aiSpeed" min="0.2" max="2.5" value="1.0" step="0.1" style="width: 80px;">
        </div>
        <div class="control-group">
             <label for="puckSpeedSlider">Макс. шв. шайби: <span id="puckSpeedValue">15</span></label>
             <input type="range" id="puckSpeedSlider" min="5" max="35" value="15" step="1" style="width: 80px;">
        </div>
        <!-- <div class="control-group">
             <label for="gripSlider">Зачепл.: <span id="gripValue">0.39</span></label>
             <input type="range" id="gripSlider" min="0.0" max="0.8" value="0.39" step="0.01" style="width: 80px;">
        </div>-->
        <!-- Кнопка повноекранного режиму -->
        <button id="fullscreenBtn">Повний екран</button>
    </div>

    <!-- Канвас для гри буде створено і додано сюди за допомогою p5.js -->

    <script>

const _0x33fd2=_0x48a7;(function(_0x5acd0a,_0x3902c7){const _0x4e81ed=_0x48a7,_0x551aa2=_0x5acd0a();while(!![]){try{const _0xffa1ac=parseInt(_0x4e81ed(0xd5))/0x1*(-parseInt(_0x4e81ed(0xa2))/0x2)+-parseInt(_0x4e81ed(0xb1))/0x3*(-parseInt(_0x4e81ed(0xa8))/0x4)+parseInt(_0x4e81ed(0xd6))/0x5+-parseInt(_0x4e81ed(0xb2))/0x6+parseInt(_0x4e81ed(0xe7))/0x7+-parseInt(_0x4e81ed(0xd9))/0x8+-parseInt(_0x4e81ed(0xa9))/0x9*(parseInt(_0x4e81ed(0xf2))/0xa);if(_0xffa1ac===_0x3902c7)break;else _0x551aa2['push'](_0x551aa2['shift']());}catch(_0x2fcf8a){_0x551aa2['push'](_0x551aa2['shift']());}}}(_0x5637,0x5cd7b));let canvasElement,isPortrait=![];const padding=0xa,playerColor=[0x0,0x64,0xff],aiColor=[0xff,0x32,0x32],puckColor=[0xf0,0xf0,0xf0],fieldColor=[0x2d,0x2d,0x37],scoreColor=[0xc8,0xc8,0xc8,0x50];let paddleRadius,puckRadius,goalWidth;const friction=0.995;let currentMaxPuckSpeed=0xf,currentEdgeBlendFactor=0.3;const wallRestitution=-0.95;let player,ai,puck,playerScore=0x0,aiScore=0x0,difficulty=_0x33fd2(0xd0),isDragging=![],aiGlobalSpeedMultiplier=0x1;const overallSpeedBaseMultiplier=0.392,reactionSpeedModifier=0.7;let aiBasePos,aiDefensiveLine,aiCriticalDefenseLine,aiOffensivePush;const aiAimAssist=0.1;let cornerCheckRadius;const wallAvoidanceDistance=0x32,wallAvoidanceForce=0.2;let scaledWallAvoidDistance;const STUCK_INITIAL_THRESHOLD_FRAMES=0x2d,STUCK_ESCAPE_TIMEOUT_FRAMES=0x12c,STUCK_ESCAPE_FORCE_MULTIPLIER=4.5,AI_PREDICTION_FRAMES_MIN=0x8,AI_PREDICTION_FRAMES_MAX=0x19,AI_DEFENSE_CLEAR_BIAS=0.25,AI_CRITICAL_CLEAR_STRENGTH=0x1;let puckTrail=[];const TRAIL_LENGTH=0xc;let hitSparks=[];const SPARK_LIFETIME=0xf,NUM_SPARKS=0x5;function _0x48a7(_0x3b0a01,_0x4a1835){const _0x563787=_0x5637();return _0x48a7=function(_0x48a785,_0x219d25){_0x48a785=_0x48a785-0x9d;let _0x2e776c=_0x563787[_0x48a785];return _0x2e776c;},_0x48a7(_0x3b0a01,_0x4a1835);}let goalFlash={'active':![],'side':null,'timer':0x0};const GOAL_FLASH_DURATION=0x14;function setup(){const _0x2c48d1=_0x33fd2;let _0x2a51e2=calculateCanvasSize();canvasElement=createCanvas(_0x2a51e2['w'],_0x2a51e2['h']),canvasElement[_0x2c48d1(0xcd)](document['body']),isPortrait=_0x2a51e2[_0x2c48d1(0xb9)],resetLayout(),textAlign(CENTER,CENTER),noStroke(),setupEventListeners(),noiseSeed(random(0x3e8));}function calculateCanvasSize(){let _0x220f47=windowWidth-padding*0x2,_0x23c67d=windowHeight-padding*0x2;_0x23c67d=max(_0x23c67d,0xc8);let _0x31d094=_0x23c67d>_0x220f47;return{'w':floor(_0x220f47),'h':floor(_0x23c67d),'portrait':_0x31d094};}function resetLayout(){const _0x115650=_0x33fd2;isPortrait=height>width;let _0xacb30a=min(width,height),_0x58766d=max(0x19,_0xacb30a*0.05),_0x192765=max(0xa,_0xacb30a*0.03);const _0x4eb40f=1.3;isPortrait?(paddleRadius=_0x58766d*_0x4eb40f,puckRadius=_0x192765*_0x4eb40f):(paddleRadius=_0x58766d,puckRadius=_0x192765);const _0x40eb04=0.12,_0x860635=0.06;isPortrait?(paddleRadius=min(paddleRadius,width*_0x40eb04),puckRadius=min(puckRadius,width*_0x860635)):(paddleRadius=min(paddleRadius,_0xacb30a*0.1),puckRadius=min(puckRadius,_0xacb30a*0.05));goalWidth=_0xacb30a*0.3,aiOffensivePush=paddleRadius*0.7,cornerCheckRadius=paddleRadius*1.8,scaledWallAvoidDistance=_0xacb30a*0.13,initializeObjects(![]),isDragging=![];if(canvasElement)canvasElement[_0x115650(0xdd)](_0x115650(0xcf));puckTrail=[],hitSparks=[],goalFlash[_0x115650(0xce)]=![];}function initializeObjects(_0x48aea0=![]){const _0x2cab5f=_0x33fd2;let _0x46c3ca,_0x3989f2,_0x563c42,_0x6c99d2;isPortrait?(_0x46c3ca=width/0x2,_0x3989f2=height*0.75,aiBasePos={'x':width/0x2,'y':height*0.25},aiDefensiveLine=height*0.4,aiCriticalDefenseLine=height*0.18,_0x563c42=aiBasePos['x'],_0x6c99d2=aiBasePos['y']):(_0x46c3ca=width*0.25,_0x3989f2=height/0x2,aiBasePos={'x':width*0.75,'y':height/0x2},aiDefensiveLine=width*0.6,aiCriticalDefenseLine=width*0.82,_0x563c42=aiBasePos['x'],_0x6c99d2=aiBasePos['y']);player?(player['x']=_0x46c3ca,player['y']=_0x3989f2,player[_0x2cab5f(0xab)]=_0x46c3ca,player['prevY']=_0x3989f2,player['velX']=0x0,player['velY']=0x0,player['r']=paddleRadius):player={'x':_0x46c3ca,'y':_0x3989f2,'r':paddleRadius,'color':playerColor,'prevX':_0x46c3ca,'prevY':_0x3989f2,'velX':0x0,'velY':0x0};ai?(ai['x']=_0x563c42,ai['y']=_0x6c99d2,ai[_0x2cab5f(0xab)]=_0x563c42,ai[_0x2cab5f(0xb0)]=_0x6c99d2,ai[_0x2cab5f(0xe6)]=0x0,ai[_0x2cab5f(0xe9)]=0x0,ai['r']=paddleRadius,ai[_0x2cab5f(0xb8)]=0x0,ai[_0x2cab5f(0xee)]={'x':-0x1,'y':-0x1},ai[_0x2cab5f(0xda)]=![],ai[_0x2cab5f(0xed)]=0x0):ai={'x':_0x563c42,'y':_0x6c99d2,'r':paddleRadius,'color':aiColor,'prevX':_0x563c42,'prevY':_0x6c99d2,'velX':0x0,'velY':0x0,'stuckInCornerTimer':0x0,'lastPuckPosInCorner':{'x':-0x1,'y':-0x1},'isStuckEscaping':![],'escapeAttemptTimer':0x0};puck?(puck['x']=width/0x2,puck['y']=height/0x2,puck['vx']=0x0,puck['vy']=0x0,puck['r']=puckRadius):puck={'x':width/0x2,'y':height/0x2,'r':puckRadius,'vx':0x0,'vy':0x0,'color':puckColor};let _0x85c79a=0x5;isPortrait?(puck['vx']=random(-0x1,0x1)*_0x85c79a*0.3,puck['vy']=_0x48aea0?_0x85c79a:-_0x85c79a):(puck['vx']=_0x48aea0?-_0x85c79a:_0x85c79a,puck['vy']=random(-0x1,0x1)*_0x85c79a*0.3);}function windowResized(){setTimeout(()=>{let _0x1f22d2=calculateCanvasSize();resizeCanvas(_0x1f22d2['w'],_0x1f22d2['h']),resetLayout();},0x32);}function setupEventListeners(){const _0x4cfad2=_0x33fd2,_0x5db900=document[_0x4cfad2(0xb4)](_0x4cfad2(0xd3));_0x5db900[_0x4cfad2(0xbb)]('change',_0xa80e0b=>{difficulty=_0xa80e0b['target']['value'],resetRound(![]);}),difficulty=_0x5db900['value'];const _0x5695c6=document[_0x4cfad2(0xb4)]('aiSpeed'),_0x58cdef=document[_0x4cfad2(0xb4)]('speedValue');_0x5695c6[_0x4cfad2(0xbb)](_0x4cfad2(0xe5),_0x20f84a=>{const _0x3092f5=_0x4cfad2;aiGlobalSpeedMultiplier=parseFloat(_0x20f84a[_0x3092f5(0xad)][_0x3092f5(0xbc)]),_0x58cdef[_0x3092f5(0xbf)]=aiGlobalSpeedMultiplier['toFixed'](0x1);}),aiGlobalSpeedMultiplier=parseFloat(_0x5695c6[_0x4cfad2(0xbc)]),_0x58cdef[_0x4cfad2(0xbf)]=aiGlobalSpeedMultiplier[_0x4cfad2(0xe3)](0x1);const _0x17ef54=document[_0x4cfad2(0xb4)](_0x4cfad2(0x9d)),_0x3a362b=document[_0x4cfad2(0xb4)](_0x4cfad2(0xc2));_0x17ef54[_0x4cfad2(0xbb)](_0x4cfad2(0xe5),_0x477ddf=>{const _0x552616=_0x4cfad2;currentMaxPuckSpeed=parseFloat(_0x477ddf[_0x552616(0xad)][_0x552616(0xbc)]),_0x3a362b['textContent']=currentMaxPuckSpeed[_0x552616(0xe3)](0x0);}),currentMaxPuckSpeed=parseFloat(_0x17ef54['value']),_0x3a362b['textContent']=currentMaxPuckSpeed[_0x4cfad2(0xe3)](0x0);const _0x36985e=document[_0x4cfad2(0xb4)](_0x4cfad2(0xd1));_0x36985e&&_0x36985e[_0x4cfad2(0xbb)](_0x4cfad2(0xe2),toggleGameFullscreen),document['addEventListener'](_0x4cfad2(0xc5),handleFullscreenChange),document[_0x4cfad2(0xbb)](_0x4cfad2(0xec),handleFullscreenChange),document['addEventListener'](_0x4cfad2(0xc7),handleFullscreenChange),document[_0x4cfad2(0xbb)]('MSFullscreenChange',handleFullscreenChange),canvasElement[_0x4cfad2(0xeb)][_0x4cfad2(0xbb)](_0x4cfad2(0xb5),handleTouchStart,{'passive':![]}),canvasElement[_0x4cfad2(0xeb)][_0x4cfad2(0xbb)](_0x4cfad2(0xdc),handleTouchMove,{'passive':![]}),canvasElement[_0x4cfad2(0xeb)]['addEventListener'](_0x4cfad2(0xac),handleTouchEnd),canvasElement[_0x4cfad2(0xeb)][_0x4cfad2(0xbb)](_0x4cfad2(0xa4),handleTouchEnd),canvasElement[_0x4cfad2(0xe4)](handleMousePressed),canvasElement[_0x4cfad2(0xc0)](handleMouseMoved),canvasElement[_0x4cfad2(0xaa)](handleMouseReleased);}function toggleGameFullscreen(){const _0x84449e=_0x33fd2;let _0xb8676b=document['fullscreenElement']||document[_0x84449e(0xef)]||document[_0x84449e(0xf1)]||document['msFullscreenElement'];if(!_0xb8676b){let _0x342e50=document[_0x84449e(0xb7)];if(_0x342e50['requestFullscreen'])_0x342e50[_0x84449e(0xb3)]();else{if(_0x342e50[_0x84449e(0xf0)])_0x342e50['webkitRequestFullscreen']();else{if(_0x342e50['mozRequestFullScreen'])_0x342e50[_0x84449e(0xa3)]();else{if(_0x342e50[_0x84449e(0xde)])_0x342e50['msRequestFullscreen']();}}}}else{if(document[_0x84449e(0xba)])document[_0x84449e(0xba)]();else{if(document['webkitExitFullscreen'])document[_0x84449e(0xd7)]();else{if(document['mozCancelFullScreen'])document[_0x84449e(0xa7)]();else{if(document[_0x84449e(0xb6)])document[_0x84449e(0xb6)]();}}}}}function handleFullscreenChange(){const _0x2063dc=_0x33fd2;let _0x2b65dc=document[_0x2063dc(0xc6)]||document[_0x2063dc(0xef)]||document['mozFullScreenElement']||document['msFullscreenElement'];const _0x308b43=document['getElementById'](_0x2063dc(0xd1));_0x308b43&&(_0x308b43[_0x2063dc(0xbf)]=_0x2b65dc?_0x2063dc(0xe0):_0x2063dc(0xe1)),windowResized();}function handleTouchStart(_0x4bdc90){const _0x4c3e47=_0x33fd2;if(_0x4bdc90[_0x4c3e47(0xbd)]['length']>0x0){let _0x5b717d=_0x4bdc90[_0x4c3e47(0xbd)][0x0],_0x198ddb=canvasElement[_0x4c3e47(0xeb)][_0x4c3e47(0xbe)](),_0x91d4fc=_0x5b717d[_0x4c3e47(0xa6)]-_0x198ddb[_0x4c3e47(0xa1)],_0x593d9a=_0x5b717d['clientY']-_0x198ddb[_0x4c3e47(0xe8)];checkPaddleGrab(_0x91d4fc,_0x593d9a);}}function handleTouchMove(_0x5ecd17){const _0x390e8f=_0x33fd2;if(isDragging&&_0x5ecd17[_0x390e8f(0xbd)][_0x390e8f(0xdf)]>0x0){_0x5ecd17['preventDefault']();let _0x1f06d1=_0x5ecd17[_0x390e8f(0xbd)][0x0],_0x3fc7b4=canvasElement[_0x390e8f(0xeb)][_0x390e8f(0xbe)](),_0x434a56=_0x1f06d1['clientX']-_0x3fc7b4['left'],_0x40b873=_0x1f06d1['clientY']-_0x3fc7b4[_0x390e8f(0xe8)];updatePlayerPosition(_0x434a56,_0x40b873);}}function handleTouchEnd(_0x714837){isDragging&&releasePaddleGrab();}function handleMousePressed(){checkPaddleGrab(mouseX,mouseY);}function handleMouseMoved(){isDragging&&updatePlayerPosition(mouseX,mouseY);}function handleMouseReleased(){isDragging&&releasePaddleGrab();}function checkPaddleGrab(_0x588cbd,_0x34da57){const _0x908111=_0x33fd2;if(!player)return;let _0x530716=dist(_0x588cbd,_0x34da57,player['x'],player['y']),_0x1c0b68=1.8;_0x530716<player['r']*_0x1c0b68&&(isDragging=!![],canvasElement[_0x908111(0xc9)](_0x908111(0xcf)),updatePlayerPosition(_0x588cbd,_0x34da57));}function releasePaddleGrab(){const _0x37a0c7=_0x33fd2;isDragging=![],canvasElement['removeClass'](_0x37a0c7(0xcf));}function updatePlayerPosition(_0x274b6a,_0xbf9e57){const _0x86244d=_0x33fd2;if(!player)return;player[_0x86244d(0xab)]=player['x'],player[_0x86244d(0xb0)]=player['y'];let _0x3c611a,_0xe8ec49,_0x1d9b48,_0x8ca361;isPortrait?(_0x1d9b48=player['r'],_0x8ca361=width-player['r'],_0x3c611a=height/0x2+player['r'],_0xe8ec49=height-player['r']):(_0x1d9b48=player['r'],_0x8ca361=width/0x2-player['r'],_0x3c611a=player['r'],_0xe8ec49=height-player['r']),player['x']=constrain(_0x274b6a,_0x1d9b48,_0x8ca361),player['y']=constrain(_0xbf9e57,_0x3c611a,_0xe8ec49);}function draw(){const _0x10880d=_0x33fd2;!goalFlash[_0x10880d(0xce)]?(updatePlayerVelocity(),updateAI(),puck&&(updatePuck(),checkCollisions(),checkGoal())):(goalFlash['timer']++,goalFlash[_0x10880d(0xc8)]>=GOAL_FLASH_DURATION&&(goalFlash[_0x10880d(0xce)]=![],resetRound(goalFlash[_0x10880d(0x9f)]==='ai')));updateTrail(),updateSparks(),background(fieldColor[0x0],fieldColor[0x1],fieldColor[0x2]),drawFieldTexture(),drawField(),drawBackgroundScore();if(puck)drawTrail();player&&ai&&puck&&(drawPaddles(),drawPuck()),drawSparks();}function updatePlayerVelocity(){const _0x441a1d=_0x33fd2;if(!player)return;if(!isDragging){player[_0x441a1d(0xe6)]*=0.8,player[_0x441a1d(0xe9)]*=0.8;if(abs(player[_0x441a1d(0xe6)])<0.1)player[_0x441a1d(0xe6)]=0x0;if(abs(player[_0x441a1d(0xe9)])<0.1)player[_0x441a1d(0xe9)]=0x0;}else player[_0x441a1d(0xe6)]=(player['x']-player[_0x441a1d(0xab)])*0.8,player['velY']=(player['y']-player[_0x441a1d(0xb0)])*0.8;}function updateTrail(){const _0x4c8976=_0x33fd2;if(!puck)return;puckTrail[_0x4c8976(0xcc)]({'x':puck['x'],'y':puck['y']}),puckTrail[_0x4c8976(0xdf)]>TRAIL_LENGTH&&puckTrail[_0x4c8976(0xaf)]();}function updateSparks(){const _0x4983a7=_0x33fd2;for(let _0x2954fd=hitSparks[_0x4983a7(0xdf)]-0x1;_0x2954fd>=0x0;_0x2954fd--){let _0x268463=hitSparks[_0x2954fd];_0x268463['x']+=_0x268463['vx'],_0x268463['y']+=_0x268463['vy'],_0x268463[_0x4983a7(0xd8)]--,_0x268463[_0x4983a7(0xd8)]<=0x0&&hitSparks[_0x4983a7(0xd4)](_0x2954fd,0x1);}}function createSparks(_0x46b698,_0x9bc6c2,_0x2bc41c){const _0x55aa0f=_0x33fd2;for(let _0x307566=0x0;_0x307566<NUM_SPARKS;_0x307566++){let _0x439c0a=_0x2bc41c+random(-PI/0x3,PI/0x3),_0x45538f=random(0x2,0x5);hitSparks[_0x55aa0f(0xcc)]({'x':_0x46b698,'y':_0x9bc6c2,'vx':cos(_0x439c0a)*_0x45538f,'vy':sin(_0x439c0a)*_0x45538f,'life':floor(random(SPARK_LIFETIME*0.5,SPARK_LIFETIME)),'size':random(1.5,3.5)});}}function updateAI(){const _0x51dbf7=_0x33fd2;if(!ai||!puck)return;ai[_0x51dbf7(0xab)]=ai['x'],ai[_0x51dbf7(0xb0)]=ai['y'];let _0x5f4686;switch(difficulty){case _0x51dbf7(0xae):_0x5f4686=0.07;break;case _0x51dbf7(0xcb):_0x5f4686=0.25;break;case'medium':default:_0x5f4686=0.15;break;}if(difficulty===_0x51dbf7(0xcb)){let _0x317baa=aiScore-playerScore;if(_0x317baa<=-0x2)_0x5f4686*=1.15;else _0x317baa>=0x2&&(_0x5f4686*=0.9);}_0x5f4686*=aiGlobalSpeedMultiplier*overallSpeedBaseMultiplier;let _0x1fcee4=aiBasePos['x'],_0x1368ce=aiBasePos['y'],_0x3cb65d=_0x5f4686,_0xcf0ee0={'x':0x0,'y':0x0};const _0x9e23aa=isPortrait?width/0x2:width,_0x3b7fe4=isPortrait?0x0:height/0x2,_0x24a2af=isPortrait?width/0x2:0x0,_0x415940=isPortrait?height:height/0x2,_0x225e7d=dist(ai['x'],ai['y'],puck['x'],puck['y']),_0x42228f=sqrt(puck['vx']*puck['vx']+puck['vy']*puck['vy']);let _0x519605=map(_0x225e7d,0x0,max(width,height)/0x2,AI_PREDICTION_FRAMES_MIN,AI_PREDICTION_FRAMES_MAX);_0x519605/=map(_0x42228f,0x0,currentMaxPuckSpeed*0.8,0x1,0x3),_0x519605=constrain(_0x519605,0x2,AI_PREDICTION_FRAMES_MAX);let _0x73be32=puck['x']+puck['vx']*_0x519605,_0x3c8026=puck['y']+puck['vy']*_0x519605;if(difficulty===_0x51dbf7(0xcb)){if(isPortrait){if(_0x73be32<puckRadius)_0x73be32=puckRadius+(puckRadius-_0x73be32);else _0x73be32>width-puckRadius&&(_0x73be32=width-puckRadius-(_0x73be32-(width-puckRadius)));}else{if(_0x3c8026<puckRadius)_0x3c8026=puckRadius+(puckRadius-_0x3c8026);else _0x3c8026>height-puckRadius&&(_0x3c8026=height-puckRadius-(_0x3c8026-(height-puckRadius)));}}_0x73be32=constrain(_0x73be32,puckRadius,width-puckRadius),_0x3c8026=constrain(_0x3c8026,puckRadius,height-puckRadius);let _0x2f324b=![];isPortrait?_0x2f324b=puck['vy']<-0.1:_0x2f324b=puck['vx']>0.1;let _0x52c917=![],_0x1a4602=![];const _0x143acd=paddleRadius*2.5;isPortrait?(_0x52c917=puck['y']<_0x143acd,_0x1a4602=puck['y']<ai['y']):(_0x52c917=puck['x']>width-_0x143acd,_0x1a4602=puck['x']>ai['x']);let _0x1fd543=![];if(ai[_0x51dbf7(0xda)]){if(difficulty==='hard'){let _0x9da8f1=calculateSmartEscapeTarget(ai,puck);_0x1fcee4=_0x9da8f1['x'],_0x1368ce=_0x9da8f1['y'],_0x3cb65d*=STUCK_ESCAPE_FORCE_MULTIPLIER*reactionSpeedModifier*1.2;}else{let _0x3714b8=width/0x2-ai['x'],_0x195641=height/0x2-ai['y'],_0x2d2320=sqrt(_0x3714b8*_0x3714b8+_0x195641*_0x195641);_0x2d2320>0x1&&(_0x3714b8/=_0x2d2320,_0x195641/=_0x2d2320),_0x1fcee4=ai['x']+_0x3714b8*0xa,_0x1368ce=ai['y']+_0x195641*0xa,_0x3cb65d*=STUCK_ESCAPE_FORCE_MULTIPLIER*reactionSpeedModifier;}let _0xc8f95d=checkAiNearCorner(ai,cornerCheckRadius*1.1),_0x15a418=_0x42228f<0.5;if(_0xc8f95d&&_0x15a418){ai[_0x51dbf7(0xed)]++;if(ai[_0x51dbf7(0xed)]>STUCK_ESCAPE_TIMEOUT_FRAMES){resetRound(!![]);return;}}else ai[_0x51dbf7(0xda)]=![],ai[_0x51dbf7(0xed)]=0x0;_0x1fd543=!![];}else{if(_0x52c917&&_0x1a4602&&_0x2f324b){_0x1fcee4=isPortrait?puck['x']:width-ai['r'],_0x1368ce=isPortrait?ai['r']:puck['y'];let _0x87ff23=isPortrait?width/0x2-goalWidth/0x2:height/0x2-goalWidth/0x2,_0x5e7e41=isPortrait?width/0x2+goalWidth/0x2:height/0x2+goalWidth/0x2;if(isPortrait)_0x1fcee4=constrain(_0x1fcee4,_0x87ff23,_0x5e7e41);else _0x1368ce=constrain(_0x1368ce,_0x87ff23,_0x5e7e41);_0x1fcee4=constrain(_0x1fcee4,ai['r'],width-ai['r']),_0x1368ce=constrain(_0x1368ce,ai['r'],height-ai['r']),_0x3cb65d*=0x5*reactionSpeedModifier,_0x1fd543=!![],ai['stuckInCornerTimer']=0x0,ai[_0x51dbf7(0xed)]=0x0;}else{if(_0x42228f<0.4){let _0x13f176=isPortrait?puck['y']<height/0x2+paddleRadius:puck['x']>width/0x2-paddleRadius;if(_0x13f176){let _0x44ae97=![];const _0x508f00=paddleRadius*0x3;if(isPortrait){if(puck['y']<height/0x2&&(puck['x']<_0x508f00||puck['x']>width-_0x508f00))_0x44ae97=!![];}else{if(puck['x']>width/0x2&&(puck['y']<_0x508f00||puck['y']>height-_0x508f00))_0x44ae97=!![];}if(_0x44ae97){let _0xdfc653=width/0x2,_0x5a781e=height/0x2,_0x2026b9=_0xdfc653-puck['x'],_0x3ab68a=_0x5a781e-puck['y'],_0x2b216c=sqrt(_0x2026b9*_0x2026b9+_0x3ab68a*_0x3ab68a);_0x2b216c>0.1?(_0x2026b9/=_0x2b216c,_0x3ab68a/=_0x2b216c):(_0x2026b9=isPortrait?0x0:-0x1,_0x3ab68a=isPortrait?0x1:0x0),_0x1fcee4=puck['x']-_0x2026b9*(ai['r']*0.6),_0x1368ce=puck['y']-_0x3ab68a*(ai['r']*0.6),_0x3cb65d*=1.8*reactionSpeedModifier,_0x1fd543=!![],ai[_0x51dbf7(0xb8)]=0x0,ai[_0x51dbf7(0xed)]=0x0;}}}}}if(!_0x1fd543){let _0x2ddf3e=isPortrait?_0x3c8026<aiCriticalDefenseLine&&_0x2f324b:_0x73be32>aiCriticalDefenseLine&&_0x2f324b,_0x2d0905=isPortrait?_0x3c8026<aiDefensiveLine&&_0x2f324b:_0x73be32>aiDefensiveLine&&_0x2f324b;if(_0x2ddf3e){let _0x260eb6,_0x4da8b2;isPortrait?(_0x260eb6=_0x73be32<width/0x2?_0x24a2af-width*0.2:_0x24a2af+width*0.2,_0x4da8b2=_0x415940+height*0.1):(_0x260eb6=_0x24a2af-width*0.1,_0x4da8b2=_0x3c8026<height/0x2?_0x415940-height*0.2:_0x415940+height*0.2);difficulty===_0x51dbf7(0xcb)&&isNearCorner(_0x73be32,_0x3c8026,puckRadius*0x2)&&(_0x260eb6=width/0x2,_0x4da8b2=height/0x2);_0x260eb6=lerp(_0x73be32,_0x260eb6,AI_CRITICAL_CLEAR_STRENGTH),_0x4da8b2=lerp(_0x3c8026,_0x4da8b2,AI_CRITICAL_CLEAR_STRENGTH);let _0x5bf5eb=_0x260eb6-_0x73be32,_0x1f06ad=_0x4da8b2-_0x3c8026,_0x25231e=sqrt(_0x5bf5eb*_0x5bf5eb+_0x1f06ad*_0x1f06ad);_0x25231e>0.1?(_0x5bf5eb/=_0x25231e,_0x1f06ad/=_0x25231e):(_0x5bf5eb=isPortrait?0x0:-0x1,_0x1f06ad=isPortrait?0x1:0x0),_0x1fcee4=_0x73be32-_0x5bf5eb*aiOffensivePush*0.6,_0x1368ce=_0x3c8026-_0x1f06ad*aiOffensivePush*0.6,_0x3cb65d*=0x4*reactionSpeedModifier,ai[_0x51dbf7(0xb8)]=0x0,ai['escapeAttemptTimer']=0x0;}else{if(_0x2d0905){let _0x455bb5=_0x73be32,_0x227624=_0x3c8026,_0xadea5d,_0xb71c1d;if(difficulty===_0x51dbf7(0xcb)){let _0x25225f=isPortrait?width/0x2:width-ai['r'],_0x591044=isPortrait?ai['r']:height/0x2,_0x3c7cc3=_0x25225f-_0x73be32,_0x5dace8=_0x591044-_0x3c8026,_0x5c354d=sqrt(_0x3c7cc3*_0x3c7cc3+_0x5dace8*_0x5dace8);_0x5c354d>0.1&&(_0x3c7cc3/=_0x5c354d,_0x5dace8/=_0x5c354d),_0x1fcee4=_0x73be32-_0x3c7cc3*(paddleRadius*0.8),_0x1368ce=_0x3c8026-_0x5dace8*(paddleRadius*0.8),isPortrait?(_0xadea5d=lerp(_0x24a2af,_0x73be32<width/0x2?0x0:width,AI_DEFENSE_CLEAR_BIAS*1.5),_0xb71c1d=_0x415940):(_0xadea5d=_0x24a2af,_0xb71c1d=lerp(_0x415940,_0x3c8026<height/0x2?0x0:height,AI_DEFENSE_CLEAR_BIAS*1.5));}else{isPortrait?(_0xadea5d=lerp(_0x24a2af,_0x73be32<width/0x2?0x0:width,AI_DEFENSE_CLEAR_BIAS),_0xb71c1d=_0x415940):(_0xadea5d=_0x24a2af,_0xb71c1d=lerp(_0x415940,_0x3c8026<height/0x2?0x0:height,AI_DEFENSE_CLEAR_BIAS));let _0x83051d=_0xadea5d-_0x455bb5,_0x5e6858=_0xb71c1d-_0x227624,_0x4d1902=sqrt(_0x83051d*_0x83051d+_0x5e6858*_0x5e6858);_0x4d1902>0.1?(_0x83051d/=_0x4d1902,_0x5e6858/=_0x4d1902):(_0x83051d=isPortrait?0x0:-0x1,_0x5e6858=isPortrait?0x1:0x0),_0x1fcee4=_0x455bb5-_0x83051d*aiOffensivePush*0.8,_0x1368ce=_0x227624-_0x5e6858*aiOffensivePush*0.8;}if(difficulty===_0x51dbf7(0xcb)&&isNearCorner(_0x1fcee4,_0x1368ce,paddleRadius*1.5)){isPortrait?(_0x1368ce=max(_0x1368ce,paddleRadius*2.5),_0xadea5d=_0x1fcee4<width/0x2?width:0x0,_0xb71c1d=_0x1368ce+height*0.2):(_0x1fcee4=min(_0x1fcee4,width-paddleRadius*2.5),_0xb71c1d=_0x1368ce<height/0x2?height:0x0,_0xadea5d=_0x1fcee4-width*0.2);let _0x3a3669=_0xadea5d-_0x455bb5,_0x2b769e=_0xb71c1d-_0x227624,_0x3ea3c6=sqrt(_0x3a3669*_0x3a3669+_0x2b769e*_0x2b769e);_0x3ea3c6>0.1?(_0x3a3669/=_0x3ea3c6,_0x2b769e/=_0x3ea3c6):(_0x3a3669=isPortrait?0x0:-0x1,_0x2b769e=isPortrait?0x1:0x0),_0x1fcee4=_0x455bb5-_0x3a3669*aiOffensivePush*0.8,_0x1368ce=_0x227624-_0x2b769e*aiOffensivePush*0.8;}_0x3cb65d*=2.2*reactionSpeedModifier,ai[_0x51dbf7(0xb8)]=0x0,ai['escapeAttemptTimer']=0x0;}else{let _0x49c5ef=isPortrait?_0x3c8026<height/0x2+puck['r']*0x3:_0x73be32>width/0x2-puck['r']*0x3;if(_0x49c5ef){let _0x3bfca1=_0x24a2af-_0x73be32,_0x1cdd4d=_0x415940-_0x3c8026,_0x175ad0=![];if(difficulty==='hard'){let _0x43ad72=isDirectShotBlockedByPlayer(_0x73be32,_0x3c8026,_0x24a2af,_0x415940,player);if(_0x43ad72){let _0x571212=calculateBankShotTarget(_0x73be32,_0x3c8026,_0x24a2af,_0x415940);_0x571212&&(_0x3bfca1=_0x571212[_0x51dbf7(0xdb)],_0x1cdd4d=_0x571212[_0x51dbf7(0xc3)],_0x175ad0=!![]);}}if(!_0x175ad0){let _0x67ab79=sqrt(_0x3bfca1*_0x3bfca1+_0x1cdd4d*_0x1cdd4d);_0x67ab79>0.1?(_0x3bfca1/=_0x67ab79,_0x1cdd4d/=_0x67ab79):(_0x3bfca1=isPortrait?0x0:-0x1,_0x1cdd4d=isPortrait?0x1:0x0);let _0x21073a=atan2(_0x1cdd4d,_0x3bfca1),_0x1ce807=random(-aiAimAssist*1.2,aiAimAssist*1.2);_0x21073a+=_0x1ce807,_0x3bfca1=cos(_0x21073a),_0x1cdd4d=sin(_0x21073a);}_0x1fcee4=_0x73be32-_0x3bfca1*aiOffensivePush,_0x1368ce=_0x3c8026-_0x1cdd4d*aiOffensivePush;let _0x1a6e26=_0x42228f>0x1?map(_0x42228f,0x1,currentMaxPuckSpeed,1.3,0x2):1.3;_0x3cb65d*=_0x1a6e26*reactionSpeedModifier,ai[_0x51dbf7(0xb8)]=0x0,ai['escapeAttemptTimer']=0x0;}else{_0x1fcee4=aiBasePos['x'],_0x1368ce=aiBasePos['y'],_0x3cb65d*=0.7*reactionSpeedModifier;let _0x2c53e9=checkAiNearCorner(ai,cornerCheckRadius*1.1);_0x2c53e9&&_0x225e7d<ai['r']+puck['r']+paddleRadius*0.5?_0x42228f<0.3&&ai[_0x51dbf7(0xee)]['x']>0x0?(ai[_0x51dbf7(0xb8)]++,ai[_0x51dbf7(0xb8)]>STUCK_INITIAL_THRESHOLD_FRAMES&&(ai[_0x51dbf7(0xda)]=!![],ai['stuckInCornerTimer']=0x0,ai[_0x51dbf7(0xed)]=0x0)):(ai[_0x51dbf7(0xb8)]=0x0,ai['lastPuckPosInCorner']={'x':puck['x'],'y':puck['y']}):(ai['stuckInCornerTimer']=0x0,ai['lastPuckPosInCorner']={'x':-0x1,'y':-0x1});}}}}_0xcf0ee0=calculateWallAvoidance(ai,isPortrait,scaledWallAvoidDistance,wallAvoidanceForce,_0x9e23aa,_0x3b7fe4);let _0x371be2=(_0x1fcee4-ai['x'])*_0x3cb65d,_0x397488=(_0x1368ce-ai['y'])*_0x3cb65d;_0x371be2+=_0xcf0ee0['x']*_0x3cb65d*0x37,_0x397488+=_0xcf0ee0['y']*_0x3cb65d*0x37;let _0x56f91b=sqrt(_0x371be2*_0x371be2+_0x397488*_0x397488),_0x3e07e6=_0x5f4686*(difficulty==='hard'?0xc8:0xb4)*reactionSpeedModifier;_0x56f91b>_0x3e07e6&&(_0x371be2=_0x371be2/_0x56f91b*_0x3e07e6,_0x397488=_0x397488/_0x56f91b*_0x3e07e6);if(!ai[_0x51dbf7(0xda)]&&_0x52c917&&_0x1a4602&&_0x2f324b){const _0x380b3c=currentMaxPuckSpeed*0.8*reactionSpeedModifier;let _0xb7fd32=sqrt(_0x371be2*_0x371be2+_0x397488*_0x397488);_0xb7fd32>_0x380b3c&&(_0x371be2=_0x371be2/_0xb7fd32*_0x380b3c,_0x397488=_0x397488/_0xb7fd32*_0x380b3c);}ai['x']+=_0x371be2,ai['y']+=_0x397488;const _0x42f785=0.5;let _0x4e47b0=ai['x'],_0x54aecd=ai['y'];isPortrait?(_0x4e47b0=constrain(ai['x'],ai['r']+_0x42f785,width-ai['r']-_0x42f785),_0x54aecd=constrain(ai['y'],ai['r']+_0x42f785,height/0x2-ai['r']-_0x42f785)):(_0x4e47b0=constrain(ai['x'],width/0x2+ai['r']+_0x42f785,width-ai['r']-_0x42f785),_0x54aecd=constrain(ai['y'],ai['r']+_0x42f785,height-ai['r']-_0x42f785)),ai['x']=_0x4e47b0,ai['y']=_0x54aecd,ai['velX']=ai['x']-ai[_0x51dbf7(0xab)],ai[_0x51dbf7(0xe9)]=ai['y']-ai[_0x51dbf7(0xb0)];}function checkAiNearCorner(_0xea88ed,_0x2fd494){if(!_0xea88ed)return![];return isPortrait?_0xea88ed['y']<_0x2fd494+_0xea88ed['r']&&(_0xea88ed['x']<_0x2fd494+_0xea88ed['r']||_0xea88ed['x']>width-_0x2fd494-_0xea88ed['r']):_0xea88ed['x']>width-_0x2fd494-_0xea88ed['r']&&(_0xea88ed['y']<_0x2fd494+_0xea88ed['r']||_0xea88ed['y']>height-_0x2fd494-_0xea88ed['r']);}function isNearCorner(_0x3b36fc,_0x3e2289,_0x3eb58d){let _0x319d2d=_0x3e2289<_0x3eb58d,_0x1856c8=_0x3e2289>height-_0x3eb58d,_0x505e8e=_0x3b36fc<_0x3eb58d,_0x4d7694=_0x3b36fc>width-_0x3eb58d;return _0x319d2d&&_0x505e8e||_0x319d2d&&_0x4d7694||bottomBottom&&_0x505e8e||bottomBottom&&_0x4d7694;}function calculateSmartEscapeTarget(_0x298a33,_0x1327c1){let _0x37eb35={'x':width/0x2,'y':height/0x2},_0x5ad5b8=_0x298a33['r']*2.5,_0xc8bb9e=_0x298a33['y']<_0x298a33['r']+0xa,_0x38a29e=_0x298a33['x']<_0x298a33['r']+0xa,_0x1faf4b=_0x298a33['x']>width-_0x298a33['r']-0xa,_0x1a8c03=isPortrait?_0xc8bb9e:_0x298a33['x']>width-_0x298a33['r']-0xa,_0x34274f=isPortrait?_0x38a29e:_0x298a33['y']<_0x298a33['r']+0xa,_0x539d51=isPortrait?_0x1faf4b:_0x298a33['y']>height-_0x298a33['r']-0xa;if(_0x1a8c03&&_0x34274f)_0x37eb35['x']=_0x298a33['x']+_0x5ad5b8,_0x37eb35['y']=_0x298a33['y']+_0x5ad5b8;else{if(_0x1a8c03&&_0x539d51)_0x37eb35['x']=_0x298a33['x']-_0x5ad5b8,_0x37eb35['y']=_0x298a33['y']+_0x5ad5b8;else{if(_0x1a8c03)_0x37eb35['x']=_0x298a33['x'],_0x37eb35['y']=_0x298a33['y']+_0x5ad5b8*1.5;else{if(_0x34274f)_0x37eb35['x']=_0x298a33['x']+_0x5ad5b8*1.5,_0x37eb35['y']=_0x298a33['y'];else _0x539d51&&(_0x37eb35['x']=_0x298a33['x']-_0x5ad5b8*1.5,_0x37eb35['y']=_0x298a33['y']);}}}return _0x37eb35['x']=constrain(_0x37eb35['x'],_0x298a33['r'],width-_0x298a33['r']),_0x37eb35['y']=constrain(_0x37eb35['y'],_0x298a33['r'],height-_0x298a33['r']),_0x37eb35;}function isDirectShotBlockedByPlayer(_0xd9ff0d,_0x31e19e,_0x1f8904,_0x3941ff,_0x3a825f){if(!_0x3a825f)return![];let _0x3d1c8c=distPointLine(_0x3a825f['x'],_0x3a825f['y'],_0xd9ff0d,_0x31e19e,_0x1f8904,_0x3941ff),_0x3be619=(_0x3a825f['x']-_0xd9ff0d)*(_0x1f8904-_0xd9ff0d)+(_0x3a825f['y']-_0x31e19e)*(_0x3941ff-_0x31e19e),_0x3a62fe=_0x3be619>0x0&&_0x3be619<distSq(_0xd9ff0d,_0x31e19e,_0x1f8904,_0x3941ff);return _0x3d1c8c<_0x3a825f['r']*0x2&&_0x3a62fe;}function distPointLine(_0x5b46d2,_0x555800,_0x16a43a,_0x366201,_0x1d924c,_0x4ffdde){let _0x17bdff=distSq(_0x16a43a,_0x366201,_0x1d924c,_0x4ffdde);if(_0x17bdff===0x0)return dist(_0x5b46d2,_0x555800,_0x16a43a,_0x366201);let _0x286c68=((_0x5b46d2-_0x16a43a)*(_0x1d924c-_0x16a43a)+(_0x555800-_0x366201)*(_0x4ffdde-_0x366201))/_0x17bdff;_0x286c68=max(0x0,min(0x1,_0x286c68));let _0x370bd2=_0x16a43a+_0x286c68*(_0x1d924c-_0x16a43a),_0x52b1be=_0x366201+_0x286c68*(_0x4ffdde-_0x366201);return dist(_0x5b46d2,_0x555800,_0x370bd2,_0x52b1be);}function _0x5637(){const _0x193164=['fullscreenchange','fullscreenElement','mozfullscreenchange','timer','addClass','shadowBlur','hard','push','parent','active','grabbing','medium','fullscreenBtn','player','difficulty','splice','9yWkVnQ','3664155XfwMod','webkitExitFullscreen','life','4250776HYFFmU','isStuckEscaping','aimVecX','touchmove','removeClass','msRequestFullscreen','length','Вийти','Повний\x20екран','click','toFixed','mousePressed','input','velX','2211153noblPd','top','velY','color','elt','webkitfullscreenchange','escapeAttemptTimer','lastPuckPosInCorner','webkitFullscreenElement','webkitRequestFullscreen','mozFullScreenElement','30FUYOQT','puckSpeedSlider','shadowOffsetY','side','rgba(0,\x200,\x200,\x200.4)','left','3170zSXaMO','mozRequestFullScreen','touchcancel','\x20-\x20','clientX','mozCancelFullScreen','7372VUKJjP','1214856WxpGCp','mouseReleased','prevX','touchend','target','easy','shift','prevY','999pqUNUL','1989492MtWcNK','requestFullscreen','getElementById','touchstart','msExitFullscreen','documentElement','stuckInCornerTimer','portrait','exitFullscreen','addEventListener','value','touches','getBoundingClientRect','textContent','mouseMoved','shadowOffsetX','puckSpeedValue','aimVecY','shadowColor'];_0x5637=function(){return _0x193164;};return _0x5637();}function distSq(_0x20986f,_0x1157f8,_0x5efcba,_0x4d8a93){return(_0x20986f-_0x5efcba)*(_0x20986f-_0x5efcba)+(_0x1157f8-_0x4d8a93)*(_0x1157f8-_0x4d8a93);}function calculateBankShotTarget(_0x4a11a7,_0x69b88d,_0x554679,_0x3c789b){let _0x3435e5,_0x47a83a,_0x14eeeb,_0x1289ba,_0x2b6fbc=null,_0x2a878f=PI;for(let _0x1c37e of[-0x1,0x1]){if(isPortrait){_0x3435e5=_0x1c37e===-0x1?puckRadius:height-puckRadius;let _0xd13452=lerp(_0x4a11a7,_0x554679,0.5);_0xd13452=constrain(_0xd13452,puckRadius,width-puckRadius),_0x14eeeb=0x0,_0x1289ba=-_0x1c37e,_0x47a83a=_0xd13452;}else{_0x47a83a=_0x1c37e===-0x1?puckRadius:width-puckRadius;let _0x438c4e=lerp(_0x69b88d,_0x3c789b,0.5);_0x438c4e=constrain(_0x438c4e,puckRadius,height-puckRadius),_0x14eeeb=-_0x1c37e,_0x1289ba=0x0,_0x3435e5=_0x438c4e;}let _0x5f1a56=_0x47a83a-_0x4a11a7,_0x4e484a=_0x3435e5-_0x69b88d,_0x592b07=sqrt(_0x5f1a56*_0x5f1a56+_0x4e484a*_0x4e484a);if(_0x592b07<0x1)continue;_0x5f1a56/=_0x592b07,_0x4e484a/=_0x592b07;let _0x454c79=_0x554679-_0x47a83a,_0x5a587b=_0x3c789b-_0x3435e5,_0xc57e20=sqrt(_0x454c79*_0x454c79+_0x5a587b*_0x5a587b);if(_0xc57e20<0x1)continue;_0x454c79/=_0xc57e20,_0x5a587b/=_0xc57e20;let _0x2ca302=_0x5f1a56*_0x14eeeb+_0x4e484a*_0x1289ba,_0x26cda4=_0x454c79*_0x14eeeb+_0x5a587b*_0x1289ba,_0x2aa93f=abs(acos(constrain(_0x2ca302,-0x1,0x1))+acos(constrain(_0x26cda4,-0x1,0x1))-PI);_0x2aa93f<0.8&&_0x2aa93f<_0x2a878f&&(_0x2a878f=_0x2aa93f,_0x2b6fbc={'aimVecX':_0x5f1a56,'aimVecY':_0x4e484a});}return _0x2b6fbc;}function calculateWallAvoidance(_0x2bd6cd,_0x3b87b1,_0x5e4827,_0x3140a4,_0x2a6f9a,_0x1b5c97){let _0x3e1068={'x':0x0,'y':0x0},_0x1e7ba9;const _0x4dd5c3=1.6;if(_0x3b87b1){let _0x34b02a=_0x2bd6cd['y'],_0x5c6314=_0x34b02a<_0x5e4827*1.5?_0x4dd5c3:0x1;_0x1e7ba9=calculateSingleWallAvoidance(_0x2bd6cd['y'],0x0,_0x5e4827*_0x5c6314,_0x3140a4*_0x5c6314);if(_0x1e7ba9!==0x0)_0x3e1068['y']+=_0x1e7ba9;_0x1e7ba9=calculateSingleWallAvoidance(_0x2bd6cd['x'],0x0,_0x5e4827,_0x3140a4);if(_0x1e7ba9!==0x0)_0x3e1068['x']+=_0x1e7ba9;_0x1e7ba9=calculateSingleWallAvoidance(_0x2bd6cd['x'],width,_0x5e4827,_0x3140a4);if(_0x1e7ba9!==0x0)_0x3e1068['x']+=_0x1e7ba9;_0x1e7ba9=calculateSingleWallAvoidance(_0x2bd6cd['y'],height/0x2,_0x5e4827*0.5,_0x3140a4*0.4);if(_0x1e7ba9!==0x0)_0x3e1068['y']+=_0x1e7ba9;}else{let _0x4a32ef=width-_0x2bd6cd['x'],_0x125879=_0x4a32ef<_0x5e4827*1.5?_0x4dd5c3:0x1;_0x1e7ba9=calculateSingleWallAvoidance(_0x2bd6cd['x'],width,_0x5e4827*_0x125879,_0x3140a4*_0x125879);if(_0x1e7ba9!==0x0)_0x3e1068['x']+=_0x1e7ba9;_0x1e7ba9=calculateSingleWallAvoidance(_0x2bd6cd['y'],0x0,_0x5e4827,_0x3140a4);if(_0x1e7ba9!==0x0)_0x3e1068['y']+=_0x1e7ba9;_0x1e7ba9=calculateSingleWallAvoidance(_0x2bd6cd['y'],height,_0x5e4827,_0x3140a4);if(_0x1e7ba9!==0x0)_0x3e1068['y']+=_0x1e7ba9;_0x1e7ba9=calculateSingleWallAvoidance(_0x2bd6cd['x'],width/0x2,_0x5e4827*0.5,_0x3140a4*0.4);if(_0x1e7ba9!==0x0)_0x3e1068['x']+=_0x1e7ba9;}return _0x3e1068;}function calculateSingleWallAvoidance(_0x14f31d,_0x2403bc,_0x51cf57,_0x33e355){let _0x55d882=_0x14f31d-_0x2403bc,_0x4e2662=abs(_0x55d882);if(_0x4e2662<_0x51cf57&&_0x4e2662>0.01){let _0x3ff113=pow((_0x51cf57-_0x4e2662)/_0x51cf57,1.8),_0x108c4e=_0x55d882>0x0?0x1:-0x1;return _0x108c4e*_0x3ff113*_0x33e355;}return 0x0;}function updatePuck(){if(!puck)return;puck['x']+=puck['vx'],puck['y']+=puck['vy'],puck['vx']*=friction,puck['vy']*=friction;let _0x45d78a=sqrt(puck['vx']*puck['vx']+puck['vy']*puck['vy']);_0x45d78a>currentMaxPuckSpeed&&(puck['vx']=puck['vx']/_0x45d78a*currentMaxPuckSpeed,puck['vy']=puck['vy']/_0x45d78a*currentMaxPuckSpeed);_0x45d78a<0.1&&!isDragging&&(puck['vx']=0x0,puck['vy']=0x0);let _0x562781,_0x28f9ae,_0x393897=0.95;if(isPortrait){_0x562781=width/0x2,_0x28f9ae=goalWidth;let _0x2293ba=_0x562781-_0x28f9ae/0x2,_0x39147a=_0x562781+_0x28f9ae/0x2;(puck['y']-puck['r']<0x0&&!(puck['x']>_0x2293ba&&puck['x']<_0x39147a)||puck['y']+puck['r']>height&&!(puck['x']>_0x2293ba&&puck['x']<_0x39147a))&&(puck['vy']*=wallRestitution,puck['y']=constrain(puck['y'],puck['r'],height-puck['r']),puck['vx']*=_0x393897),(puck['x']-puck['r']<0x0||puck['x']+puck['r']>width)&&(puck['vx']*=wallRestitution,puck['x']=constrain(puck['x'],puck['r'],width-puck['r']),puck['vy']*=_0x393897);}else{_0x562781=height/0x2,_0x28f9ae=goalWidth;let _0x1c9f64=_0x562781-_0x28f9ae/0x2,_0x2d7184=_0x562781+_0x28f9ae/0x2;(puck['x']-puck['r']<0x0&&!(puck['y']>_0x1c9f64&&puck['y']<_0x2d7184)||puck['x']+puck['r']>width&&!(puck['y']>_0x1c9f64&&puck['y']<_0x2d7184))&&(puck['vx']*=wallRestitution,puck['x']=constrain(puck['x'],puck['r'],width-puck['r']),puck['vy']*=_0x393897),(puck['y']-puck['r']<0x0||puck['y']+puck['r']>height)&&(puck['vy']*=wallRestitution,puck['y']=constrain(puck['y'],puck['r'],height-puck['r']),puck['vx']*=_0x393897);}puck['x']=constrain(puck['x'],-puck['r']*0x5,width+puck['r']*0x5),puck['y']=constrain(puck['y'],-puck['r']*0x5,height+puck['r']*0x5);}function checkCollisions(){if(!player||!ai||!puck)return;handlePaddleCollision(player),handlePaddleCollision(ai);}function handlePaddleCollision(_0xa872c9){const _0x52dd31=_0x33fd2;if(!_0xa872c9||!puck)return;let _0x7021b1=puck['x']-_0xa872c9['x'],_0x21c5bf=puck['y']-_0xa872c9['y'],_0x2b7d32=sqrt(_0x7021b1*_0x7021b1+_0x21c5bf*_0x21c5bf),_0xae567d=puck['r']+_0xa872c9['r'];if(_0x2b7d32<_0xae567d&&_0x2b7d32>0.1){let _0xb25d9f=_0x7021b1/_0x2b7d32,_0x426318=_0x21c5bf/_0x2b7d32,_0x5cf01b=puck['vx']-_0xa872c9[_0x52dd31(0xe6)],_0x346601=puck['vy']-_0xa872c9[_0x52dd31(0xe9)],_0x15b171=_0x5cf01b*_0xb25d9f+_0x346601*_0x426318;if(_0x15b171>0x0){let _0x4175d5=_0xae567d-_0x2b7d32;_0x4175d5>0.1&&(puck['x']+=_0xb25d9f*(_0x4175d5+0.1),puck['y']+=_0x426318*(_0x4175d5+0.1));return;}let _0x2d19b7=0.8,_0x41cc60=-(0x1+_0x2d19b7)*_0x15b171;const _0x349350=2.5;_0x41cc60=max(_0x41cc60,_0x349350);let _0x363e94=sqrt(_0xa872c9[_0x52dd31(0xe6)]*_0xa872c9[_0x52dd31(0xe6)]+_0xa872c9['velY']*_0xa872c9['velY']),_0x3c33b2=constrain(_0x363e94*0.15,0x0,0x6);_0x41cc60+=_0x3c33b2;let _0x20976b=_0xb25d9f,_0xb5361f=_0x426318;const _0x1be952=_0xa872c9['r']*0.7;if(_0x2b7d32>_0x1be952&&currentEdgeBlendFactor>0.01){_0x2d19b7=0.6,_0x41cc60=-(0x1+_0x2d19b7)*_0x15b171,_0x41cc60=max(_0x41cc60,_0x349350*0.8),_0x41cc60+=_0x3c33b2;let _0x159484=-_0x426318,_0x4b3642=_0xb25d9f;_0x20976b=lerp(_0xb25d9f,_0x159484,currentEdgeBlendFactor),_0xb5361f=lerp(_0x426318,_0x4b3642,currentEdgeBlendFactor);let _0x55c304=sqrt(_0x20976b*_0x20976b+_0xb5361f*_0xb5361f);_0x55c304>0.01&&(_0x20976b/=_0x55c304,_0xb5361f/=_0x55c304);}puck['vx']+=_0x41cc60*_0x20976b,puck['vy']+=_0x41cc60*_0xb5361f;let _0x1dc267=sqrt(puck['vx']*puck['vx']+puck['vy']*puck['vy']);_0x1dc267>currentMaxPuckSpeed&&(puck['vx']=puck['vx']/_0x1dc267*currentMaxPuckSpeed,puck['vy']=puck['vy']/_0x1dc267*currentMaxPuckSpeed);let _0x3e01ee=_0xae567d-_0x2b7d32,_0x1d8904=1.05;if(_0x3e01ee>0x0){puck['x']+=_0xb25d9f*(_0x3e01ee*_0x1d8904+0.1),puck['y']+=_0x426318*(_0x3e01ee*_0x1d8904+0.1);let _0x308fdd=puck['x']-_0xa872c9['x'],_0x1d3618=puck['y']-_0xa872c9['y'],_0x15c1fc=sqrt(_0x308fdd*_0x308fdd+_0x1d3618*_0x1d3618);_0x15c1fc<_0xae567d&&(puck['x']=_0xa872c9['x']+_0xb25d9f*(_0xae567d+0.05),puck['y']=_0xa872c9['y']+_0x426318*(_0xae567d+0.05));}let _0x26557e=atan2(_0xb5361f,_0x20976b);createSparks(puck['x']-_0xb25d9f*puck['r'],puck['y']-_0x426318*puck['r'],_0x26557e+PI);}}function checkGoal(){const _0x7c2298=_0x33fd2;if(!puck||goalFlash[_0x7c2298(0xce)])return;let _0x248adc=![],_0x875783=![],_0xc493fd,_0x147215;if(isPortrait){_0xc493fd=width/0x2,_0x147215=goalWidth;let _0x1f21c8=_0xc493fd-_0x147215/0x2,_0x4dd4e6=_0xc493fd+_0x147215/0x2;puck['y']-puck['r']<-puck['r']*0.5&&puck['x']>_0x1f21c8&&puck['x']<_0x4dd4e6&&(playerScore++,_0x248adc=!![],_0x875783=![],startGoalAnimation('player')),puck['y']+puck['r']>height+puck['r']*0.5&&puck['x']>_0x1f21c8&&puck['x']<_0x4dd4e6&&(aiScore++,_0x248adc=!![],_0x875783=!![],startGoalAnimation('ai'));}else{_0xc493fd=height/0x2,_0x147215=goalWidth;let _0xd3de39=_0xc493fd-_0x147215/0x2,_0x4c0ec1=_0xc493fd+_0x147215/0x2;puck['x']-puck['r']<-puck['r']*0.5&&puck['y']>_0xd3de39&&puck['y']<_0x4c0ec1&&(aiScore++,_0x248adc=!![],_0x875783=!![],startGoalAnimation('ai')),puck['x']+puck['r']>width+puck['r']*0.5&&puck['y']>_0xd3de39&&puck['y']<_0x4c0ec1&&(playerScore++,_0x248adc=!![],_0x875783=![],startGoalAnimation('player'));}}function startGoalAnimation(_0xcd7ed){const _0x30e913=_0x33fd2;goalFlash[_0x30e913(0x9f)]=_0xcd7ed===_0x30e913(0xd2)?'ai':_0x30e913(0xd2),goalFlash[_0x30e913(0xce)]=!![],goalFlash[_0x30e913(0xc8)]=0x0,puck&&(puck['vx']=0x0,puck['vy']=0x0);}function drawFieldTexture(){push(),strokeWeight(0.4);for(let _0x18cd0d=0x0;_0x18cd0d<0x96;_0x18cd0d++){let _0x3d401a=random(width),_0x1a071d=random(height),_0x2004c6=noise(_0x3d401a*0.01,_0x1a071d*0.01),_0x57b9b5=_0x2004c6*TWO_PI*0x2,_0x374601=_0x2004c6*0xf+0x5,_0x4c11ca=_0x3d401a+cos(_0x57b9b5)*_0x374601,_0x3ba05a=_0x1a071d+sin(_0x57b9b5)*_0x374601,_0x201369=map(_0x2004c6,0x0,0x1,0x5,0x14);stroke(0xc8,0xc8,0xdc,_0x201369),line(_0x3d401a,_0x1a071d,_0x4c11ca,_0x3ba05a);}pop();}function drawField(){const _0x450a1e=_0x33fd2;stroke(0xc8,0xc8,0xc8,0x64),strokeWeight(max(1.5,min(width,height)*0.005));isPortrait?line(0x0,height/0x2,width,height/0x2):line(width/0x2,0x0,width/0x2,height);noFill(),ellipse(width/0x2,height/0x2,min(width,height)*0.18,min(width,height)*0.18);let _0x567401,_0x58f20a,_0x2889ac,_0x1bb4b8,_0x12a5b9,_0x4941db,_0x5c3b5f=max(0x3,min(width,height)*0.01),_0xc21856=max(0x5,min(width,height)*0.015);isPortrait?(_0x567401=width/0x2,_0x58f20a=goalWidth,_0x12a5b9=_0x567401-_0x58f20a/0x2,_0x4941db=_0x567401+_0x58f20a/0x2,strokeWeight(goalFlash['active']&&goalFlash['side']===_0x450a1e(0xd2)?_0xc21856:_0x5c3b5f),stroke(playerColor[0x0],playerColor[0x1],playerColor[0x2],goalFlash[_0x450a1e(0xce)]&&goalFlash['side']===_0x450a1e(0xd2)?0xff:0xc8),line(_0x12a5b9,height,_0x4941db,height),strokeWeight(goalFlash[_0x450a1e(0xce)]&&goalFlash[_0x450a1e(0x9f)]==='ai'?_0xc21856:_0x5c3b5f),stroke(aiColor[0x0],aiColor[0x1],aiColor[0x2],goalFlash[_0x450a1e(0xce)]&&goalFlash[_0x450a1e(0x9f)]==='ai'?0xff:0xc8),line(_0x12a5b9,0x0,_0x4941db,0x0)):(_0x567401=height/0x2,_0x58f20a=goalWidth,_0x2889ac=_0x567401-_0x58f20a/0x2,_0x1bb4b8=_0x567401+_0x58f20a/0x2,strokeWeight(goalFlash[_0x450a1e(0xce)]&&goalFlash[_0x450a1e(0x9f)]===_0x450a1e(0xd2)?_0xc21856:_0x5c3b5f),stroke(playerColor[0x0],playerColor[0x1],playerColor[0x2],goalFlash[_0x450a1e(0xce)]&&goalFlash[_0x450a1e(0x9f)]===_0x450a1e(0xd2)?0xff:0xc8),line(0x0,_0x2889ac,0x0,_0x1bb4b8),strokeWeight(goalFlash[_0x450a1e(0xce)]&&goalFlash[_0x450a1e(0x9f)]==='ai'?_0xc21856:_0x5c3b5f),stroke(aiColor[0x0],aiColor[0x1],aiColor[0x2],goalFlash[_0x450a1e(0xce)]&&goalFlash[_0x450a1e(0x9f)]==='ai'?0xff:0xc8),line(width,_0x2889ac,width,_0x1bb4b8)),noStroke(),fill(0xff);}function drawBackgroundScore(){const _0x480796=_0x33fd2;fill(scoreColor[0x0],scoreColor[0x1],scoreColor[0x2],scoreColor[0x3]);let _0x2f5413;isPortrait?_0x2f5413=width*0.35:_0x2f5413=min(width,height)*0.22,textSize(_0x2f5413),strokeWeight(max(0x1,_0x2f5413*0.04)),stroke(fieldColor[0x0]*0.3,fieldColor[0x1]*0.3,fieldColor[0x2]*0.4,0x96),text(playerScore+_0x480796(0xa5)+aiScore,width/0x2,height/0x2),noStroke();}function drawPaddles(){const _0x27bd9d=_0x33fd2;if(!player||!ai)return;drawingContext['shadowBlur']=0xf,drawingContext[_0x27bd9d(0xc4)]=_0x27bd9d(0xa0),drawingContext[_0x27bd9d(0xc1)]=0x3,drawingContext[_0x27bd9d(0x9e)]=0x5,fill(player[_0x27bd9d(0xea)][0x0],player['color'][0x1],player[_0x27bd9d(0xea)][0x2]),ellipse(player['x'],player['y'],player['r']*0x2),fill(ai[_0x27bd9d(0xea)][0x0],ai[_0x27bd9d(0xea)][0x1],ai[_0x27bd9d(0xea)][0x2]),ellipse(ai['x'],ai['y'],ai['r']*0x2),drawingContext['shadowBlur']=0x0,drawingContext['shadowOffsetX']=0x0,drawingContext[_0x27bd9d(0x9e)]=0x0,noStroke(),fill(player[_0x27bd9d(0xea)][0x0]*0.7,player['color'][0x1]*0.7,player[_0x27bd9d(0xea)][0x2]*0.8),ellipse(player['x'],player['y'],player['r']*1.4),fill(ai['color'][0x0]*0.8,ai[_0x27bd9d(0xea)][0x1]*0.7,ai[_0x27bd9d(0xea)][0x2]*0.7),ellipse(ai['x'],ai['y'],ai['r']*1.4);}function drawPuck(){const _0x4794b7=_0x33fd2;if(!puck)return;drawingContext[_0x4794b7(0xca)]=0x8,drawingContext[_0x4794b7(0xc4)]='rgba(0,\x200,\x200,\x200.35)',drawingContext[_0x4794b7(0xc1)]=0x2,drawingContext[_0x4794b7(0x9e)]=0x3,fill(puck[_0x4794b7(0xea)][0x0],puck[_0x4794b7(0xea)][0x1],puck[_0x4794b7(0xea)][0x2]),ellipse(puck['x'],puck['y'],puck['r']*0x2),drawingContext[_0x4794b7(0xca)]=0x0,drawingContext[_0x4794b7(0xc1)]=0x0,drawingContext['shadowOffsetY']=0x0;let _0xe45379=puck['r']*0.6,_0x232956=puck['x']-puck['r']*0.2,_0x28b8d8=puck['y']-puck['r']*0.2;fill(0xff,0xff,0xff,0x64),ellipse(_0x232956,_0x28b8d8,_0xe45379*1.5,_0xe45379*1.2),stroke(0x0,0x0,0x0,0x64),strokeWeight(0.5),noFill(),ellipse(puck['x'],puck['y'],puck['r']*0x2),noStroke(),fill(0xff);}function drawTrail(){const _0x270ebe=_0x33fd2;if(!puck||puckTrail[_0x270ebe(0xdf)]<0x2)return;noStroke();for(let _0x3ea488=0x0;_0x3ea488<puckTrail['length'];_0x3ea488++){let _0x5fb4e9=puckTrail[_0x3ea488],_0x180b8c=map(_0x3ea488,0x0,puckTrail[_0x270ebe(0xdf)]-0x1,0x0,0x3c),_0x471f2b=map(_0x3ea488,0x0,puckTrail[_0x270ebe(0xdf)]-0x1,puck['r']*0.2,puck['r']*1.8);fill(puck['color'][0x0],puck[_0x270ebe(0xea)][0x1],puck[_0x270ebe(0xea)][0x2],_0x180b8c),ellipse(_0x5fb4e9['x'],_0x5fb4e9['y'],_0x471f2b);}}function drawSparks(){if(hitSparks['length']===0x0)return;push(),noStroke();for(let _0x377ef7 of hitSparks){let _0x365fc6=map(_0x377ef7['life'],0x0,SPARK_LIFETIME,0x0,0xff);fill(0xff,0xff,0xc8+random(-0x32,0x37),_0x365fc6),ellipse(_0x377ef7['x'],_0x377ef7['y'],_0x377ef7['size']);}pop();}function resetRound(_0x2401f8){const _0x14809d=_0x33fd2;initializeObjects(_0x2401f8);if(player){isDragging=![];if(canvasElement)canvasElement[_0x14809d(0xdd)](_0x14809d(0xcf));}ai&&(ai[_0x14809d(0xb8)]=0x0,ai[_0x14809d(0xed)]=0x0,ai[_0x14809d(0xee)]={'x':-0x1,'y':-0x1},ai['isStuckEscaping']=![]),puckTrail=[],hitSparks=[],goalFlash['active']=![];}

    </script>

</body>
</html>