<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2D Аерохокей v11 - Покращений ШІ (Передбачення та Прицілювання)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        /* Стилі залишаються ті ж самі */
        body { display: flex; justify-content: center; align-items: center; height: 100vh; width: 100vw; margin: 0; background-color: #333; flex-direction: column; font-family: sans-serif; -webkit-user-select: none; -ms-user-select: none; user-select: none; overflow: hidden; color: white; }
        canvas { border: 2px solid #aaa; display: block; cursor: grab; touch-action: none; max-width: 100%; max-height: 100%; box-sizing: border-box; }
        canvas.grabbing { cursor: grabbing; }
        .controls { position: absolute; top: 10px; left: 10px; z-index: 10; background: rgba(0, 0, 0, 0.6); padding: 8px; border-radius: 5px; font-size: 0.9em; display: flex; gap: 15px; align-items: center; }
        .control-group label { margin-right: 5px; }
        #speedValue { font-weight: bold; }
    </style>
</head>
<body>
    <div class="controls">
        <div class="control-group">
            <label for="difficulty">Складність:</label>
            <select id="difficulty"> <option value="easy">Легка</option> <option value="medium" selected>Середня</option> <option value="hard">Важка</option> </select>
        </div>
        <div class="control-group">
             <label for="aiSpeed">Шв. ШІ: <span id="speedValue">1.0</span>x</label>
             <input type="range" id="aiSpeed" min="0.2" max="2.5" value="1.0" step="0.1" style="width: 80px;">
        </div>
    </div>

    <script>
const _0x357bf8=_0x3ad6;(function(_0x3bc982,_0x5c0217){const _0x1a20cc=_0x3ad6,_0x5c538f=_0x3bc982();while(!![]){try{const _0x54ed8b=-parseInt(_0x1a20cc(0x12c))/0x1+parseInt(_0x1a20cc(0x139))/0x2+parseInt(_0x1a20cc(0x15a))/0x3+parseInt(_0x1a20cc(0x155))/0x4+-parseInt(_0x1a20cc(0x13a))/0x5*(-parseInt(_0x1a20cc(0x12a))/0x6)+-parseInt(_0x1a20cc(0x152))/0x7+parseInt(_0x1a20cc(0x158))/0x8*(parseInt(_0x1a20cc(0x157))/0x9);if(_0x54ed8b===_0x5c0217)break;else _0x5c538f['push'](_0x5c538f['shift']());}catch(_0x2ccde7){_0x5c538f['push'](_0x5c538f['shift']());}}}(_0x10d8,0x66b4f));let canvasElement,isPortrait=![];function _0x3ad6(_0x5f401f,_0x3a397d){const _0x10d8c0=_0x10d8();return _0x3ad6=function(_0x3ad6e3,_0x400b2c){_0x3ad6e3=_0x3ad6e3-0x127;let _0x215637=_0x10d8c0[_0x3ad6e3];return _0x215637;},_0x3ad6(_0x5f401f,_0x3a397d);}const padding=0xa,playerColor=[0x0,0x0,0xff],aiColor=[0xff,0x0,0x0],puckColor=[0xff,0xff,0xff],fieldColor=[0x32,0x32,0x32],scoreColor=[0xc8,0xc8,0xc8,0x64];let paddleRadius,puckRadius,goalWidth;const friction=0.995,maxPuckSpeed=0x19,hitForceMultiplier=0.25,wallRestitution=-0.95;let player,ai,puck,playerScore=0x0,aiScore=0x0,difficulty=_0x357bf8(0x156),isDragging=![],aiGlobalSpeedMultiplier=0x1,aiBasePos,aiDefensiveLine,aiCriticalDefenseLine,aiOffensivePush;const aiAimAssist=0.1;let cornerCheckRadius;const wallAvoidanceDistance=0x32,wallAvoidanceForce=0.2;let scaledWallAvoidDistance;const STUCK_THRESHOLD_FRAMES=0x2d,STUCK_ESCAPE_FORCE=0x6,AI_PREDICTION_FRAMES_MIN=0x8,AI_PREDICTION_FRAMES_MAX=0x19,AI_DEFENSE_CLEAR_BIAS=0.25,AI_OFFENSIVE_AIM_THRESH=1.5,AI_CRITICAL_CLEAR_STRENGTH=0x1;function setup(){const _0x2f4e31=_0x357bf8;let _0x45ab0f=calculateCanvasSize();canvasElement=createCanvas(_0x45ab0f['w'],_0x45ab0f['h']),canvasElement[_0x2f4e31(0x148)](document['body']),isPortrait=_0x45ab0f[_0x2f4e31(0x161)],resetLayout(),textAlign(CENTER,CENTER),noStroke(),setupEventListeners();}function calculateCanvasSize(){let _0x5405a0=windowWidth-padding*0x2,_0x6678ad=windowHeight-padding*0x2-0x32;_0x6678ad=max(_0x6678ad,0xc8);let _0xc8152c=_0x6678ad>_0x5405a0;return{'w':floor(_0x5405a0),'h':floor(_0x6678ad),'portrait':_0xc8152c};}function resetLayout(){const _0x10827b=_0x357bf8;console[_0x10827b(0x12d)](_0x10827b(0x167)+width+_0x10827b(0x164)+height+',\x20Portrait:\x20'+isPortrait);let _0x188e3c=min(width,height);paddleRadius=max(0x19,_0x188e3c*0.05),puckRadius=max(0x8,_0x188e3c*0.03),goalWidth=_0x188e3c*0.3,aiOffensivePush=paddleRadius*0.7,cornerCheckRadius=paddleRadius*1.8,scaledWallAvoidDistance=_0x188e3c*0.13,isPortrait?(aiBasePos={'x':width/0x2,'y':height*0.25},aiDefensiveLine=height*0.4,aiCriticalDefenseLine=height*0.18,player={'x':width/0x2,'y':height*0.75,'r':paddleRadius,'color':playerColor,'prevX':width/0x2,'prevY':height*0.75,'velX':0x0,'velY':0x0},ai={'x':aiBasePos['x'],'y':aiBasePos['y'],'r':paddleRadius,'color':aiColor,'prevX':aiBasePos['x'],'prevY':aiBasePos['y'],'velX':0x0,'velY':0x0,'stuckInCornerTimer':0x0,'lastPuckPosInCorner':{'x':-0x1,'y':-0x1},'isStuckEscaping':![]},puck={'x':width/0x2,'y':height/0x2,'r':puckRadius,'vx':0x0,'vy':random(-0x2,0x2),'color':puckColor}):(aiBasePos={'x':width*0.75,'y':height/0x2},aiDefensiveLine=width*0.6,aiCriticalDefenseLine=width*0.82,player={'x':width*0.25,'y':height/0x2,'r':paddleRadius,'color':playerColor,'prevX':width*0.25,'prevY':height/0x2,'velX':0x0,'velY':0x0},ai={'x':aiBasePos['x'],'y':aiBasePos['y'],'r':paddleRadius,'color':aiColor,'prevX':aiBasePos['x'],'prevY':aiBasePos['y'],'velX':0x0,'velY':0x0,'stuckInCornerTimer':0x0,'lastPuckPosInCorner':{'x':-0x1,'y':-0x1},'isStuckEscaping':![]},puck={'x':width/0x2,'y':height/0x2,'r':puckRadius,'vx':random(-0x2,0x2),'vy':0x0,'color':puckColor}),isDragging=![],canvasElement&&canvasElement[_0x10827b(0x133)]('grabbing');}function windowResized(){const _0x419d6e=_0x357bf8;let _0x1e8aa2=calculateCanvasSize();resizeCanvas(_0x1e8aa2['w'],_0x1e8aa2['h']),_0x1e8aa2[_0x419d6e(0x161)]!==isPortrait?(isPortrait=_0x1e8aa2[_0x419d6e(0x161)],resetLayout()):resetLayout();}function setupEventListeners(){const _0x531da2=_0x357bf8,_0x269917=document['getElementById']('difficulty');_0x269917[_0x531da2(0x160)](_0x531da2(0x13e),_0x3f6a02=>{const _0x1f78c4=_0x531da2;difficulty=_0x3f6a02['target'][_0x1f78c4(0x12b)],console[_0x1f78c4(0x12d)](_0x1f78c4(0x14d),difficulty);}),difficulty=_0x269917[_0x531da2(0x12b)];const _0x3ba205=document[_0x531da2(0x153)](_0x531da2(0x135)),_0x415f23=document[_0x531da2(0x153)](_0x531da2(0x138));_0x3ba205[_0x531da2(0x160)]('input',_0x1a1612=>{const _0x1950f6=_0x531da2;aiGlobalSpeedMultiplier=parseFloat(_0x1a1612[_0x1950f6(0x14e)][_0x1950f6(0x12b)]),_0x415f23[_0x1950f6(0x140)]=aiGlobalSpeedMultiplier['toFixed'](0x1);}),aiGlobalSpeedMultiplier=parseFloat(_0x3ba205[_0x531da2(0x12b)]),_0x415f23[_0x531da2(0x140)]=aiGlobalSpeedMultiplier[_0x531da2(0x14c)](0x1),canvasElement[_0x531da2(0x134)]['addEventListener'](_0x531da2(0x150),handleTouchStart,{'passive':![]}),canvasElement[_0x531da2(0x134)][_0x531da2(0x160)](_0x531da2(0x128),handleTouchMove,{'passive':![]}),canvasElement[_0x531da2(0x134)][_0x531da2(0x160)](_0x531da2(0x166),handleTouchEnd),canvasElement[_0x531da2(0x134)][_0x531da2(0x160)]('touchcancel',handleTouchEnd),canvasElement[_0x531da2(0x130)](handleMousePressed),canvasElement[_0x531da2(0x12f)](handleMouseDragged),canvasElement[_0x531da2(0x151)](handleMouseReleased);}function handleTouchStart(_0x600127){const _0x5eb049=_0x357bf8;if(_0x600127[_0x5eb049(0x143)]['length']>0x0){let _0x6b36ce=_0x600127[_0x5eb049(0x143)][0x0],_0x5295da=canvasElement['elt'][_0x5eb049(0x154)](),_0x402491=_0x6b36ce[_0x5eb049(0x127)]-_0x5295da[_0x5eb049(0x145)],_0x2ddd25=_0x6b36ce[_0x5eb049(0x162)]-_0x5295da['top'];checkPaddleGrab(_0x402491,_0x2ddd25);}}function handleTouchMove(_0x17d9d4){const _0x3af060=_0x357bf8;if(isDragging&&_0x17d9d4[_0x3af060(0x143)][_0x3af060(0x13f)]>0x0){_0x17d9d4[_0x3af060(0x146)]();let _0x2b623c=_0x17d9d4[_0x3af060(0x143)][0x0],_0x20fe50=canvasElement['elt']['getBoundingClientRect'](),_0x4c239b=_0x2b623c[_0x3af060(0x127)]-_0x20fe50[_0x3af060(0x145)],_0x1d339f=_0x2b623c[_0x3af060(0x162)]-_0x20fe50['top'];updatePlayerPosition(_0x4c239b,_0x1d339f);}}function handleTouchEnd(_0x93b4dc){isDragging&&releasePaddleGrab();}function handleMousePressed(){checkPaddleGrab(mouseX,mouseY);}function _0x10d8(){const _0x2c3abf=['AI\x20State:\x20!!!\x20CRITICAL\x20DEFENSE\x20!!!','Player\x20scores!','touches','isStuckEscaping','left','preventDefault','velY','parent','color','hard','\x20-\x20','toFixed','Difficulty\x20changed\x20to:','target','AI\x20State:\x20STUCK\x20ESCAPE\x20MOVE!','touchstart','mouseReleased','4484536pCgSAx','getElementById','getBoundingClientRect','732828QQEeLM','medium','202932ZdfQMI','248LSwkxm','AI\x20State:\x20!!!\x20DESPERATION\x20SAVE\x20!!!\x20(Puck\x20Behind)','201237UUEArW','lastPuckPosInCorner','AI\x20State:\x20DEFENSE\x20(Intercept\x20&\x20Clear)','Edge\x20Hit\x20Detected!','Раунд\x20скинуто.\x20Рахунок:','prevY','addEventListener','portrait','clientY','Corner\x20Timer:\x20',',\x20Height:\x20','stuckInCornerTimer','touchend','Resetting\x20layout.\x20Width:\x20','clientX','touchmove','addClass','761628qzTnfs','value','443969tQIBVJ','log','AI\x20State:\x20NUDGING\x20SLOW\x20PUCK\x20(Near\x20Edge)','mouseMoved','mousePressed','AI\x20scores!','velX','removeClass','elt','aiSpeed','prevX','AI\x20finished\x20escape\x20attempt.','speedValue','96556GnWCFl','20CzxbLv','AI\x20State:\x20ACTIVE\x20PLAY\x20(Intercept\x20&\x20Aim)','grabbing','!!!\x20TRIGGERING\x20ESCAPE\x20!!!','change','length','textContent'];_0x10d8=function(){return _0x2c3abf;};return _0x10d8();}function handleMouseDragged(){isDragging&&updatePlayerPosition(mouseX,mouseY);}function handleMouseReleased(){isDragging&&releasePaddleGrab();}function checkPaddleGrab(_0xdba865,_0x1a37fa){const _0xbc8ae5=_0x357bf8;let _0x17c472=dist(_0xdba865,_0x1a37fa,player['x'],player['y']);_0x17c472<player['r']*1.8&&(isDragging=!![],canvasElement[_0xbc8ae5(0x129)]('grabbing'));}function releasePaddleGrab(){const _0x1d6173=_0x357bf8;isDragging=![],canvasElement[_0x1d6173(0x133)]('grabbing');}function updatePlayerPosition(_0x2f8720,_0x36450e){player['prevX']=player['x'],player['prevY']=player['y'];let _0x584738,_0x45359d,_0x204120,_0x56a90e;isPortrait?(_0x204120=player['r'],_0x56a90e=width-player['r'],_0x584738=height/0x2+player['r'],_0x45359d=height-player['r']):(_0x204120=player['r'],_0x56a90e=width/0x2-player['r'],_0x584738=player['r'],_0x45359d=height-player['r']),player['x']=constrain(_0x2f8720,_0x204120,_0x56a90e),player['y']=constrain(_0x36450e,_0x584738,_0x45359d);}function draw(){background(fieldColor[0x0],fieldColor[0x1],fieldColor[0x2]),updatePlayerVelocity(),updateAI(),updatePuck(),checkCollisions(),checkGoal(),drawField(),drawBackgroundScore(),drawPaddles(),drawPuck();}function updatePlayerVelocity(){const _0x519ac0=_0x357bf8;if(!isDragging){player[_0x519ac0(0x132)]*=0.8,player[_0x519ac0(0x147)]*=0.8;if(abs(player[_0x519ac0(0x132)])<0.1)player[_0x519ac0(0x132)]=0x0;if(abs(player[_0x519ac0(0x147)])<0.1)player[_0x519ac0(0x147)]=0x0;}else player[_0x519ac0(0x132)]=player['x']-player[_0x519ac0(0x136)],player[_0x519ac0(0x147)]=player['y']-player[_0x519ac0(0x15f)];}function updateAI(){const _0x2480d2=_0x357bf8;ai[_0x2480d2(0x136)]=ai['x'],ai['prevY']=ai['y'];let _0x56b19d;switch(difficulty){case'easy':_0x56b19d=0.07;break;case _0x2480d2(0x14a):_0x56b19d=0.25;break;case'medium':default:_0x56b19d=0.15;break;}_0x56b19d*=aiGlobalSpeedMultiplier*0.7;let _0x10cf00=aiBasePos['x'],_0x31a107=aiBasePos['y'],_0x151c5d=_0x56b19d,_0x45bbf0={'x':0x0,'y':0x0};const _0x3e6925=isPortrait?width/0x2:width,_0x4526de=isPortrait?0x0:height/0x2,_0x39409b=isPortrait?width/0x2:0x0,_0x12be76=isPortrait?height:height/0x2,_0x5e4f0f=dist(ai['x'],ai['y'],puck['x'],puck['y']),_0x480575=sqrt(puck['vx']*puck['vx']+puck['vy']*puck['vy']);let _0x302f9d=map(_0x5e4f0f,0x0,max(width,height)/0x2,AI_PREDICTION_FRAMES_MIN,AI_PREDICTION_FRAMES_MAX);_0x302f9d/=map(_0x480575,0x0,maxPuckSpeed*0.8,0x1,0x3),_0x302f9d=constrain(_0x302f9d,0x2,AI_PREDICTION_FRAMES_MAX);let _0x3e9c85=puck['x']+puck['vx']*_0x302f9d,_0x3526b7=puck['y']+puck['vy']*_0x302f9d;_0x3e9c85=constrain(_0x3e9c85,puckRadius,width-puckRadius),_0x3526b7=constrain(_0x3526b7,puckRadius,height-puckRadius);let _0x7dd2ec=![];isPortrait?_0x7dd2ec=puck['vy']<-0.2:_0x7dd2ec=puck['vx']>0.2;let _0x5bf75b=![],_0x2b3857=![],_0x4ad6d5=![];const _0x4821ef=paddleRadius*2.5;isPortrait?(_0x2b3857=puck['y']<_0x4821ef,_0x4ad6d5=puck['y']<ai['y']):(_0x2b3857=puck['x']>width-_0x4821ef,_0x4ad6d5=puck['x']>ai['x']);if(_0x2b3857&&_0x4ad6d5&&_0x7dd2ec){console['log'](_0x2480d2(0x159)),_0x10cf00=isPortrait?puck['x']:width-ai['r'],_0x31a107=isPortrait?ai['r']:puck['y'];let _0x10ff8e=isPortrait?width/0x2-goalWidth/0x2:height/0x2-goalWidth/0x2,_0x49bee9=isPortrait?width/0x2+goalWidth/0x2:height/0x2+goalWidth/0x2;if(isPortrait)_0x10cf00=constrain(_0x10cf00,_0x10ff8e,_0x49bee9);else _0x31a107=constrain(_0x31a107,_0x10ff8e,_0x49bee9);_0x10cf00=constrain(_0x10cf00,ai['r'],width-ai['r']),_0x31a107=constrain(_0x31a107,ai['r'],height-ai['r']),_0x151c5d*=0x5*aiGlobalSpeedMultiplier*0.7,_0x5bf75b=!![],ai[_0x2480d2(0x165)]=0x0;}else{if(ai[_0x2480d2(0x144)]&&!_0x5bf75b){console[_0x2480d2(0x12d)](_0x2480d2(0x14f));let _0x1d2153=width/0x2-ai['x'],_0x5c77b4=height/0x2-ai['y'],_0x25b1df=sqrt(_0x1d2153*_0x1d2153+_0x5c77b4*_0x5c77b4);_0x25b1df>0x1&&(_0x1d2153/=_0x25b1df,_0x5c77b4/=_0x25b1df),_0x10cf00=ai['x']+_0x1d2153*STUCK_ESCAPE_FORCE*0x5,_0x31a107=ai['y']+_0x5c77b4*STUCK_ESCAPE_FORCE*0x5,_0x151c5d*=4.5,ai[_0x2480d2(0x144)]=![],ai['stuckInCornerTimer']=0x0,_0x5bf75b=!![],console[_0x2480d2(0x12d)](_0x2480d2(0x137));}else{if(_0x480575<0.4&&!ai['isStuckEscaping']&&!_0x5bf75b){let _0x3fb2d9=isPortrait?puck['y']<height/0x2+paddleRadius:puck['x']>width/0x2-paddleRadius;if(_0x3fb2d9){let _0x5eb65b=![];const _0x5682a4=paddleRadius*0x3;isPortrait?puck['y']<height/0x2&&(puck['x']<_0x5682a4||puck['x']>width-_0x5682a4)&&(_0x5eb65b=!![]):puck['x']>width/0x2&&(puck['y']<_0x5682a4||puck['y']>height-_0x5682a4)&&(_0x5eb65b=!![]);if(_0x5eb65b){console[_0x2480d2(0x12d)](_0x2480d2(0x12e));let _0x2f74cf=width/0x2,_0x3ce5c4=height/0x2,_0x56e495=_0x2f74cf-puck['x'],_0x265b82=_0x3ce5c4-puck['y'],_0x2ea6a6=sqrt(_0x56e495*_0x56e495+_0x265b82*_0x265b82);_0x2ea6a6>0.1?(_0x56e495/=_0x2ea6a6,_0x265b82/=_0x2ea6a6):(_0x56e495=isPortrait?0x0:-0x1,_0x265b82=isPortrait?0x1:0x0),_0x10cf00=puck['x']-_0x56e495*(ai['r']*0.6),_0x31a107=puck['y']-_0x265b82*(ai['r']*0.6),_0x151c5d*=1.8*aiGlobalSpeedMultiplier*0.7,_0x5bf75b=!![],ai['stuckInCornerTimer']=0x0;}}}}}if(!_0x5bf75b){let _0x233657=isPortrait?_0x3526b7<aiCriticalDefenseLine&&_0x7dd2ec:_0x3e9c85>aiCriticalDefenseLine&&_0x7dd2ec,_0x54ff75=isPortrait?_0x3526b7<aiDefensiveLine&&_0x7dd2ec:_0x3e9c85>aiDefensiveLine&&_0x7dd2ec;if(_0x233657){console[_0x2480d2(0x12d)](_0x2480d2(0x141));let _0x46f527,_0x981b2d;if(isPortrait){}else{}let _0x3819ce=_0x46f527-_0x3e9c85,_0x442c2e=_0x981b2d-_0x3526b7,_0x2a3db2=sqrt();if(_0x2a3db2>0.1){}else{}_0x151c5d*=0x4*aiGlobalSpeedMultiplier*0.7,ai[_0x2480d2(0x165)]=0x0;}else{if(_0x54ff75){console[_0x2480d2(0x12d)](_0x2480d2(0x15c));let _0x413087=_0x3e9c85,_0x495716=_0x3526b7;if(isPortrait){}else{}_0x151c5d*=2.2*aiGlobalSpeedMultiplier*0.7,ai[_0x2480d2(0x165)]=0x0;}else{let _0x443f6d=isPortrait?_0x3526b7<height/0x2+puck['r']*0x3:_0x3e9c85>width/0x2-puck['r']*0x3;if(_0x443f6d){console['log'](_0x2480d2(0x13b));let _0x318851=_0x39409b-_0x3e9c85,_0x56ef63=_0x12be76-_0x3526b7,_0x2ba63a=sqrt(_0x318851*_0x318851+_0x56ef63*_0x56ef63);if(_0x2ba63a>0.1)_0x318851/=_0x2ba63a,_0x56ef63/=_0x2ba63a;else{}_0x10cf00=_0x3e9c85-_0x318851*aiOffensivePush,_0x31a107=_0x3526b7-_0x56ef63*aiOffensivePush;let _0xfb320e=_0x480575>0x1?map(_0x480575,0x1,maxPuckSpeed,1.3,0x2):1.3;_0x151c5d*=_0xfb320e*aiGlobalSpeedMultiplier*0.7,ai[_0x2480d2(0x165)]=0x0;}else console[_0x2480d2(0x12d)]('AI\x20State:\x20WAITING\x20/\x20Returning'),_0x10cf00=aiBasePos['x'],_0x31a107=aiBasePos['y'],_0x151c5d*=0.7*aiGlobalSpeedMultiplier*0.7;if(!_0x443f6d){let _0x171034=![];const _0x2aaa61=cornerCheckRadius*1.1;isPortrait?_0x171034=ai['y']<_0x2aaa61+ai['r']&&(ai['x']<_0x2aaa61+ai['r']||ai['x']>width-_0x2aaa61-ai['r']):_0x171034=ai['x']>width-_0x2aaa61-ai['r']&&(ai['y']<_0x2aaa61+ai['r']||ai['y']>height-_0x2aaa61-ai['r']),_0x171034&&_0x5e4f0f<ai['r']+puck['r']+paddleRadius*0.5?(_0x480575<0.3&&ai[_0x2480d2(0x15b)]['x']>0x0?(ai[_0x2480d2(0x165)]++,console['log'](_0x2480d2(0x163)+ai[_0x2480d2(0x165)]+'/'+STUCK_THRESHOLD_FRAMES)):(ai[_0x2480d2(0x165)]=0x0,ai[_0x2480d2(0x15b)]={'x':puck['x'],'y':puck['y']}),ai[_0x2480d2(0x165)]>STUCK_THRESHOLD_FRAMES&&(ai[_0x2480d2(0x144)]=!![],console['log'](_0x2480d2(0x13d)))):(ai[_0x2480d2(0x165)]=0x0,ai[_0x2480d2(0x15b)]={'x':-0x1,'y':-0x1});}else ai[_0x2480d2(0x165)]=0x0;}}}_0x45bbf0=calculateWallAvoidance(ai,isPortrait,scaledWallAvoidDistance,wallAvoidanceForce,_0x3e6925,_0x4526de);let _0xf9605f=(_0x10cf00-ai['x'])*_0x151c5d,_0x56f227=(_0x31a107-ai['y'])*_0x151c5d;_0xf9605f+=_0x45bbf0['x']*_0x151c5d*0x37,_0x56f227+=_0x45bbf0['y']*_0x151c5d*0x37;let _0x350041=sqrt(_0xf9605f*_0xf9605f+_0x56f227*_0x56f227),_0x3f47d9=_0x56b19d*0xb4;_0x350041>_0x3f47d9&&(_0xf9605f=_0xf9605f/_0x350041*_0x3f47d9,_0x56f227=_0x56f227/_0x350041*_0x3f47d9);if(_0x2b3857&&_0x4ad6d5&&_0x7dd2ec&&!ai[_0x2480d2(0x144)]){const _0xc36231=maxPuckSpeed*0.8;_0x350041>_0xc36231&&(_0xf9605f=_0xf9605f/_0x350041*_0xc36231,_0x56f227=_0x56f227/_0x350041*_0xc36231);}ai['x']+=_0xf9605f,ai['y']+=_0x56f227;const _0x398598=0.5;let _0x556662=ai['x'],_0x48da34=ai['y'];isPortrait?(_0x556662=constrain(ai['x'],ai['r']+_0x398598,width-ai['r']-_0x398598),_0x48da34=constrain(ai['y'],ai['r']+_0x398598,height/0x2-ai['r']-_0x398598)):(_0x556662=constrain(ai['x'],width/0x2+ai['r']+_0x398598,width-ai['r']-_0x398598),_0x48da34=constrain(ai['y'],ai['r']+_0x398598,height-ai['r']-_0x398598)),ai['x']=_0x556662,ai['y']=_0x48da34,ai['velX']=ai['x']-ai[_0x2480d2(0x136)],ai['velY']=ai['y']-ai[_0x2480d2(0x15f)];}function calculateWallAvoidance(_0x2993de,_0x44d2f3,_0x5b65c8,_0x282de8,_0x104fb4,_0x5d2bf6){let _0x4cfe6f={'x':0x0,'y':0x0},_0x1b4165;const _0x405151=1.6;if(_0x44d2f3){let _0x2f68ae=_0x2993de['y'],_0x2678ce=_0x2f68ae<_0x5b65c8*1.5?_0x405151:0x1;_0x1b4165=calculateSingleWallAvoidance(_0x2993de['y'],0x0,_0x5b65c8*_0x2678ce,_0x282de8*_0x2678ce);if(_0x1b4165!==0x0)_0x4cfe6f['y']+=_0x1b4165;_0x1b4165=calculateSingleWallAvoidance(_0x2993de['x'],0x0,_0x5b65c8,_0x282de8);if(_0x1b4165!==0x0)_0x4cfe6f['x']+=_0x1b4165;_0x1b4165=calculateSingleWallAvoidance(_0x2993de['x'],width,_0x5b65c8,_0x282de8);if(_0x1b4165!==0x0)_0x4cfe6f['x']+=_0x1b4165;_0x1b4165=calculateSingleWallAvoidance(_0x2993de['y'],height/0x2,_0x5b65c8*0.5,_0x282de8*0.4);if(_0x1b4165!==0x0)_0x4cfe6f['y']+=_0x1b4165;}else{let _0x48b4e3=width-_0x2993de['x'],_0x3e4294=_0x48b4e3<_0x5b65c8*1.5?_0x405151:0x1;_0x1b4165=calculateSingleWallAvoidance(_0x2993de['x'],width,_0x5b65c8*_0x3e4294,_0x282de8*_0x3e4294);if(_0x1b4165!==0x0)_0x4cfe6f['x']+=_0x1b4165;_0x1b4165=calculateSingleWallAvoidance(_0x2993de['y'],0x0,_0x5b65c8,_0x282de8);if(_0x1b4165!==0x0)_0x4cfe6f['y']+=_0x1b4165;_0x1b4165=calculateSingleWallAvoidance(_0x2993de['y'],height,_0x5b65c8,_0x282de8);if(_0x1b4165!==0x0)_0x4cfe6f['y']+=_0x1b4165;_0x1b4165=calculateSingleWallAvoidance(_0x2993de['x'],width/0x2,_0x5b65c8*0.5,_0x282de8*0.4);if(_0x1b4165!==0x0)_0x4cfe6f['x']+=_0x1b4165;}return _0x4cfe6f;}function calculateSingleWallAvoidance(_0x10a4e4,_0x2f5a53,_0xba63e6,_0x2ea899){let _0x142218=_0x10a4e4-_0x2f5a53,_0x106ba2=abs(_0x142218);if(_0x106ba2<_0xba63e6&&_0x106ba2>0.01){let _0x103646=pow((_0xba63e6-_0x106ba2)/_0xba63e6,1.8),_0xa7271f=_0x142218>0x0?0x1:-0x1;return _0xa7271f*_0x103646*_0x2ea899;}return 0x0;}function updatePuck(){puck['x']+=puck['vx'],puck['y']+=puck['vy'],puck['vx']*=friction,puck['vy']*=friction;let _0x5be879=sqrt(puck['vx']*puck['vx']+puck['vy']*puck['vy']);_0x5be879>maxPuckSpeed&&(puck['vx']=puck['vx']/_0x5be879*maxPuckSpeed,puck['vy']=puck['vy']/_0x5be879*maxPuckSpeed);_0x5be879<0.1&&!isDragging&&(puck['vx']=0x0,puck['vy']=0x0);let _0x29b755,_0x579c22,_0x59f1f2=0.95;if(isPortrait){_0x29b755=width/0x2,_0x579c22=goalWidth;let _0x1aee99=_0x29b755-_0x579c22/0x2,_0x332361=_0x29b755+_0x579c22/0x2;puck['y']-puck['r']<0x0&&(!(puck['x']>_0x1aee99&&puck['x']<_0x332361)&&(puck['vy']*=wallRestitution,puck['y']=puck['r'],puck['vx']*=_0x59f1f2));puck['y']+puck['r']>height&&(!(puck['x']>_0x1aee99&&puck['x']<_0x332361)&&(puck['vy']*=wallRestitution,puck['y']=height-puck['r'],puck['vx']*=_0x59f1f2));if(puck['x']-puck['r']<0x0)puck['vx']*=wallRestitution,puck['x']=puck['r'],puck['vy']*=_0x59f1f2;else puck['x']+puck['r']>width&&(puck['vx']*=wallRestitution,puck['x']=width-puck['r'],puck['vy']*=_0x59f1f2);}else{_0x29b755=height/0x2,_0x579c22=goalWidth;let _0x497b1c=_0x29b755-_0x579c22/0x2,_0x136628=_0x29b755+_0x579c22/0x2;puck['x']-puck['r']<0x0&&(!(puck['y']>_0x497b1c&&puck['y']<_0x136628)&&(puck['vx']*=wallRestitution,puck['x']=puck['r'],puck['vy']*=_0x59f1f2));puck['x']+puck['r']>width&&(!(puck['y']>_0x497b1c&&puck['y']<_0x136628)&&(puck['vx']*=wallRestitution,puck['x']=width-puck['r'],puck['vy']*=_0x59f1f2));if(puck['y']-puck['r']<0x0)puck['vy']*=wallRestitution,puck['y']=puck['r'],puck['vx']*=_0x59f1f2;else puck['y']+puck['r']>height&&(puck['vy']*=wallRestitution,puck['y']=height-puck['r'],puck['vx']*=_0x59f1f2);}puck['x']=constrain(puck['x'],-puck['r']*0x5,width+puck['r']*0x5),puck['y']=constrain(puck['y'],-puck['r']*0x5,height+puck['r']*0x5);}function checkCollisions(){handlePaddleCollision(player),handlePaddleCollision(ai);}function handlePaddleCollision(_0x383bfa){const _0x2c9059=_0x357bf8;let _0x4c2e6e=puck['x']-_0x383bfa['x'],_0x4eaab2=puck['y']-_0x383bfa['y'],_0x165531=sqrt(_0x4c2e6e*_0x4c2e6e+_0x4eaab2*_0x4eaab2),_0xf7a47c=puck['r']+_0x383bfa['r'];if(_0x165531<_0xf7a47c&&_0x165531>0.1){let _0x28241d=_0x4c2e6e/_0x165531,_0x446358=_0x4eaab2/_0x165531,_0x29c44a=puck['vx']-_0x383bfa[_0x2c9059(0x132)],_0x2a238f=puck['vy']-_0x383bfa[_0x2c9059(0x147)],_0x441122=_0x29c44a*_0x28241d+_0x2a238f*_0x446358;if(_0x441122>0x0){let _0x21c536=_0xf7a47c-_0x165531;puck['x']+=_0x28241d*(_0x21c536+0.1),puck['y']+=_0x446358*(_0x21c536+0.1);return;}let _0x63c242=0.8,_0xca067e=-(0x1+_0x63c242)*_0x441122;const _0x3a3260=2.5;_0xca067e=max(_0xca067e,_0x3a3260);let _0x12a6cc=constrain(sqrt(_0x383bfa[_0x2c9059(0x132)]*_0x383bfa[_0x2c9059(0x132)]+_0x383bfa[_0x2c9059(0x147)]*_0x383bfa[_0x2c9059(0x147)])*0.15,0x0,0x6);_0xca067e+=_0x12a6cc;let _0x43368c=_0x28241d,_0x5aa0f1=_0x446358,_0x150084=0.3;const _0x59a835=_0x383bfa['r']*0.7;if(_0x165531>_0x59a835){console['log'](_0x2c9059(0x15d)),_0x150084=0.7,_0x63c242=0.6,_0xca067e=-(0x1+_0x63c242)*_0x441122,_0xca067e=max(_0xca067e,_0x3a3260*0.8);let _0x248586=-_0x446358,_0x853086=_0x28241d;_0x43368c=lerp(_0x28241d,_0x248586,0.3),_0x5aa0f1=lerp(_0x446358,_0x853086,0.3);let _0x54dd09=sqrt(_0x43368c*_0x43368c+_0x5aa0f1*_0x5aa0f1);_0x54dd09>0.01&&(_0x43368c/=_0x54dd09,_0x5aa0f1/=_0x54dd09);}puck['vx']+=_0xca067e*_0x43368c,puck['vy']+=_0xca067e*_0x5aa0f1;let _0xfd10a7=sqrt(puck['vx']*puck['vx']+puck['vy']*puck['vy']);_0xfd10a7>maxPuckSpeed&&(puck['vx']=puck['vx']/_0xfd10a7*maxPuckSpeed,puck['vy']=puck['vy']/_0xfd10a7*maxPuckSpeed);let _0x7f8a11=_0xf7a47c-_0x165531,_0x3cc042=1.1;puck['x']+=_0x28241d*(_0x7f8a11*_0x3cc042+0.1),puck['y']+=_0x446358*(_0x7f8a11*_0x3cc042+0.1);let _0x37a67c=puck['x']-_0x383bfa['x'],_0x205a5c=puck['y']-_0x383bfa['y'],_0x1b5739=sqrt(_0x37a67c*_0x37a67c+_0x205a5c*_0x205a5c);_0x1b5739<_0xf7a47c&&(puck['x']=_0x383bfa['x']+_0x28241d*(_0xf7a47c+0.05),puck['y']=_0x383bfa['y']+_0x446358*(_0xf7a47c+0.05));}}function checkGoal(){const _0x282fd0=_0x357bf8;let _0x45bd76,_0x57839b;if(isPortrait){_0x45bd76=width/0x2,_0x57839b=goalWidth;let _0x3da811=_0x45bd76-_0x57839b/0x2,_0x1cbbed=_0x45bd76+_0x57839b/0x2;puck['y']-puck['r']<0x0&&puck['x']>_0x3da811&&puck['x']<_0x1cbbed&&(playerScore++,console[_0x282fd0(0x12d)](_0x282fd0(0x142)),resetRound(![])),puck['y']+puck['r']>height&&puck['x']>_0x3da811&&puck['x']<_0x1cbbed&&(aiScore++,console['log'](_0x282fd0(0x131)),resetRound(!![]));}else{_0x45bd76=height/0x2,_0x57839b=goalWidth;let _0x136de3=_0x45bd76-_0x57839b/0x2,_0x50ef06=_0x45bd76+_0x57839b/0x2;puck['x']-puck['r']<0x0&&puck['y']>_0x136de3&&puck['y']<_0x50ef06&&(aiScore++,console[_0x282fd0(0x12d)]('AI\x20scores!'),resetRound(!![])),puck['x']+puck['r']>width&&puck['y']>_0x136de3&&puck['y']<_0x50ef06&&(playerScore++,console[_0x282fd0(0x12d)](_0x282fd0(0x142)),resetRound(![]));}}function drawBackgroundScore(){const _0x29e425=_0x357bf8;fill(scoreColor[0x0],scoreColor[0x1],scoreColor[0x2],scoreColor[0x3]);let _0x414224;isPortrait?_0x414224=width*0.4:_0x414224=min(width,height)*0.25,textSize(_0x414224),strokeWeight(max(0x1,_0x414224*0.04)),stroke(fieldColor[0x0]*0.5,fieldColor[0x1]*0.5,fieldColor[0x2]*0.5,0x96),text(playerScore+_0x29e425(0x14b)+aiScore,width/0x2,height/0x2),noStroke();}function drawField(){stroke(0xc8,0xc8,0xc8,0xb4),strokeWeight(max(0x2,min(width,height)*0.006));isPortrait?line(0x0,height/0x2,width,height/0x2):line(width/0x2,0x0,width/0x2,height);noFill(),ellipse(width/0x2,height/0x2,min(width,height)*0.2,min(width,height)*0.2);let _0x254b24,_0x4ffd21,_0x1efa39,_0x376e99,_0x336ddc,_0x170eed;strokeWeight(max(0x3,min(width,height)*0.01)),isPortrait?(_0x254b24=width/0x2,_0x4ffd21=goalWidth,_0x336ddc=_0x254b24-_0x4ffd21/0x2,_0x170eed=_0x254b24+_0x4ffd21/0x2,stroke(playerColor[0x0],playerColor[0x1],playerColor[0x2],0xc8),line(_0x336ddc,height,_0x170eed,height),stroke(aiColor[0x0],aiColor[0x1],aiColor[0x2],0xc8),line(_0x336ddc,0x0,_0x170eed,0x0)):(_0x254b24=height/0x2,_0x4ffd21=goalWidth,_0x1efa39=_0x254b24-_0x4ffd21/0x2,_0x376e99=_0x254b24+_0x4ffd21/0x2,stroke(playerColor[0x0],playerColor[0x1],playerColor[0x2],0xc8),line(0x0,_0x1efa39,0x0,_0x376e99),stroke(aiColor[0x0],aiColor[0x1],aiColor[0x2],0xc8),line(width,_0x1efa39,width,_0x376e99)),noStroke();}function drawPaddles(){const _0x493d74=_0x357bf8;fill(player[_0x493d74(0x149)][0x0],player['color'][0x1],player[_0x493d74(0x149)][0x2]),stroke(0xff,0xff,0xff,0x64),strokeWeight(1.5),ellipse(player['x'],player['y'],player['r']*0x2),fill(ai[_0x493d74(0x149)][0x0],ai['color'][0x1],ai[_0x493d74(0x149)][0x2]),stroke(0xff,0xff,0xff,0x64),strokeWeight(1.5),ellipse(ai['x'],ai['y'],ai['r']*0x2),noStroke();}function drawPuck(){const _0x5abaa9=_0x357bf8;fill(puck['color'][0x0],puck[_0x5abaa9(0x149)][0x1],puck[_0x5abaa9(0x149)][0x2]),stroke(0x0,0x0,0x0,0x96),strokeWeight(0x1),ellipse(puck['x'],puck['y'],puck['r']*0x2),noStroke();}function resetRound(_0x549129){const _0x52e53e=_0x357bf8;puck['x']=width/0x2,puck['y']=height/0x2;let _0x24832d=0x5;isPortrait?(puck['vx']=random(-0x1,0x1),puck['vy']=_0x549129?-_0x24832d:_0x24832d):(puck['vx']=_0x549129?-_0x24832d:_0x24832d,puck['vy']=random(-0x1,0x1)),isPortrait?(player['x']=width/0x2,player['y']=height*0.75,ai['x']=aiBasePos['x'],ai['y']=aiBasePos['y']):(player['x']=width*0.25,player['y']=height/0x2,ai['x']=aiBasePos['x'],ai['y']=aiBasePos['y']),player[_0x52e53e(0x132)]=0x0,player['velY']=0x0,player[_0x52e53e(0x136)]=player['x'],player[_0x52e53e(0x15f)]=player['y'],ai[_0x52e53e(0x132)]=0x0,ai[_0x52e53e(0x147)]=0x0,ai[_0x52e53e(0x136)]=ai['x'],ai[_0x52e53e(0x15f)]=ai['y'],ai[_0x52e53e(0x165)]=0x0,ai['lastPuckPosInCorner']={'x':-0x1,'y':-0x1},ai[_0x52e53e(0x144)]=![],isDragging=![],canvasElement&&canvasElement['removeClass'](_0x52e53e(0x13c)),console[_0x52e53e(0x12d)](_0x52e53e(0x15e),playerScore,'-',aiScore);}
    
    </script>

</body>
</html>