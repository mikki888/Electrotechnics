<!DOCTYPE html>
<html lang="uk">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>2D Аерохокей v18 - Повний екран (Без зміщення)</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/p5.js/1.4.0/p5.js"></script>
    <style>
        /* Базові стилі для сторінки та тіла */
        html, body {
            height: 100%;      /* Займаємо всю висоту */
            width: 100%;       /* Займаємо всю ширину */
            margin: 0;         /* Забираємо відступи за замовчуванням */
            overflow: hidden;  /* Забороняємо прокрутку сторінки */
            background-color: #222; /* Темний фон */
            color: white;      /* Колір тексту */
            font-family: sans-serif; /* Шрифт без зарубок */
            -webkit-user-select: none; /* Заборона виділення тексту */
            -ms-user-select: none;
            user-select: none;
        }
        body {
            display: flex;         /* Використовуємо Flexbox для центрування */
            justify-content: center; /* Центрування по горизонталі */
            align-items: center;     /* Центрування по вертикалі */
            flex-direction: column;  /* Елементи розташовуються вертикально */
            position: relative;    /* Для абсолютного позиціонування .controls */
        }
        /* Стилі для ігрового поля (канвасу) */
        canvas {
            border: 2px solid #aaa; /* Сіра рамка */
            display: block;        /* Забираємо зайвий відступ під канвасом */
            cursor: grab;          /* Курсор "схопити" */
            touch-action: none;    /* Забороняємо стандартні дії браузера при дотику (скрол, зум) */
            max-width: 100%;       /* Максимальна ширина - 100% батьківського елемента */
            max-height: 100%;      /* Максимальна висота - 100% батьківського елемента */
            box-sizing: border-box;/* Рамка враховується в розмірах елемента */
        }
        /* Зміна курсору при перетягуванні ключки */
        canvas.grabbing {
            cursor: grabbing;      /* Курсор "перетягування" */
        }
        /* Стилі для панелі керування */
        .controls {
            position: absolute;    /* Позиціонуємо відносно body */
            top: 10px;             /* Відступ зверху */
            left: 10px;            /* Відступ зліва */
            z-index: 10;           /* Перекриває канвас */
            background: rgba(0, 0, 0, 0.7); /* Напівпрозорий чорний фон */
            padding: 8px;          /* Внутрішні відступи */
            border-radius: 5px;    /* Округлені кути */
            font-size: 0.9em;      /* Розмір шрифту */
            display: flex;         /* Елементи керування в ряд */
            gap: 15px;             /* Відстань між елементами */
            align-items: center;     /* Вирівнювання елементів по вертикалі */
            flex-wrap: wrap;       /* Переносити елементи на новий рядок, якщо не вміщаються */
        }
        /* Стилі для групи елементів керування */
        .control-group label {
            margin-right: 5px;     /* Відступ справа від мітки */
            white-space: nowrap;   /* Заборона переносу тексту мітки */
        }
        /* Стилі для значень повзунків */
        #speedValue, #puckSpeedValue, #gripValue {
            font-weight: bold;     /* Жирний шрифт */
        }
        /* Стилі для кнопки повноекранного режиму */
        #fullscreenBtn {
            padding: 5px 10px;     /* Внутрішні відступи */
            background-color: #555;/* Сірий фон */
            border: 1px solid #888;/* Світліша рамка */
            color: white;          /* Білий текст */
            border-radius: 3px;    /* Округлені кути */
            cursor: pointer;       /* Курсор-вказівник */
            font-size: 0.9em;      /* Розмір шрифту */
            white-space: nowrap;   /* Заборона переносу тексту */
        }
        /* Зміна фону кнопки при наведенні */
        #fullscreenBtn:hover {
            background-color: #777;/* Світліший сірий фон */
        }
        /* Адаптивні стилі для маленьких екранів */
        @media (max-width: 550px) {
            .controls {
                gap: 8px;          /* Менша відстань між елементами */
            }
            .control-group input[type=range] {
                width: 60px;       /* Коротші повзунки */
            }
            #fullscreenBtn {
                font-size: 0.85em; /* Трохи менший шрифт кнопки */
                padding: 4px 8px;  /* Менші відступи кнопки */
            }
        }
    </style>
</head>
<body>
    <!-- Контейнер для елементів керування -->
    <div class="controls">
        <div class="control-group">
            <label for="difficulty">Складність:</label>
            <select id="difficulty">
                <option value="easy">Легка</option>
                <option value="medium" selected>Середня</option>
                <option value="hard">Важка</option>
            </select>
        </div>
        <div class="control-group">
             <label for="aiSpeed">Шв. ШІ: <span id="speedValue">1.0</span>x</label>
             <input type="range" id="aiSpeed" min="0.2" max="2.5" value="1.0" step="0.1" style="width: 80px;">
        </div>
        <div class="control-group">
             <label for="puckSpeedSlider">Макс. шв. шайби: <span id="puckSpeedValue">15</span></label>
             <input type="range" id="puckSpeedSlider" min="5" max="35" value="15" step="1" style="width: 80px;">
        </div>
         <div class="control-group">
             <label for="gripSlider">Зачепл.: <span id="gripValue">0.39</span></label>
             <input type="range" id="gripSlider" min="0.0" max="0.8" value="0.39" step="0.01" style="width: 80px;">
        </div>
        <!-- Кнопка повноекранного режиму -->
        <button id="fullscreenBtn">Повний екран</button>
    </div>

    <!-- Канвас для гри буде створено і додано сюди за допомогою p5.js -->

    <script>


const _0x4e6766=_0x3bb4;(function(_0x4cb696,_0x14e84c){const _0x112ecd=_0x3bb4,_0x1a09e7=_0x4cb696();while(!![]){try{const _0x417c96=-parseInt(_0x112ecd(0x135))/0x1*(-parseInt(_0x112ecd(0x11b))/0x2)+-parseInt(_0x112ecd(0x140))/0x3+-parseInt(_0x112ecd(0x12c))/0x4*(parseInt(_0x112ecd(0xf4))/0x5)+-parseInt(_0x112ecd(0x114))/0x6+parseInt(_0x112ecd(0x119))/0x7+-parseInt(_0x112ecd(0x100))/0x8*(parseInt(_0x112ecd(0x102))/0x9)+parseInt(_0x112ecd(0x101))/0xa*(parseInt(_0x112ecd(0x10d))/0xb);if(_0x417c96===_0x14e84c)break;else _0x1a09e7['push'](_0x1a09e7['shift']());}catch(_0x3a481){_0x1a09e7['push'](_0x1a09e7['shift']());}}}(_0x9973,0xe7488));let canvasElement,isPortrait=![];const padding=0xa,playerColor=[0x0,0x64,0xff],aiColor=[0xff,0x32,0x32],puckColor=[0xf0,0xf0,0xf0],fieldColor=[0x2d,0x2d,0x37],scoreColor=[0xc8,0xc8,0xc8,0x50];let paddleRadius,puckRadius,goalWidth;const friction=0.995;function _0x9973(){const _0x5e33d2=['getElementById','active','parent','webkitExitFullscreen','mozRequestFullScreen','rgba(0,\x200,\x200,\x200.4)','fullscreenBtn','4olrbMR','mouseMoved','lastPuckPosInCorner','aiSpeed','touchmove','textContent','shadowOffsetX','shadowOffsetY','Вийти','11MDBDSO','velY','touchstart','life','left','player','portrait','addEventListener','fullscreenchange','aimVecX','puckSpeedSlider','139239OVdLBj','change','clientY','MSFullscreenChange','hard','exitFullscreen','timer','mozfullscreenchange','push','value','msExitFullscreen','clientX','length','size','4878415MImeLd','grabbing','msRequestFullscreen','webkitRequestFullscreen','mousePressed','prevY','easy','mouseReleased','documentElement','isStuckEscaping','medium','shadowBlur','320984YZoXHs','10wFuUUt','207WZlhAM','gripValue','shadowColor','input','rgba(0,\x200,\x200,\x200.35)','prevX','getBoundingClientRect','elt','speedValue','preventDefault','msFullscreenElement','1628143uruUxp','side','toFixed','fullscreenElement','click','removeClass','touches','1192584YJGtgF','touchend','aimVecY','target','puckSpeedValue','9636515yPRbTA','velX','284794jhnFur','requestFullscreen','color','webkitFullscreenElement','addClass','top','stuckInCornerTimer','difficulty','mozCancelFullScreen','escapeAttemptTimer'];_0x9973=function(){return _0x5e33d2;};return _0x9973();}let currentMaxPuckSpeed=0xf,currentEdgeBlendFactor=0.39;const wallRestitution=-0.95;let player,ai,puck,playerScore=0x0,aiScore=0x0,difficulty=_0x4e6766(0xfe),isDragging=![],aiGlobalSpeedMultiplier=0x1;const overallSpeedBaseMultiplier=0.392,reactionSpeedModifier=0.7;let aiBasePos,aiDefensiveLine,aiCriticalDefenseLine,aiOffensivePush;const aiAimAssist=0.1;let cornerCheckRadius;const wallAvoidanceDistance=0x32,wallAvoidanceForce=0.2;let scaledWallAvoidDistance;const STUCK_INITIAL_THRESHOLD_FRAMES=0x2d,STUCK_ESCAPE_TIMEOUT_FRAMES=0x12c,STUCK_ESCAPE_FORCE_MULTIPLIER=4.5,AI_PREDICTION_FRAMES_MIN=0x8,AI_PREDICTION_FRAMES_MAX=0x19,AI_DEFENSE_CLEAR_BIAS=0.25,AI_CRITICAL_CLEAR_STRENGTH=0x1;let puckTrail=[];const TRAIL_LENGTH=0xc;let hitSparks=[];const SPARK_LIFETIME=0xf,NUM_SPARKS=0x5;let goalFlash={'active':![],'side':null,'timer':0x0};const GOAL_FLASH_DURATION=0x14;function setup(){const _0x424cdc=_0x4e6766;let _0x506217=calculateCanvasSize();canvasElement=createCanvas(_0x506217['w'],_0x506217['h']),canvasElement[_0x424cdc(0x127)](document['body']),isPortrait=_0x506217[_0x424cdc(0x13b)],resetLayout(),textAlign(CENTER,CENTER),noStroke(),setupEventListeners(),noiseSeed(random(0x3e8));}function calculateCanvasSize(){let _0x687eb1=windowWidth-padding*0x2,_0x794bf0=windowHeight-padding*0x2;_0x794bf0=max(_0x794bf0,0xc8);let _0x2858c2=_0x794bf0>_0x687eb1;return{'w':floor(_0x687eb1),'h':floor(_0x794bf0),'portrait':_0x2858c2};}function resetLayout(){const _0x19c2d8=_0x4e6766;isPortrait=height>width;let _0x588f04=min(width,height),_0x51a5c1=max(0x19,_0x588f04*0.05),_0x45bb95=max(0xa,_0x588f04*0.03);const _0x578aca=1.3;isPortrait?(paddleRadius=_0x51a5c1*_0x578aca,puckRadius=_0x45bb95*_0x578aca):(paddleRadius=_0x51a5c1,puckRadius=_0x45bb95);const _0x37e5a1=0.12,_0x57bf9e=0.06;isPortrait?(paddleRadius=min(paddleRadius,width*_0x37e5a1),puckRadius=min(puckRadius,width*_0x57bf9e)):(paddleRadius=min(paddleRadius,_0x588f04*0.1),puckRadius=min(puckRadius,_0x588f04*0.05));goalWidth=_0x588f04*0.3,aiOffensivePush=paddleRadius*0.7,cornerCheckRadius=paddleRadius*1.8,scaledWallAvoidDistance=_0x588f04*0.13,initializeObjects(![]),isDragging=![];if(canvasElement)canvasElement[_0x19c2d8(0x112)](_0x19c2d8(0xf5));puckTrail=[],hitSparks=[],goalFlash[_0x19c2d8(0x126)]=![];}function initializeObjects(_0x1775c5=![]){const _0x39b775=_0x4e6766;let _0x4bc46f,_0x23c4d8,_0x3eb75e,_0x34407e;isPortrait?(_0x4bc46f=width/0x2,_0x23c4d8=height*0.75,aiBasePos={'x':width/0x2,'y':height*0.25},aiDefensiveLine=height*0.4,aiCriticalDefenseLine=height*0.18,_0x3eb75e=aiBasePos['x'],_0x34407e=aiBasePos['y']):(_0x4bc46f=width*0.25,_0x23c4d8=height/0x2,aiBasePos={'x':width*0.75,'y':height/0x2},aiDefensiveLine=width*0.6,aiCriticalDefenseLine=width*0.82,_0x3eb75e=aiBasePos['x'],_0x34407e=aiBasePos['y']);player?(player['x']=_0x4bc46f,player['y']=_0x23c4d8,player[_0x39b775(0x107)]=_0x4bc46f,player[_0x39b775(0xf9)]=_0x23c4d8,player[_0x39b775(0x11a)]=0x0,player[_0x39b775(0x136)]=0x0,player['r']=paddleRadius):player={'x':_0x4bc46f,'y':_0x23c4d8,'r':paddleRadius,'color':playerColor,'prevX':_0x4bc46f,'prevY':_0x23c4d8,'velX':0x0,'velY':0x0};ai?(ai['x']=_0x3eb75e,ai['y']=_0x34407e,ai[_0x39b775(0x107)]=_0x3eb75e,ai[_0x39b775(0xf9)]=_0x34407e,ai['velX']=0x0,ai[_0x39b775(0x136)]=0x0,ai['r']=paddleRadius,ai[_0x39b775(0x121)]=0x0,ai[_0x39b775(0x12e)]={'x':-0x1,'y':-0x1},ai[_0x39b775(0xfd)]=![],ai[_0x39b775(0x124)]=0x0):ai={'x':_0x3eb75e,'y':_0x34407e,'r':paddleRadius,'color':aiColor,'prevX':_0x3eb75e,'prevY':_0x34407e,'velX':0x0,'velY':0x0,'stuckInCornerTimer':0x0,'lastPuckPosInCorner':{'x':-0x1,'y':-0x1},'isStuckEscaping':![],'escapeAttemptTimer':0x0};puck?(puck['x']=width/0x2,puck['y']=height/0x2,puck['vx']=0x0,puck['vy']=0x0,puck['r']=puckRadius):puck={'x':width/0x2,'y':height/0x2,'r':puckRadius,'vx':0x0,'vy':0x0,'color':puckColor};let _0x45c0a1=0x5;isPortrait?(puck['vx']=random(-0x1,0x1)*_0x45c0a1*0.3,puck['vy']=_0x1775c5?_0x45c0a1:-_0x45c0a1):(puck['vx']=_0x1775c5?-_0x45c0a1:_0x45c0a1,puck['vy']=random(-0x1,0x1)*_0x45c0a1*0.3);}function windowResized(){setTimeout(()=>{let _0x13b184=calculateCanvasSize();resizeCanvas(_0x13b184['w'],_0x13b184['h']),resetLayout();},0x32);}function setupEventListeners(){const _0x15b656=_0x4e6766,_0x372059=document[_0x15b656(0x125)](_0x15b656(0x122));_0x372059[_0x15b656(0x13c)](_0x15b656(0x141),_0x4a68cc=>{const _0x1c75e8=_0x15b656;difficulty=_0x4a68cc[_0x1c75e8(0x117)][_0x1c75e8(0x149)],resetRound(![]);}),difficulty=_0x372059[_0x15b656(0x149)];const _0x873269=document[_0x15b656(0x125)](_0x15b656(0x12f)),_0x2fff57=document[_0x15b656(0x125)](_0x15b656(0x10a));_0x873269[_0x15b656(0x13c)](_0x15b656(0x105),_0x188576=>{const _0x282ce3=_0x15b656;aiGlobalSpeedMultiplier=parseFloat(_0x188576[_0x282ce3(0x117)][_0x282ce3(0x149)]),_0x2fff57['textContent']=aiGlobalSpeedMultiplier[_0x282ce3(0x10f)](0x1);}),aiGlobalSpeedMultiplier=parseFloat(_0x873269[_0x15b656(0x149)]),_0x2fff57[_0x15b656(0x131)]=aiGlobalSpeedMultiplier['toFixed'](0x1);const _0x262dff=document[_0x15b656(0x125)](_0x15b656(0x13f)),_0x5d1fd6=document[_0x15b656(0x125)](_0x15b656(0x118));_0x262dff[_0x15b656(0x13c)](_0x15b656(0x105),_0x39092d=>{const _0x107c6d=_0x15b656;currentMaxPuckSpeed=parseFloat(_0x39092d[_0x107c6d(0x117)][_0x107c6d(0x149)]),_0x5d1fd6['textContent']=currentMaxPuckSpeed[_0x107c6d(0x10f)](0x0);}),currentMaxPuckSpeed=parseFloat(_0x262dff[_0x15b656(0x149)]),_0x5d1fd6['textContent']=currentMaxPuckSpeed[_0x15b656(0x10f)](0x0);const _0x4c65e8=document['getElementById']('gripSlider'),_0x5df7c8=document[_0x15b656(0x125)](_0x15b656(0x103));_0x4c65e8[_0x15b656(0x13c)]('input',_0x54b3bc=>{const _0x29d584=_0x15b656;currentEdgeBlendFactor=parseFloat(_0x54b3bc['target']['value']),_0x5df7c8[_0x29d584(0x131)]=currentEdgeBlendFactor[_0x29d584(0x10f)](0x2);}),currentEdgeBlendFactor=parseFloat(_0x4c65e8[_0x15b656(0x149)]),_0x5df7c8[_0x15b656(0x131)]=currentEdgeBlendFactor['toFixed'](0x2);const _0x43befd=document[_0x15b656(0x125)](_0x15b656(0x12b));_0x43befd&&_0x43befd[_0x15b656(0x13c)](_0x15b656(0x111),toggleGameFullscreen),document[_0x15b656(0x13c)](_0x15b656(0x13d),handleFullscreenChange),document['addEventListener']('webkitfullscreenchange',handleFullscreenChange),document[_0x15b656(0x13c)](_0x15b656(0x147),handleFullscreenChange),document[_0x15b656(0x13c)](_0x15b656(0x143),handleFullscreenChange),canvasElement['elt'][_0x15b656(0x13c)](_0x15b656(0x137),handleTouchStart,{'passive':![]}),canvasElement[_0x15b656(0x109)][_0x15b656(0x13c)](_0x15b656(0x130),handleTouchMove,{'passive':![]}),canvasElement[_0x15b656(0x109)][_0x15b656(0x13c)](_0x15b656(0x115),handleTouchEnd),canvasElement[_0x15b656(0x109)][_0x15b656(0x13c)]('touchcancel',handleTouchEnd),canvasElement[_0x15b656(0xf8)](handleMousePressed),canvasElement[_0x15b656(0x12d)](handleMouseMoved),canvasElement[_0x15b656(0xfb)](handleMouseReleased);}function toggleGameFullscreen(){const _0x5c7119=_0x4e6766;let _0x35c61b=document[_0x5c7119(0x110)]||document['webkitFullscreenElement']||document['mozFullScreenElement']||document[_0x5c7119(0x10c)];if(!_0x35c61b){let _0x318644=document[_0x5c7119(0xfc)];if(_0x318644['requestFullscreen'])_0x318644[_0x5c7119(0x11c)]();else{if(_0x318644[_0x5c7119(0xf7)])_0x318644[_0x5c7119(0xf7)]();else{if(_0x318644[_0x5c7119(0x129)])_0x318644['mozRequestFullScreen']();else{if(_0x318644[_0x5c7119(0xf6)])_0x318644[_0x5c7119(0xf6)]();}}}}else{if(document['exitFullscreen'])document[_0x5c7119(0x145)]();else{if(document[_0x5c7119(0x128)])document[_0x5c7119(0x128)]();else{if(document[_0x5c7119(0x123)])document['mozCancelFullScreen']();else{if(document[_0x5c7119(0xf0)])document[_0x5c7119(0xf0)]();}}}}}function handleFullscreenChange(){const _0xc0f722=_0x4e6766;let _0x244152=document[_0xc0f722(0x110)]||document[_0xc0f722(0x11e)]||document['mozFullScreenElement']||document[_0xc0f722(0x10c)];const _0x17b767=document[_0xc0f722(0x125)](_0xc0f722(0x12b));_0x17b767&&(_0x17b767[_0xc0f722(0x131)]=_0x244152?_0xc0f722(0x134):'Повний\x20екран'),windowResized();}function handleTouchStart(_0x8d2ec6){const _0x36ea04=_0x4e6766;if(_0x8d2ec6[_0x36ea04(0x113)]['length']>0x0){let _0x114ca2=_0x8d2ec6['touches'][0x0],_0x417212=canvasElement[_0x36ea04(0x109)]['getBoundingClientRect'](),_0xbd626a=_0x114ca2[_0x36ea04(0xf1)]-_0x417212[_0x36ea04(0x139)],_0x3c0a3d=_0x114ca2[_0x36ea04(0x142)]-_0x417212[_0x36ea04(0x120)];checkPaddleGrab(_0xbd626a,_0x3c0a3d);}}function handleTouchMove(_0x4d3099){const _0x17c0ec=_0x4e6766;if(isDragging&&_0x4d3099[_0x17c0ec(0x113)][_0x17c0ec(0xf2)]>0x0){_0x4d3099[_0x17c0ec(0x10b)]();let _0x27e19d=_0x4d3099[_0x17c0ec(0x113)][0x0],_0x515005=canvasElement[_0x17c0ec(0x109)][_0x17c0ec(0x108)](),_0x2da514=_0x27e19d['clientX']-_0x515005[_0x17c0ec(0x139)],_0x5884bf=_0x27e19d[_0x17c0ec(0x142)]-_0x515005[_0x17c0ec(0x120)];updatePlayerPosition(_0x2da514,_0x5884bf);}}function handleTouchEnd(_0x14593e){isDragging&&releasePaddleGrab();}function handleMousePressed(){checkPaddleGrab(mouseX,mouseY);}function handleMouseMoved(){isDragging&&updatePlayerPosition(mouseX,mouseY);}function _0x3bb4(_0x360e51,_0x26d772){const _0x99732f=_0x9973();return _0x3bb4=function(_0x3bb4e7,_0x3bbce9){_0x3bb4e7=_0x3bb4e7-0xf0;let _0x21f429=_0x99732f[_0x3bb4e7];return _0x21f429;},_0x3bb4(_0x360e51,_0x26d772);}function handleMouseReleased(){isDragging&&releasePaddleGrab();}function checkPaddleGrab(_0x3a7295,_0x56bf07){const _0x293764=_0x4e6766;if(!player)return;let _0x5b0ae4=dist(_0x3a7295,_0x56bf07,player['x'],player['y']),_0x5a7958=1.8;_0x5b0ae4<player['r']*_0x5a7958&&(isDragging=!![],canvasElement[_0x293764(0x11f)](_0x293764(0xf5)),updatePlayerPosition(_0x3a7295,_0x56bf07));}function releasePaddleGrab(){const _0x5369af=_0x4e6766;isDragging=![],canvasElement[_0x5369af(0x112)](_0x5369af(0xf5));}function updatePlayerPosition(_0x513782,_0x41d3bb){const _0x597177=_0x4e6766;if(!player)return;player[_0x597177(0x107)]=player['x'],player[_0x597177(0xf9)]=player['y'];let _0x409c5f,_0x9a3af6,_0x2c1ee8,_0x43819d;isPortrait?(_0x2c1ee8=player['r'],_0x43819d=width-player['r'],_0x409c5f=height/0x2+player['r'],_0x9a3af6=height-player['r']):(_0x2c1ee8=player['r'],_0x43819d=width/0x2-player['r'],_0x409c5f=player['r'],_0x9a3af6=height-player['r']),player['x']=constrain(_0x513782,_0x2c1ee8,_0x43819d),player['y']=constrain(_0x41d3bb,_0x409c5f,_0x9a3af6);}function draw(){const _0x369567=_0x4e6766;!goalFlash[_0x369567(0x126)]?(updatePlayerVelocity(),updateAI(),puck&&(updatePuck(),checkCollisions(),checkGoal())):(goalFlash[_0x369567(0x146)]++,goalFlash['timer']>=GOAL_FLASH_DURATION&&(goalFlash[_0x369567(0x126)]=![],resetRound(goalFlash[_0x369567(0x10e)]==='ai')));updateTrail(),updateSparks(),background(fieldColor[0x0],fieldColor[0x1],fieldColor[0x2]),drawFieldTexture(),drawField(),drawBackgroundScore();if(puck)drawTrail();player&&ai&&puck&&(drawPaddles(),drawPuck()),drawSparks();}function updatePlayerVelocity(){const _0x2e01cb=_0x4e6766;if(!player)return;if(!isDragging){player['velX']*=0.8,player[_0x2e01cb(0x136)]*=0.8;if(abs(player['velX'])<0.1)player[_0x2e01cb(0x11a)]=0x0;if(abs(player[_0x2e01cb(0x136)])<0.1)player[_0x2e01cb(0x136)]=0x0;}else player[_0x2e01cb(0x11a)]=(player['x']-player['prevX'])*0.8,player[_0x2e01cb(0x136)]=(player['y']-player['prevY'])*0.8;}function updateTrail(){const _0x1fb632=_0x4e6766;if(!puck)return;puckTrail[_0x1fb632(0x148)]({'x':puck['x'],'y':puck['y']}),puckTrail[_0x1fb632(0xf2)]>TRAIL_LENGTH&&puckTrail['shift']();}function updateSparks(){const _0x4d60c8=_0x4e6766;for(let _0x5c0f08=hitSparks[_0x4d60c8(0xf2)]-0x1;_0x5c0f08>=0x0;_0x5c0f08--){let _0x40d249=hitSparks[_0x5c0f08];_0x40d249['x']+=_0x40d249['vx'],_0x40d249['y']+=_0x40d249['vy'],_0x40d249['life']--,_0x40d249[_0x4d60c8(0x138)]<=0x0&&hitSparks['splice'](_0x5c0f08,0x1);}}function createSparks(_0x1a4027,_0xc1eb3d,_0x7d770b){const _0x572676=_0x4e6766;for(let _0x50ea5e=0x0;_0x50ea5e<NUM_SPARKS;_0x50ea5e++){let _0x450c11=_0x7d770b+random(-PI/0x3,PI/0x3),_0x252186=random(0x2,0x5);hitSparks[_0x572676(0x148)]({'x':_0x1a4027,'y':_0xc1eb3d,'vx':cos(_0x450c11)*_0x252186,'vy':sin(_0x450c11)*_0x252186,'life':floor(random(SPARK_LIFETIME*0.5,SPARK_LIFETIME)),'size':random(1.5,3.5)});}}function updateAI(){const _0x22e56f=_0x4e6766;if(!ai||!puck)return;ai[_0x22e56f(0x107)]=ai['x'],ai[_0x22e56f(0xf9)]=ai['y'];let _0x14cd21;switch(difficulty){case _0x22e56f(0xfa):_0x14cd21=0.07;break;case'hard':_0x14cd21=0.25;break;case _0x22e56f(0xfe):default:_0x14cd21=0.15;break;}if(difficulty===_0x22e56f(0x144)){let _0x557509=aiScore-playerScore;if(_0x557509<=-0x2)_0x14cd21*=1.15;else _0x557509>=0x2&&(_0x14cd21*=0.9);}_0x14cd21*=aiGlobalSpeedMultiplier*overallSpeedBaseMultiplier;let _0x2c33f1=aiBasePos['x'],_0x1a0a1c=aiBasePos['y'],_0x47b7eb=_0x14cd21,_0x37f2a9={'x':0x0,'y':0x0};const _0x322e1d=isPortrait?width/0x2:width,_0x94486f=isPortrait?0x0:height/0x2,_0xe0bacb=isPortrait?width/0x2:0x0,_0xcd312a=isPortrait?height:height/0x2,_0x4c1501=dist(ai['x'],ai['y'],puck['x'],puck['y']),_0x22af77=sqrt(puck['vx']*puck['vx']+puck['vy']*puck['vy']);let _0x19fde1=map(_0x4c1501,0x0,max(width,height)/0x2,AI_PREDICTION_FRAMES_MIN,AI_PREDICTION_FRAMES_MAX);_0x19fde1/=map(_0x22af77,0x0,currentMaxPuckSpeed*0.8,0x1,0x3),_0x19fde1=constrain(_0x19fde1,0x2,AI_PREDICTION_FRAMES_MAX);let _0x345d16=puck['x']+puck['vx']*_0x19fde1,_0x4312a8=puck['y']+puck['vy']*_0x19fde1;if(difficulty==='hard'){if(isPortrait){if(_0x345d16<puckRadius)_0x345d16=puckRadius+(puckRadius-_0x345d16);else _0x345d16>width-puckRadius&&(_0x345d16=width-puckRadius-(_0x345d16-(width-puckRadius)));}else{if(_0x4312a8<puckRadius)_0x4312a8=puckRadius+(puckRadius-_0x4312a8);else _0x4312a8>height-puckRadius&&(_0x4312a8=height-puckRadius-(_0x4312a8-(height-puckRadius)));}}_0x345d16=constrain(_0x345d16,puckRadius,width-puckRadius),_0x4312a8=constrain(_0x4312a8,puckRadius,height-puckRadius);let _0x40160b=![];isPortrait?_0x40160b=puck['vy']<-0.1:_0x40160b=puck['vx']>0.1;let _0x4a6b63=![],_0x10cbfe=![];const _0x2d9117=paddleRadius*2.5;isPortrait?(_0x4a6b63=puck['y']<_0x2d9117,_0x10cbfe=puck['y']<ai['y']):(_0x4a6b63=puck['x']>width-_0x2d9117,_0x10cbfe=puck['x']>ai['x']);let _0x49c94a=![];if(ai['isStuckEscaping']){if(difficulty===_0x22e56f(0x144)){let _0x2227f9=calculateSmartEscapeTarget(ai,puck);_0x2c33f1=_0x2227f9['x'],_0x1a0a1c=_0x2227f9['y'],_0x47b7eb*=STUCK_ESCAPE_FORCE_MULTIPLIER*reactionSpeedModifier*1.2;}else{let _0x260291=width/0x2-ai['x'],_0x1998d8=height/0x2-ai['y'],_0x11718e=sqrt(_0x260291*_0x260291+_0x1998d8*_0x1998d8);_0x11718e>0x1&&(_0x260291/=_0x11718e,_0x1998d8/=_0x11718e),_0x2c33f1=ai['x']+_0x260291*0xa,_0x1a0a1c=ai['y']+_0x1998d8*0xa,_0x47b7eb*=STUCK_ESCAPE_FORCE_MULTIPLIER*reactionSpeedModifier;}let _0xf8c82b=checkAiNearCorner(ai,cornerCheckRadius*1.1),_0x3724d6=_0x22af77<0.5;if(_0xf8c82b&&_0x3724d6){ai[_0x22e56f(0x124)]++;if(ai[_0x22e56f(0x124)]>STUCK_ESCAPE_TIMEOUT_FRAMES){resetRound(!![]);return;}}else ai[_0x22e56f(0xfd)]=![],ai['escapeAttemptTimer']=0x0;_0x49c94a=!![];}else{if(_0x4a6b63&&_0x10cbfe&&_0x40160b){_0x2c33f1=isPortrait?puck['x']:width-ai['r'],_0x1a0a1c=isPortrait?ai['r']:puck['y'];let _0x4bbc28=isPortrait?width/0x2-goalWidth/0x2:height/0x2-goalWidth/0x2,_0x10a996=isPortrait?width/0x2+goalWidth/0x2:height/0x2+goalWidth/0x2;if(isPortrait)_0x2c33f1=constrain(_0x2c33f1,_0x4bbc28,_0x10a996);else _0x1a0a1c=constrain(_0x1a0a1c,_0x4bbc28,_0x10a996);_0x2c33f1=constrain(_0x2c33f1,ai['r'],width-ai['r']),_0x1a0a1c=constrain(_0x1a0a1c,ai['r'],height-ai['r']),_0x47b7eb*=0x5*reactionSpeedModifier,_0x49c94a=!![],ai[_0x22e56f(0x121)]=0x0,ai['escapeAttemptTimer']=0x0;}else{if(_0x22af77<0.4){let _0x3d121f=isPortrait?puck['y']<height/0x2+paddleRadius:puck['x']>width/0x2-paddleRadius;if(_0x3d121f){let _0xbea160=![];const _0x155f96=paddleRadius*0x3;if(isPortrait){if(puck['y']<height/0x2&&(puck['x']<_0x155f96||puck['x']>width-_0x155f96))_0xbea160=!![];}else{if(puck['x']>width/0x2&&(puck['y']<_0x155f96||puck['y']>height-_0x155f96))_0xbea160=!![];}if(_0xbea160){let _0x57c396=width/0x2,_0x29d694=height/0x2,_0x46e367=_0x57c396-puck['x'],_0x21911d=_0x29d694-puck['y'],_0x5800a2=sqrt(_0x46e367*_0x46e367+_0x21911d*_0x21911d);_0x5800a2>0.1?(_0x46e367/=_0x5800a2,_0x21911d/=_0x5800a2):(_0x46e367=isPortrait?0x0:-0x1,_0x21911d=isPortrait?0x1:0x0),_0x2c33f1=puck['x']-_0x46e367*(ai['r']*0.6),_0x1a0a1c=puck['y']-_0x21911d*(ai['r']*0.6),_0x47b7eb*=1.8*reactionSpeedModifier,_0x49c94a=!![],ai[_0x22e56f(0x121)]=0x0,ai[_0x22e56f(0x124)]=0x0;}}}}}if(!_0x49c94a){let _0x202142=isPortrait?_0x4312a8<aiCriticalDefenseLine&&_0x40160b:_0x345d16>aiCriticalDefenseLine&&_0x40160b,_0x1a642f=isPortrait?_0x4312a8<aiDefensiveLine&&_0x40160b:_0x345d16>aiDefensiveLine&&_0x40160b;if(_0x202142){let _0x2cbd02,_0x57dd78;isPortrait?(_0x2cbd02=_0x345d16<width/0x2?_0xe0bacb-width*0.2:_0xe0bacb+width*0.2,_0x57dd78=_0xcd312a+height*0.1):(_0x2cbd02=_0xe0bacb-width*0.1,_0x57dd78=_0x4312a8<height/0x2?_0xcd312a-height*0.2:_0xcd312a+height*0.2);difficulty===_0x22e56f(0x144)&&isNearCorner(_0x345d16,_0x4312a8,puckRadius*0x2)&&(_0x2cbd02=width/0x2,_0x57dd78=height/0x2);_0x2cbd02=lerp(_0x345d16,_0x2cbd02,AI_CRITICAL_CLEAR_STRENGTH),_0x57dd78=lerp(_0x4312a8,_0x57dd78,AI_CRITICAL_CLEAR_STRENGTH);let _0x46d188=_0x2cbd02-_0x345d16,_0x1081c4=_0x57dd78-_0x4312a8,_0x373c2b=sqrt(_0x46d188*_0x46d188+_0x1081c4*_0x1081c4);_0x373c2b>0.1?(_0x46d188/=_0x373c2b,_0x1081c4/=_0x373c2b):(_0x46d188=isPortrait?0x0:-0x1,_0x1081c4=isPortrait?0x1:0x0),_0x2c33f1=_0x345d16-_0x46d188*aiOffensivePush*0.6,_0x1a0a1c=_0x4312a8-_0x1081c4*aiOffensivePush*0.6,_0x47b7eb*=0x4*reactionSpeedModifier,ai[_0x22e56f(0x121)]=0x0,ai[_0x22e56f(0x124)]=0x0;}else{if(_0x1a642f){let _0x51ebdd=_0x345d16,_0x338266=_0x4312a8,_0x324de2,_0x4b8d75;if(difficulty==='hard'){let _0x1639ac=isPortrait?width/0x2:width-ai['r'],_0x2e9586=isPortrait?ai['r']:height/0x2,_0x44706c=_0x1639ac-_0x345d16,_0x476e28=_0x2e9586-_0x4312a8,_0x317e49=sqrt(_0x44706c*_0x44706c+_0x476e28*_0x476e28);_0x317e49>0.1&&(_0x44706c/=_0x317e49,_0x476e28/=_0x317e49),_0x2c33f1=_0x345d16-_0x44706c*(paddleRadius*0.8),_0x1a0a1c=_0x4312a8-_0x476e28*(paddleRadius*0.8),isPortrait?(_0x324de2=lerp(_0xe0bacb,_0x345d16<width/0x2?0x0:width,AI_DEFENSE_CLEAR_BIAS*1.5),_0x4b8d75=_0xcd312a):(_0x324de2=_0xe0bacb,_0x4b8d75=lerp(_0xcd312a,_0x4312a8<height/0x2?0x0:height,AI_DEFENSE_CLEAR_BIAS*1.5));}else{isPortrait?(_0x324de2=lerp(_0xe0bacb,_0x345d16<width/0x2?0x0:width,AI_DEFENSE_CLEAR_BIAS),_0x4b8d75=_0xcd312a):(_0x324de2=_0xe0bacb,_0x4b8d75=lerp(_0xcd312a,_0x4312a8<height/0x2?0x0:height,AI_DEFENSE_CLEAR_BIAS));let _0x22146d=_0x324de2-_0x51ebdd,_0x16f75b=_0x4b8d75-_0x338266,_0x19357c=sqrt(_0x22146d*_0x22146d+_0x16f75b*_0x16f75b);_0x19357c>0.1?(_0x22146d/=_0x19357c,_0x16f75b/=_0x19357c):(_0x22146d=isPortrait?0x0:-0x1,_0x16f75b=isPortrait?0x1:0x0),_0x2c33f1=_0x51ebdd-_0x22146d*aiOffensivePush*0.8,_0x1a0a1c=_0x338266-_0x16f75b*aiOffensivePush*0.8;}if(difficulty==='hard'&&isNearCorner(_0x2c33f1,_0x1a0a1c,paddleRadius*1.5)){isPortrait?(_0x1a0a1c=max(_0x1a0a1c,paddleRadius*2.5),_0x324de2=_0x2c33f1<width/0x2?width:0x0,_0x4b8d75=_0x1a0a1c+height*0.2):(_0x2c33f1=min(_0x2c33f1,width-paddleRadius*2.5),_0x4b8d75=_0x1a0a1c<height/0x2?height:0x0,_0x324de2=_0x2c33f1-width*0.2);let _0x845c3c=_0x324de2-_0x51ebdd,_0x58f7ad=_0x4b8d75-_0x338266,_0x3a80e6=sqrt(_0x845c3c*_0x845c3c+_0x58f7ad*_0x58f7ad);_0x3a80e6>0.1?(_0x845c3c/=_0x3a80e6,_0x58f7ad/=_0x3a80e6):(_0x845c3c=isPortrait?0x0:-0x1,_0x58f7ad=isPortrait?0x1:0x0),_0x2c33f1=_0x51ebdd-_0x845c3c*aiOffensivePush*0.8,_0x1a0a1c=_0x338266-_0x58f7ad*aiOffensivePush*0.8;}_0x47b7eb*=2.2*reactionSpeedModifier,ai[_0x22e56f(0x121)]=0x0,ai[_0x22e56f(0x124)]=0x0;}else{let _0x2b2e2a=isPortrait?_0x4312a8<height/0x2+puck['r']*0x3:_0x345d16>width/0x2-puck['r']*0x3;if(_0x2b2e2a){let _0x14ce3e=_0xe0bacb-_0x345d16,_0xe59ba6=_0xcd312a-_0x4312a8,_0x408112=![];if(difficulty===_0x22e56f(0x144)){let _0x7254b=isDirectShotBlockedByPlayer(_0x345d16,_0x4312a8,_0xe0bacb,_0xcd312a,player);if(_0x7254b){let _0x51e26d=calculateBankShotTarget(_0x345d16,_0x4312a8,_0xe0bacb,_0xcd312a);_0x51e26d&&(_0x14ce3e=_0x51e26d[_0x22e56f(0x13e)],_0xe59ba6=_0x51e26d[_0x22e56f(0x116)],_0x408112=!![]);}}if(!_0x408112){let _0x3af748=sqrt(_0x14ce3e*_0x14ce3e+_0xe59ba6*_0xe59ba6);_0x3af748>0.1?(_0x14ce3e/=_0x3af748,_0xe59ba6/=_0x3af748):(_0x14ce3e=isPortrait?0x0:-0x1,_0xe59ba6=isPortrait?0x1:0x0);let _0xcbe05b=atan2(_0xe59ba6,_0x14ce3e),_0x3653f2=random(-aiAimAssist*1.2,aiAimAssist*1.2);_0xcbe05b+=_0x3653f2,_0x14ce3e=cos(_0xcbe05b),_0xe59ba6=sin(_0xcbe05b);}_0x2c33f1=_0x345d16-_0x14ce3e*aiOffensivePush,_0x1a0a1c=_0x4312a8-_0xe59ba6*aiOffensivePush;let _0x215dae=_0x22af77>0x1?map(_0x22af77,0x1,currentMaxPuckSpeed,1.3,0x2):1.3;_0x47b7eb*=_0x215dae*reactionSpeedModifier,ai['stuckInCornerTimer']=0x0,ai[_0x22e56f(0x124)]=0x0;}else{_0x2c33f1=aiBasePos['x'],_0x1a0a1c=aiBasePos['y'],_0x47b7eb*=0.7*reactionSpeedModifier;let _0x45e9af=checkAiNearCorner(ai,cornerCheckRadius*1.1);_0x45e9af&&_0x4c1501<ai['r']+puck['r']+paddleRadius*0.5?_0x22af77<0.3&&ai[_0x22e56f(0x12e)]['x']>0x0?(ai[_0x22e56f(0x121)]++,ai['stuckInCornerTimer']>STUCK_INITIAL_THRESHOLD_FRAMES&&(ai[_0x22e56f(0xfd)]=!![],ai[_0x22e56f(0x121)]=0x0,ai[_0x22e56f(0x124)]=0x0)):(ai[_0x22e56f(0x121)]=0x0,ai[_0x22e56f(0x12e)]={'x':puck['x'],'y':puck['y']}):(ai['stuckInCornerTimer']=0x0,ai['lastPuckPosInCorner']={'x':-0x1,'y':-0x1});}}}}_0x37f2a9=calculateWallAvoidance(ai,isPortrait,scaledWallAvoidDistance,wallAvoidanceForce,_0x322e1d,_0x94486f);let _0x27bf41=(_0x2c33f1-ai['x'])*_0x47b7eb,_0x3d9961=(_0x1a0a1c-ai['y'])*_0x47b7eb;_0x27bf41+=_0x37f2a9['x']*_0x47b7eb*0x37,_0x3d9961+=_0x37f2a9['y']*_0x47b7eb*0x37;let _0x51a265=sqrt(_0x27bf41*_0x27bf41+_0x3d9961*_0x3d9961),_0xed8530=_0x14cd21*(difficulty===_0x22e56f(0x144)?0xc8:0xb4)*reactionSpeedModifier;_0x51a265>_0xed8530&&(_0x27bf41=_0x27bf41/_0x51a265*_0xed8530,_0x3d9961=_0x3d9961/_0x51a265*_0xed8530);if(!ai[_0x22e56f(0xfd)]&&_0x4a6b63&&_0x10cbfe&&_0x40160b){const _0x5d778a=currentMaxPuckSpeed*0.8*reactionSpeedModifier;let _0x111644=sqrt(_0x27bf41*_0x27bf41+_0x3d9961*_0x3d9961);_0x111644>_0x5d778a&&(_0x27bf41=_0x27bf41/_0x111644*_0x5d778a,_0x3d9961=_0x3d9961/_0x111644*_0x5d778a);}ai['x']+=_0x27bf41,ai['y']+=_0x3d9961;const _0x3deabf=0.5;let _0x3c6959=ai['x'],_0x43f76f=ai['y'];isPortrait?(_0x3c6959=constrain(ai['x'],ai['r']+_0x3deabf,width-ai['r']-_0x3deabf),_0x43f76f=constrain(ai['y'],ai['r']+_0x3deabf,height/0x2-ai['r']-_0x3deabf)):(_0x3c6959=constrain(ai['x'],width/0x2+ai['r']+_0x3deabf,width-ai['r']-_0x3deabf),_0x43f76f=constrain(ai['y'],ai['r']+_0x3deabf,height-ai['r']-_0x3deabf)),ai['x']=_0x3c6959,ai['y']=_0x43f76f,ai[_0x22e56f(0x11a)]=ai['x']-ai['prevX'],ai[_0x22e56f(0x136)]=ai['y']-ai[_0x22e56f(0xf9)];}function checkAiNearCorner(_0x17cb39,_0x186ee9){if(!_0x17cb39)return![];return isPortrait?_0x17cb39['y']<_0x186ee9+_0x17cb39['r']&&(_0x17cb39['x']<_0x186ee9+_0x17cb39['r']||_0x17cb39['x']>width-_0x186ee9-_0x17cb39['r']):_0x17cb39['x']>width-_0x186ee9-_0x17cb39['r']&&(_0x17cb39['y']<_0x186ee9+_0x17cb39['r']||_0x17cb39['y']>height-_0x186ee9-_0x17cb39['r']);}function isNearCorner(_0x48243e,_0x6b5883,_0x41e188){let _0x132280=_0x6b5883<_0x41e188,_0x423d99=_0x6b5883>height-_0x41e188,_0x15a965=_0x48243e<_0x41e188,_0x18b558=_0x48243e>width-_0x41e188;return _0x132280&&_0x15a965||_0x132280&&_0x18b558||bottomBottom&&_0x15a965||bottomBottom&&_0x18b558;}function calculateSmartEscapeTarget(_0x291dcd,_0x52219b){let _0x458f0c={'x':width/0x2,'y':height/0x2},_0x32cf35=_0x291dcd['r']*2.5,_0x2eafd7=_0x291dcd['y']<_0x291dcd['r']+0xa,_0x1132c5=_0x291dcd['x']<_0x291dcd['r']+0xa,_0x504b0e=_0x291dcd['x']>width-_0x291dcd['r']-0xa,_0x3fd25f=isPortrait?_0x2eafd7:_0x291dcd['x']>width-_0x291dcd['r']-0xa,_0x3fe840=isPortrait?_0x1132c5:_0x291dcd['y']<_0x291dcd['r']+0xa,_0x3e3c01=isPortrait?_0x504b0e:_0x291dcd['y']>height-_0x291dcd['r']-0xa;if(_0x3fd25f&&_0x3fe840)_0x458f0c['x']=_0x291dcd['x']+_0x32cf35,_0x458f0c['y']=_0x291dcd['y']+_0x32cf35;else{if(_0x3fd25f&&_0x3e3c01)_0x458f0c['x']=_0x291dcd['x']-_0x32cf35,_0x458f0c['y']=_0x291dcd['y']+_0x32cf35;else{if(_0x3fd25f)_0x458f0c['x']=_0x291dcd['x'],_0x458f0c['y']=_0x291dcd['y']+_0x32cf35*1.5;else{if(_0x3fe840)_0x458f0c['x']=_0x291dcd['x']+_0x32cf35*1.5,_0x458f0c['y']=_0x291dcd['y'];else _0x3e3c01&&(_0x458f0c['x']=_0x291dcd['x']-_0x32cf35*1.5,_0x458f0c['y']=_0x291dcd['y']);}}}return _0x458f0c['x']=constrain(_0x458f0c['x'],_0x291dcd['r'],width-_0x291dcd['r']),_0x458f0c['y']=constrain(_0x458f0c['y'],_0x291dcd['r'],height-_0x291dcd['r']),_0x458f0c;}function isDirectShotBlockedByPlayer(_0x5624ed,_0x865f0a,_0x4248bf,_0xb18bcb,_0x2db53a){if(!_0x2db53a)return![];let _0x3f2bc0=distPointLine(_0x2db53a['x'],_0x2db53a['y'],_0x5624ed,_0x865f0a,_0x4248bf,_0xb18bcb),_0xf59111=(_0x2db53a['x']-_0x5624ed)*(_0x4248bf-_0x5624ed)+(_0x2db53a['y']-_0x865f0a)*(_0xb18bcb-_0x865f0a),_0x4c1da1=_0xf59111>0x0&&_0xf59111<distSq(_0x5624ed,_0x865f0a,_0x4248bf,_0xb18bcb);return _0x3f2bc0<_0x2db53a['r']*0x2&&_0x4c1da1;}function distPointLine(_0x2b8b00,_0x55dd35,_0x16c488,_0x30e96a,_0xbd2ef9,_0x5a947b){let _0x129f35=distSq(_0x16c488,_0x30e96a,_0xbd2ef9,_0x5a947b);if(_0x129f35===0x0)return dist(_0x2b8b00,_0x55dd35,_0x16c488,_0x30e96a);let _0x5363d5=((_0x2b8b00-_0x16c488)*(_0xbd2ef9-_0x16c488)+(_0x55dd35-_0x30e96a)*(_0x5a947b-_0x30e96a))/_0x129f35;_0x5363d5=max(0x0,min(0x1,_0x5363d5));let _0x1f36b3=_0x16c488+_0x5363d5*(_0xbd2ef9-_0x16c488),_0x29f801=_0x30e96a+_0x5363d5*(_0x5a947b-_0x30e96a);return dist(_0x2b8b00,_0x55dd35,_0x1f36b3,_0x29f801);}function distSq(_0x24f7d3,_0x30878e,_0x1e8ac5,_0x3e368a){return(_0x24f7d3-_0x1e8ac5)*(_0x24f7d3-_0x1e8ac5)+(_0x30878e-_0x3e368a)*(_0x30878e-_0x3e368a);}function calculateBankShotTarget(_0xe98465,_0x36946f,_0x464d5a,_0x4e75c2){let _0x1256c9,_0x440187,_0x3ee81c,_0xb00c62,_0x9fe38e=null,_0x3dc827=PI;for(let _0x3d3208 of[-0x1,0x1]){if(isPortrait){_0x1256c9=_0x3d3208===-0x1?puckRadius:height-puckRadius;let _0x579d5e=lerp(_0xe98465,_0x464d5a,0.5);_0x579d5e=constrain(_0x579d5e,puckRadius,width-puckRadius),_0x3ee81c=0x0,_0xb00c62=-_0x3d3208,_0x440187=_0x579d5e;}else{_0x440187=_0x3d3208===-0x1?puckRadius:width-puckRadius;let _0x2dfcb1=lerp(_0x36946f,_0x4e75c2,0.5);_0x2dfcb1=constrain(_0x2dfcb1,puckRadius,height-puckRadius),_0x3ee81c=-_0x3d3208,_0xb00c62=0x0,_0x1256c9=_0x2dfcb1;}let _0x2ee527=_0x440187-_0xe98465,_0x493d5a=_0x1256c9-_0x36946f,_0x21e2fa=sqrt(_0x2ee527*_0x2ee527+_0x493d5a*_0x493d5a);if(_0x21e2fa<0x1)continue;_0x2ee527/=_0x21e2fa,_0x493d5a/=_0x21e2fa;let _0x1e7d28=_0x464d5a-_0x440187,_0x1d749d=_0x4e75c2-_0x1256c9,_0x1376ee=sqrt(_0x1e7d28*_0x1e7d28+_0x1d749d*_0x1d749d);if(_0x1376ee<0x1)continue;_0x1e7d28/=_0x1376ee,_0x1d749d/=_0x1376ee;let _0x3d38e5=_0x2ee527*_0x3ee81c+_0x493d5a*_0xb00c62,_0x317b27=_0x1e7d28*_0x3ee81c+_0x1d749d*_0xb00c62,_0x3db1f2=abs(acos(constrain(_0x3d38e5,-0x1,0x1))+acos(constrain(_0x317b27,-0x1,0x1))-PI);_0x3db1f2<0.8&&_0x3db1f2<_0x3dc827&&(_0x3dc827=_0x3db1f2,_0x9fe38e={'aimVecX':_0x2ee527,'aimVecY':_0x493d5a});}return _0x9fe38e;}function calculateWallAvoidance(_0x495b99,_0x52c0f3,_0x1b3c08,_0x24e7c1,_0xbbe1a1,_0x1f8a22){let _0x41ca15={'x':0x0,'y':0x0},_0x523a97;const _0x3a38af=1.6;if(_0x52c0f3){let _0x2b74d0=_0x495b99['y'],_0x4e5bd8=_0x2b74d0<_0x1b3c08*1.5?_0x3a38af:0x1;_0x523a97=calculateSingleWallAvoidance(_0x495b99['y'],0x0,_0x1b3c08*_0x4e5bd8,_0x24e7c1*_0x4e5bd8);if(_0x523a97!==0x0)_0x41ca15['y']+=_0x523a97;_0x523a97=calculateSingleWallAvoidance(_0x495b99['x'],0x0,_0x1b3c08,_0x24e7c1);if(_0x523a97!==0x0)_0x41ca15['x']+=_0x523a97;_0x523a97=calculateSingleWallAvoidance(_0x495b99['x'],width,_0x1b3c08,_0x24e7c1);if(_0x523a97!==0x0)_0x41ca15['x']+=_0x523a97;_0x523a97=calculateSingleWallAvoidance(_0x495b99['y'],height/0x2,_0x1b3c08*0.5,_0x24e7c1*0.4);if(_0x523a97!==0x0)_0x41ca15['y']+=_0x523a97;}else{let _0x4f99f8=width-_0x495b99['x'],_0x1dd43e=_0x4f99f8<_0x1b3c08*1.5?_0x3a38af:0x1;_0x523a97=calculateSingleWallAvoidance(_0x495b99['x'],width,_0x1b3c08*_0x1dd43e,_0x24e7c1*_0x1dd43e);if(_0x523a97!==0x0)_0x41ca15['x']+=_0x523a97;_0x523a97=calculateSingleWallAvoidance(_0x495b99['y'],0x0,_0x1b3c08,_0x24e7c1);if(_0x523a97!==0x0)_0x41ca15['y']+=_0x523a97;_0x523a97=calculateSingleWallAvoidance(_0x495b99['y'],height,_0x1b3c08,_0x24e7c1);if(_0x523a97!==0x0)_0x41ca15['y']+=_0x523a97;_0x523a97=calculateSingleWallAvoidance(_0x495b99['x'],width/0x2,_0x1b3c08*0.5,_0x24e7c1*0.4);if(_0x523a97!==0x0)_0x41ca15['x']+=_0x523a97;}return _0x41ca15;}function calculateSingleWallAvoidance(_0x5ee777,_0x171545,_0x596896,_0x3f281f){let _0x2b969c=_0x5ee777-_0x171545,_0x1a7d04=abs(_0x2b969c);if(_0x1a7d04<_0x596896&&_0x1a7d04>0.01){let _0x4cacaf=pow((_0x596896-_0x1a7d04)/_0x596896,1.8),_0x25e670=_0x2b969c>0x0?0x1:-0x1;return _0x25e670*_0x4cacaf*_0x3f281f;}return 0x0;}function updatePuck(){if(!puck)return;puck['x']+=puck['vx'],puck['y']+=puck['vy'],puck['vx']*=friction,puck['vy']*=friction;let _0x4e66ab=sqrt(puck['vx']*puck['vx']+puck['vy']*puck['vy']);_0x4e66ab>currentMaxPuckSpeed&&(puck['vx']=puck['vx']/_0x4e66ab*currentMaxPuckSpeed,puck['vy']=puck['vy']/_0x4e66ab*currentMaxPuckSpeed);_0x4e66ab<0.1&&!isDragging&&(puck['vx']=0x0,puck['vy']=0x0);let _0x2d6c1b,_0x45afdc,_0x31e637=0.95;if(isPortrait){_0x2d6c1b=width/0x2,_0x45afdc=goalWidth;let _0xe68f0b=_0x2d6c1b-_0x45afdc/0x2,_0x9c7794=_0x2d6c1b+_0x45afdc/0x2;(puck['y']-puck['r']<0x0&&!(puck['x']>_0xe68f0b&&puck['x']<_0x9c7794)||puck['y']+puck['r']>height&&!(puck['x']>_0xe68f0b&&puck['x']<_0x9c7794))&&(puck['vy']*=wallRestitution,puck['y']=constrain(puck['y'],puck['r'],height-puck['r']),puck['vx']*=_0x31e637),(puck['x']-puck['r']<0x0||puck['x']+puck['r']>width)&&(puck['vx']*=wallRestitution,puck['x']=constrain(puck['x'],puck['r'],width-puck['r']),puck['vy']*=_0x31e637);}else{_0x2d6c1b=height/0x2,_0x45afdc=goalWidth;let _0xfa774e=_0x2d6c1b-_0x45afdc/0x2,_0x25af21=_0x2d6c1b+_0x45afdc/0x2;(puck['x']-puck['r']<0x0&&!(puck['y']>_0xfa774e&&puck['y']<_0x25af21)||puck['x']+puck['r']>width&&!(puck['y']>_0xfa774e&&puck['y']<_0x25af21))&&(puck['vx']*=wallRestitution,puck['x']=constrain(puck['x'],puck['r'],width-puck['r']),puck['vy']*=_0x31e637),(puck['y']-puck['r']<0x0||puck['y']+puck['r']>height)&&(puck['vy']*=wallRestitution,puck['y']=constrain(puck['y'],puck['r'],height-puck['r']),puck['vx']*=_0x31e637);}puck['x']=constrain(puck['x'],-puck['r']*0x5,width+puck['r']*0x5),puck['y']=constrain(puck['y'],-puck['r']*0x5,height+puck['r']*0x5);}function checkCollisions(){if(!player||!ai||!puck)return;handlePaddleCollision(player),handlePaddleCollision(ai);}function handlePaddleCollision(_0x4abb11){const _0x4546b9=_0x4e6766;if(!_0x4abb11||!puck)return;let _0x47f2e2=puck['x']-_0x4abb11['x'],_0xada3a0=puck['y']-_0x4abb11['y'],_0x2c092b=sqrt(_0x47f2e2*_0x47f2e2+_0xada3a0*_0xada3a0),_0x15a192=puck['r']+_0x4abb11['r'];if(_0x2c092b<_0x15a192&&_0x2c092b>0.1){let _0xf7f33=_0x47f2e2/_0x2c092b,_0x584b10=_0xada3a0/_0x2c092b,_0x62cd75=puck['vx']-_0x4abb11[_0x4546b9(0x11a)],_0x8833aa=puck['vy']-_0x4abb11['velY'],_0x5731a6=_0x62cd75*_0xf7f33+_0x8833aa*_0x584b10;if(_0x5731a6>0x0){let _0x35e901=_0x15a192-_0x2c092b;_0x35e901>0.1&&(puck['x']+=_0xf7f33*(_0x35e901+0.1),puck['y']+=_0x584b10*(_0x35e901+0.1));return;}let _0x2365a4=0.8,_0x4d0ab2=-(0x1+_0x2365a4)*_0x5731a6;const _0x44b3d8=2.5;_0x4d0ab2=max(_0x4d0ab2,_0x44b3d8);let _0x1f8824=sqrt(_0x4abb11[_0x4546b9(0x11a)]*_0x4abb11[_0x4546b9(0x11a)]+_0x4abb11[_0x4546b9(0x136)]*_0x4abb11[_0x4546b9(0x136)]),_0x162ad5=constrain(_0x1f8824*0.15,0x0,0x6);_0x4d0ab2+=_0x162ad5;let _0x521ef3=_0xf7f33,_0xf8c797=_0x584b10;const _0x465acf=_0x4abb11['r']*0.7;if(_0x2c092b>_0x465acf&&currentEdgeBlendFactor>0.01){_0x2365a4=0.6,_0x4d0ab2=-(0x1+_0x2365a4)*_0x5731a6,_0x4d0ab2=max(_0x4d0ab2,_0x44b3d8*0.8),_0x4d0ab2+=_0x162ad5;let _0x32f07b=-_0x584b10,_0x524394=_0xf7f33;_0x521ef3=lerp(_0xf7f33,_0x32f07b,currentEdgeBlendFactor),_0xf8c797=lerp(_0x584b10,_0x524394,currentEdgeBlendFactor);let _0x480c26=sqrt(_0x521ef3*_0x521ef3+_0xf8c797*_0xf8c797);_0x480c26>0.01&&(_0x521ef3/=_0x480c26,_0xf8c797/=_0x480c26);}puck['vx']+=_0x4d0ab2*_0x521ef3,puck['vy']+=_0x4d0ab2*_0xf8c797;let _0x85049e=sqrt(puck['vx']*puck['vx']+puck['vy']*puck['vy']);_0x85049e>currentMaxPuckSpeed&&(puck['vx']=puck['vx']/_0x85049e*currentMaxPuckSpeed,puck['vy']=puck['vy']/_0x85049e*currentMaxPuckSpeed);let _0x2d9ee9=_0x15a192-_0x2c092b,_0x31a4e6=1.05;if(_0x2d9ee9>0x0){puck['x']+=_0xf7f33*(_0x2d9ee9*_0x31a4e6+0.1),puck['y']+=_0x584b10*(_0x2d9ee9*_0x31a4e6+0.1);let _0x50a503=puck['x']-_0x4abb11['x'],_0x591a9c=puck['y']-_0x4abb11['y'],_0x478a04=sqrt(_0x50a503*_0x50a503+_0x591a9c*_0x591a9c);_0x478a04<_0x15a192&&(puck['x']=_0x4abb11['x']+_0xf7f33*(_0x15a192+0.05),puck['y']=_0x4abb11['y']+_0x584b10*(_0x15a192+0.05));}let _0x5416de=atan2(_0xf8c797,_0x521ef3);createSparks(puck['x']-_0xf7f33*puck['r'],puck['y']-_0x584b10*puck['r'],_0x5416de+PI);}}function checkGoal(){const _0x510077=_0x4e6766;if(!puck||goalFlash[_0x510077(0x126)])return;let _0x3a6dc4=![],_0x13169f=![],_0x2ca5e3,_0x514cb2;if(isPortrait){_0x2ca5e3=width/0x2,_0x514cb2=goalWidth;let _0x1cdbb2=_0x2ca5e3-_0x514cb2/0x2,_0x33d613=_0x2ca5e3+_0x514cb2/0x2;puck['y']-puck['r']<-puck['r']*0.5&&puck['x']>_0x1cdbb2&&puck['x']<_0x33d613&&(playerScore++,_0x3a6dc4=!![],_0x13169f=![],startGoalAnimation(_0x510077(0x13a))),puck['y']+puck['r']>height+puck['r']*0.5&&puck['x']>_0x1cdbb2&&puck['x']<_0x33d613&&(aiScore++,_0x3a6dc4=!![],_0x13169f=!![],startGoalAnimation('ai'));}else{_0x2ca5e3=height/0x2,_0x514cb2=goalWidth;let _0x631e08=_0x2ca5e3-_0x514cb2/0x2,_0x3f8202=_0x2ca5e3+_0x514cb2/0x2;puck['x']-puck['r']<-puck['r']*0.5&&puck['y']>_0x631e08&&puck['y']<_0x3f8202&&(aiScore++,_0x3a6dc4=!![],_0x13169f=!![],startGoalAnimation('ai')),puck['x']+puck['r']>width+puck['r']*0.5&&puck['y']>_0x631e08&&puck['y']<_0x3f8202&&(playerScore++,_0x3a6dc4=!![],_0x13169f=![],startGoalAnimation(_0x510077(0x13a)));}}function startGoalAnimation(_0x24369d){const _0x2fd1ad=_0x4e6766;goalFlash[_0x2fd1ad(0x10e)]=_0x24369d===_0x2fd1ad(0x13a)?'ai':_0x2fd1ad(0x13a),goalFlash[_0x2fd1ad(0x126)]=!![],goalFlash[_0x2fd1ad(0x146)]=0x0,puck&&(puck['vx']=0x0,puck['vy']=0x0);}function drawFieldTexture(){push(),strokeWeight(0.4);for(let _0x18ef11=0x0;_0x18ef11<0x96;_0x18ef11++){let _0x2111ce=random(width),_0x48351a=random(height),_0x12e7a5=noise(_0x2111ce*0.01,_0x48351a*0.01),_0x3a66d4=_0x12e7a5*TWO_PI*0x2,_0x4f5c9f=_0x12e7a5*0xf+0x5,_0x1a1459=_0x2111ce+cos(_0x3a66d4)*_0x4f5c9f,_0x35893a=_0x48351a+sin(_0x3a66d4)*_0x4f5c9f,_0x5d4e23=map(_0x12e7a5,0x0,0x1,0x5,0x14);stroke(0xc8,0xc8,0xdc,_0x5d4e23),line(_0x2111ce,_0x48351a,_0x1a1459,_0x35893a);}pop();}function drawField(){const _0x1d72ee=_0x4e6766;stroke(0xc8,0xc8,0xc8,0x64),strokeWeight(max(1.5,min(width,height)*0.005));isPortrait?line(0x0,height/0x2,width,height/0x2):line(width/0x2,0x0,width/0x2,height);noFill(),ellipse(width/0x2,height/0x2,min(width,height)*0.18,min(width,height)*0.18);let _0x417208,_0xabf83d,_0x5bb8ad,_0x5470f3,_0x32e737,_0x523aa3,_0x16df1a=max(0x3,min(width,height)*0.01),_0x4d7ed0=max(0x5,min(width,height)*0.015);isPortrait?(_0x417208=width/0x2,_0xabf83d=goalWidth,_0x32e737=_0x417208-_0xabf83d/0x2,_0x523aa3=_0x417208+_0xabf83d/0x2,strokeWeight(goalFlash[_0x1d72ee(0x126)]&&goalFlash[_0x1d72ee(0x10e)]===_0x1d72ee(0x13a)?_0x4d7ed0:_0x16df1a),stroke(playerColor[0x0],playerColor[0x1],playerColor[0x2],goalFlash['active']&&goalFlash['side']===_0x1d72ee(0x13a)?0xff:0xc8),line(_0x32e737,height,_0x523aa3,height),strokeWeight(goalFlash[_0x1d72ee(0x126)]&&goalFlash[_0x1d72ee(0x10e)]==='ai'?_0x4d7ed0:_0x16df1a),stroke(aiColor[0x0],aiColor[0x1],aiColor[0x2],goalFlash[_0x1d72ee(0x126)]&&goalFlash[_0x1d72ee(0x10e)]==='ai'?0xff:0xc8),line(_0x32e737,0x0,_0x523aa3,0x0)):(_0x417208=height/0x2,_0xabf83d=goalWidth,_0x5bb8ad=_0x417208-_0xabf83d/0x2,_0x5470f3=_0x417208+_0xabf83d/0x2,strokeWeight(goalFlash['active']&&goalFlash[_0x1d72ee(0x10e)]==='player'?_0x4d7ed0:_0x16df1a),stroke(playerColor[0x0],playerColor[0x1],playerColor[0x2],goalFlash[_0x1d72ee(0x126)]&&goalFlash[_0x1d72ee(0x10e)]===_0x1d72ee(0x13a)?0xff:0xc8),line(0x0,_0x5bb8ad,0x0,_0x5470f3),strokeWeight(goalFlash[_0x1d72ee(0x126)]&&goalFlash[_0x1d72ee(0x10e)]==='ai'?_0x4d7ed0:_0x16df1a),stroke(aiColor[0x0],aiColor[0x1],aiColor[0x2],goalFlash[_0x1d72ee(0x126)]&&goalFlash[_0x1d72ee(0x10e)]==='ai'?0xff:0xc8),line(width,_0x5bb8ad,width,_0x5470f3)),noStroke(),fill(0xff);}function drawBackgroundScore(){fill(scoreColor[0x0],scoreColor[0x1],scoreColor[0x2],scoreColor[0x3]);let _0x2ab8f1;isPortrait?_0x2ab8f1=width*0.35:_0x2ab8f1=min(width,height)*0.22,textSize(_0x2ab8f1),strokeWeight(max(0x1,_0x2ab8f1*0.04)),stroke(fieldColor[0x0]*0.3,fieldColor[0x1]*0.3,fieldColor[0x2]*0.4,0x96),text(playerScore+'\x20-\x20'+aiScore,width/0x2,height/0x2),noStroke();}function drawPaddles(){const _0x8f9b78=_0x4e6766;if(!player||!ai)return;drawingContext[_0x8f9b78(0xff)]=0xf,drawingContext[_0x8f9b78(0x104)]=_0x8f9b78(0x12a),drawingContext[_0x8f9b78(0x132)]=0x3,drawingContext[_0x8f9b78(0x133)]=0x5,fill(player[_0x8f9b78(0x11d)][0x0],player['color'][0x1],player[_0x8f9b78(0x11d)][0x2]),ellipse(player['x'],player['y'],player['r']*0x2),fill(ai['color'][0x0],ai['color'][0x1],ai[_0x8f9b78(0x11d)][0x2]),ellipse(ai['x'],ai['y'],ai['r']*0x2),drawingContext[_0x8f9b78(0xff)]=0x0,drawingContext[_0x8f9b78(0x132)]=0x0,drawingContext['shadowOffsetY']=0x0,noStroke(),fill(player[_0x8f9b78(0x11d)][0x0]*0.7,player['color'][0x1]*0.7,player['color'][0x2]*0.8),ellipse(player['x'],player['y'],player['r']*1.4),fill(ai[_0x8f9b78(0x11d)][0x0]*0.8,ai[_0x8f9b78(0x11d)][0x1]*0.7,ai[_0x8f9b78(0x11d)][0x2]*0.7),ellipse(ai['x'],ai['y'],ai['r']*1.4);}function drawPuck(){const _0x1578bc=_0x4e6766;if(!puck)return;drawingContext[_0x1578bc(0xff)]=0x8,drawingContext[_0x1578bc(0x104)]=_0x1578bc(0x106),drawingContext[_0x1578bc(0x132)]=0x2,drawingContext['shadowOffsetY']=0x3,fill(puck['color'][0x0],puck[_0x1578bc(0x11d)][0x1],puck[_0x1578bc(0x11d)][0x2]),ellipse(puck['x'],puck['y'],puck['r']*0x2),drawingContext[_0x1578bc(0xff)]=0x0,drawingContext[_0x1578bc(0x132)]=0x0,drawingContext['shadowOffsetY']=0x0;let _0x1c35d1=puck['r']*0.6,_0x22231b=puck['x']-puck['r']*0.2,_0xc3997b=puck['y']-puck['r']*0.2;fill(0xff,0xff,0xff,0x64),ellipse(_0x22231b,_0xc3997b,_0x1c35d1*1.5,_0x1c35d1*1.2),stroke(0x0,0x0,0x0,0x64),strokeWeight(0.5),noFill(),ellipse(puck['x'],puck['y'],puck['r']*0x2),noStroke(),fill(0xff);}function drawTrail(){const _0x3f09f6=_0x4e6766;if(!puck||puckTrail['length']<0x2)return;noStroke();for(let _0x20672f=0x0;_0x20672f<puckTrail[_0x3f09f6(0xf2)];_0x20672f++){let _0x4df0a4=puckTrail[_0x20672f],_0x4199be=map(_0x20672f,0x0,puckTrail[_0x3f09f6(0xf2)]-0x1,0x0,0x3c),_0x246c5=map(_0x20672f,0x0,puckTrail[_0x3f09f6(0xf2)]-0x1,puck['r']*0.2,puck['r']*1.8);fill(puck[_0x3f09f6(0x11d)][0x0],puck[_0x3f09f6(0x11d)][0x1],puck['color'][0x2],_0x4199be),ellipse(_0x4df0a4['x'],_0x4df0a4['y'],_0x246c5);}}function drawSparks(){const _0x33d8fb=_0x4e6766;if(hitSparks[_0x33d8fb(0xf2)]===0x0)return;push(),noStroke();for(let _0x5ea66f of hitSparks){let _0xb23ed1=map(_0x5ea66f[_0x33d8fb(0x138)],0x0,SPARK_LIFETIME,0x0,0xff);fill(0xff,0xff,0xc8+random(-0x32,0x37),_0xb23ed1),ellipse(_0x5ea66f['x'],_0x5ea66f['y'],_0x5ea66f[_0x33d8fb(0xf3)]);}pop();}function resetRound(_0x2dc71c){const _0x3fad4f=_0x4e6766;initializeObjects(_0x2dc71c);if(player){isDragging=![];if(canvasElement)canvasElement[_0x3fad4f(0x112)](_0x3fad4f(0xf5));}ai&&(ai['stuckInCornerTimer']=0x0,ai['escapeAttemptTimer']=0x0,ai[_0x3fad4f(0x12e)]={'x':-0x1,'y':-0x1},ai[_0x3fad4f(0xfd)]=![]),puckTrail=[],hitSparks=[],goalFlash[_0x3fad4f(0x126)]=![];}

    </script>

</body>
</html>